{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739",
  "id": 1390209954,
  "node_id": "I_kwDOA9tCBs5S3Oui",
  "number": 3739,
  "title": "move _beforeConsecutiveTokenTransfer and _afterConsecutiveTokenTransfer to ERC721Consecutive.sol",
  "user": {
    "login": "TrejGun",
    "id": 185285,
    "node_id": "MDQ6VXNlcjE4NTI4NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/185285?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/TrejGun",
    "html_url": "https://github.com/TrejGun",
    "followers_url": "https://api.github.com/users/TrejGun/followers",
    "following_url": "https://api.github.com/users/TrejGun/following{/other_user}",
    "gists_url": "https://api.github.com/users/TrejGun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/TrejGun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/TrejGun/subscriptions",
    "organizations_url": "https://api.github.com/users/TrejGun/orgs",
    "repos_url": "https://api.github.com/users/TrejGun/repos",
    "events_url": "https://api.github.com/users/TrejGun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/TrejGun/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-09-29T03:46:25Z",
  "updated_at": "2022-10-17T15:09:25Z",
  "closed_at": "2022-10-17T15:09:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- Briefly describe the issue you're experiencing. Tell us what you were trying to do and what happened instead. -->\r\n\r\nERC721Consecutive introduces backward incompatibility between 4.7 and 4.8\r\n\r\nMy contracts are not compiling after the upgrade because I have to override _beforeConsecutiveTokenTransfer _afterConsecutiveTokenTransfer that I'm never ever going to use. These methods belong to extension and are used only by extension so why were they added to the core contract?\r\n\r\nhttps://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/ERC721.sol#L495-L519\r\n\r\n<!-- Remember, this is not a place to ask for help debugging code. For that, we welcome you in the OpenZeppelin Community Forum: https://forum.openzeppelin.com/. -->\r\n\r\n**üíª Environment**\r\n\r\n<!-- Tell us what version of OpenZeppelin Contracts you're using, and how you're using it: Truffle, Remix, etc. -->\r\n\r\n**üìù Details**\r\n\r\n<!-- Describe the problem you have been experiencing in more detail. Include as much information as you think is relevant. Keep in mind that transactions can fail for many reasons; context is key here. -->\r\n\r\n**üî¢ Code to reproduce bug**\r\n\r\n<!-- We will be able to better help if you provide a minimal example that triggers the bug. -->\r\n",
  "closed_by": {
    "login": "Amxx",
    "id": 2432299,
    "node_id": "MDQ6VXNlcjI0MzIyOTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Amxx",
    "html_url": "https://github.com/Amxx",
    "followers_url": "https://api.github.com/users/Amxx/followers",
    "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
    "organizations_url": "https://api.github.com/users/Amxx/orgs",
    "repos_url": "https://api.github.com/users/Amxx/repos",
    "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Amxx/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262591458",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1262591458",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1262591458,
    "node_id": "IC_kwDOA9tCBs5LQZ3i",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-29T17:31:50Z",
    "updated_at": "2022-09-29T19:53:07Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @TrejGun \r\n\r\nThese hooks are in the core ERC721 contract because we need them to operate on the balances, which are private and can only be modified with the core ERC721 contract itself.\r\n\r\n~Having this new hooks should be backward compatible. Since any code written for 4.7 does not include them, they should not be defined or overridden anywhere. Consequently, just adding them to the core should not require any manual override.~\r\n\r\n~Could you please provide an example of code that compile when matched to 4.7 but that triggers errors when matched with 4.8 ?~",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262591458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262740073",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1262740073",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1262740073,
    "node_id": "IC_kwDOA9tCBs5LQ-Jp",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-29T19:49:29Z",
    "updated_at": "2022-09-29T19:52:36Z",
    "author_association": "MEMBER",
    "body": "Are you using ERC721Enumerable or ERC721Pausable? Please do share your code.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262740073/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262825885",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1262825885",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1262825885,
    "node_id": "IC_kwDOA9tCBs5LRTGd",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-29T21:18:52Z",
    "updated_at": "2022-09-29T21:18:52Z",
    "author_association": "MEMBER",
    "body": "There is no way to make ERC721Pausable compatible with ERC721Consecutive without introducing some form of breaking change around overrides.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262825885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262967187",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1262967187",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1262967187,
    "node_id": "IC_kwDOA9tCBs5LR1mT",
    "user": {
      "login": "TrejGun",
      "id": 185285,
      "node_id": "MDQ6VXNlcjE4NTI4NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/185285?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TrejGun",
      "html_url": "https://github.com/TrejGun",
      "followers_url": "https://api.github.com/users/TrejGun/followers",
      "following_url": "https://api.github.com/users/TrejGun/following{/other_user}",
      "gists_url": "https://api.github.com/users/TrejGun/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TrejGun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TrejGun/subscriptions",
      "organizations_url": "https://api.github.com/users/TrejGun/orgs",
      "repos_url": "https://api.github.com/users/TrejGun/repos",
      "events_url": "https://api.github.com/users/TrejGun/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TrejGun/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T00:30:09Z",
    "updated_at": "2022-09-30T00:44:55Z",
    "author_association": "NONE",
    "body": "> Are you using ERC721Enumerable or ERC721Pausable? Please do share your code.\r\n\r\nyes I do\r\n\r\n```solidity\r\npragma solidity ^0.8.9;\r\n\r\nimport \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Burnable.sol\";\r\nimport \"@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol\";\r\nimport \"@openzeppelin/contracts/access/AccessControl.sol\";\r\nimport \"@openzeppelin/contracts/utils/Counters.sol\";\r\n\r\ncontract ERC721ABE is AccessControl, ERC721Burnable, ERC721Enumerable {\r\n  using Counters for Counters.Counter;\r\n\r\n  bytes32 public constant MINTER_ROLE = keccak256(\"MINTER_ROLE\");\r\n\r\n  Counters.Counter internal _tokenIdTracker;\r\n\r\n  constructor(\r\n    string memory name,\r\n    string memory symbol\r\n  ) ERC721(name, symbol) {\r\n    _setupRole(DEFAULT_ADMIN_ROLE, _msgSender());\r\n    _setupRole(MINTER_ROLE, _msgSender());\r\n  }\r\n\r\n  function mint(address to) public virtual onlyRole(MINTER_ROLE) {\r\n    _mint(to, _tokenIdTracker.current());\r\n    _tokenIdTracker.increment();\r\n  }\r\n\r\n  function safeMint(address to) public virtual onlyRole(MINTER_ROLE) {\r\n    _safeMint(to, _tokenIdTracker.current());\r\n    _tokenIdTracker.increment();\r\n  }\r\n\r\n  function supportsInterface(bytes4 interfaceId)\r\n    public\r\n    view\r\n    virtual\r\n    override(AccessControl, ERC721, ERC721Enumerable)\r\n    returns (bool)\r\n  {\r\n    return super.supportsInterface(interfaceId);\r\n  }\r\n\r\n  function _beforeTokenTransfer(\r\n    address from,\r\n    address to,\r\n    uint256 tokenId\r\n  ) internal virtual override(ERC721, ERC721Enumerable) {\r\n    super._beforeTokenTransfer(from, to, tokenId);\r\n  }\r\n\r\n  function _beforeConsecutiveTokenTransfer(\r\n    address from,\r\n    address to,\r\n    uint256, /*first*/\r\n    uint96 size\r\n  ) internal virtual override(ERC721, ERC721Enumerable){\r\n    super._beforeTokenTransfer(from, to, size);\r\n  }\r\n}\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1262967187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1270534261",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1270534261",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1270534261,
    "node_id": "IC_kwDOA9tCBs5LutB1",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-06T18:44:53Z",
    "updated_at": "2022-10-06T19:48:35Z",
    "author_association": "MEMBER",
    "body": "@TrejGun Unfortunately if we want to release ERC721Consecutive, due to Solidity limitations we are forced to do some breaking change on ERC721. This is only a technical breaking change that breaks compilation but doesn't otherwise change the behavior of the contract in any way. We are hoping for this breaking change to be as minor and easy to fix as possible.\r\n\r\nCurrently we're considering removing the `before/afterConsecutiveTransfer` hooks, but instead changing the existing `_beforeTokenTransfer` hook adding one more argument to the function. This means that any existing overrides will need to be modified to add that new argument:\r\n\r\n```diff\r\n function _beforeTokenTransfer(\r\n     address from,\r\n     address to,\r\n     uint256 tokenId,\r\n+    uint256 batchSize\r\n ) internal virtual override\r\n```\r\n\r\nWhat are your thoughts on this small breaking change? Is it acceptable in your opinion?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1270534261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1271064230",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1271064230",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1271064230,
    "node_id": "IC_kwDOA9tCBs5Lwuam",
    "user": {
      "login": "TrejGun",
      "id": 185285,
      "node_id": "MDQ6VXNlcjE4NTI4NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/185285?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TrejGun",
      "html_url": "https://github.com/TrejGun",
      "followers_url": "https://api.github.com/users/TrejGun/followers",
      "following_url": "https://api.github.com/users/TrejGun/following{/other_user}",
      "gists_url": "https://api.github.com/users/TrejGun/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TrejGun/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TrejGun/subscriptions",
      "organizations_url": "https://api.github.com/users/TrejGun/orgs",
      "repos_url": "https://api.github.com/users/TrejGun/repos",
      "events_url": "https://api.github.com/users/TrejGun/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TrejGun/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T03:15:09Z",
    "updated_at": "2022-10-07T03:18:19Z",
    "author_association": "NONE",
    "body": "looks much better, thanks\r\nwould be even better with [default parameters](https://github.com/ethereum/solidity/issues/232)\r\n\r\nis this planned for 4.8 or 5.0?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1271064230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1272049476",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3739#issuecomment-1272049476",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3739",
    "id": 1272049476,
    "node_id": "IC_kwDOA9tCBs5L0e9E",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T20:10:39Z",
    "updated_at": "2022-10-07T20:10:39Z",
    "author_association": "MEMBER",
    "body": "We are planning this for 4.8 regardless of the breaking change because we want to deliver the ERC721Consecutive functionality and it is not possible to do it without a breaking change.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1272049476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
