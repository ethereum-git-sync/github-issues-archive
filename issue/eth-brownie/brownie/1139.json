{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1139",
  "id": 937510499,
  "node_id": "MDU6SXNzdWU5Mzc1MTA0OTk=",
  "number": 1139,
  "title": "KeyError: 'language' when allow_revert: True",
  "user": {
    "login": "tlatkdgus1",
    "id": 13446909,
    "node_id": "MDQ6VXNlcjEzNDQ2OTA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13446909?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tlatkdgus1",
    "html_url": "https://github.com/tlatkdgus1",
    "followers_url": "https://api.github.com/users/tlatkdgus1/followers",
    "following_url": "https://api.github.com/users/tlatkdgus1/following{/other_user}",
    "gists_url": "https://api.github.com/users/tlatkdgus1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tlatkdgus1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tlatkdgus1/subscriptions",
    "organizations_url": "https://api.github.com/users/tlatkdgus1/orgs",
    "repos_url": "https://api.github.com/users/tlatkdgus1/repos",
    "events_url": "https://api.github.com/users/tlatkdgus1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tlatkdgus1/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1114236588,
      "node_id": "MDU6TGFiZWwxMTE0MjM2NTg4",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2021-07-06T04:34:32Z",
  "updated_at": "2021-07-22T00:19:34Z",
  "closed_at": "2021-07-22T00:19:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: Brownie v1.13.1\r\n* `ganache-cli` Version: Ganache CLI v6.12.2 (ganache-core: 2.13.2)\r\n* `solc` Version: 0.6.12+commit.27d51765.Linux.g++\r\n* Python Version: 3.6.9\r\n* OS: linux\r\n\r\n### What was wrong?\r\nWhen a transaction revert, an error occurs when allow_revert is True.\r\n\r\nCommand\r\n```\r\ntx = x.create(2, params, {'from':accounts[-1], \"gas\":3000000, \"allow_revert\": True})\r\n```\r\n\r\nError Msg\r\n```\r\nException in thread Thread-2:\r\nTraceback (most recent call last):\r\n  File \"/usr/lib/python3.6/threading.py\", line 916, in _bootstrap_inner\r\n    self.run()\r\n  File \"/usr/lib/python3.6/threading.py\", line 864, in run\r\n    self._target(*self._args, **self._kwargs)\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 495, in _await_confirmation\r\n    print(self._confirm_output())\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 545, in _confirm_output\r\n    revert_msg = self.revert_msg if web3.supports_traces else None\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 44, in wrapper\r\n    return fn(self)\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 253, in revert_msg\r\n    self._get_trace()\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 607, in _get_trace\r\n    self._reverted_trace(trace)\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 658, in _reverted_trace\r\n    self._expand_trace()\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 783, in _expand_trace\r\n    last_map[trace[i][\"depth\"]] = _get_last_map(address, sig)\r\n  File \"/home/sanghyun/.local/pipx/venvs/eth-brownie/lib/python3.6/site-packages/brownie/network/transaction.py\", line 1326, in _get_last_map\r\n    if contract._build[\"language\"] == \"Solidity\":\r\nKeyError: 'language'\r\n```\r\n\r\ncontract._build\r\n```\r\n{'abi': [{'inputs': [{'internalType': 'string', 'name': '_name', 'type': 'string'}, {'internalType': 'string', 'name': '_symbol', 'type': 'string'}, {'internalType': 'uint8', 'name': '_decimals', 'type': 'uint8'}], 'stateMutability': 'nonpayable', 'type': 'constructor', 'name': 'constructor'}, {'anonymous': False, 'inputs': [{'indexed': False, 'internalType': 'address', 'name': '_from', 'type': 'address'}, {'indexed': False, 'internalType': 'address', 'name': '_to', 'type': 'address'}, {'indexed': False, 'internalType': 'uint256', 'name': 'amount', 'type': 'uint256'}], 'name': 'Approval', 'type': 'event'}, {'anonymous': False, 'inputs': [{'indexed': False, 'internalType': 'address', 'name': '_from', 'type': 'address'}, {'indexed': False, 'internalType': 'address', 'name': '_to', 'type': 'address'}, {'indexed': False, 'internalType': 'uint256', 'name': 'amount', 'type': 'uint256'}], 'name': 'Transfer', 'type': 'event'}, {'inputs': [{'internalType': 'address', 'name': '_owner', 'type': 'address'}, {'internalType': 'address', 'name': '_spender', 'type': 'address'}], 'name': 'allowance', 'outputs': [{'internalType': 'uint256', 'name': '', 'type': 'uint256'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [{'internalType': 'address', 'name': '_spender', 'type': 'address'}, {'internalType': 'uint256', 'name': '_value', 'type': 'uint256'}], 'name': 'approve', 'outputs': [{'internalType': 'bool', 'name': '', 'type': 'bool'}], 'stateMutability': 'nonpayable', 'type': 'function'}, {'inputs': [{'internalType': 'address', 'name': '_owner', 'type': 'address'}], 'name': 'balanceOf', 'outputs': [{'internalType': 'uint256', 'name': '', 'type': 'uint256'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [], 'name': 'decimals', 'outputs': [{'internalType': 'uint8', 'name': '', 'type': 'uint8'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [], 'name': 'name', 'outputs': [{'internalType': 'string', 'name': '', 'type': 'string'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [], 'name': 'symbol', 'outputs': [{'internalType': 'string', 'name': '', 'type': 'string'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [], 'name': 'totalSupply', 'outputs': [{'internalType': 'uint256', 'name': '', 'type': 'uint256'}], 'stateMutability': 'view', 'type': 'function'}, {'inputs': [{'internalType': 'address', 'name': '_to', 'type': 'address'}, {'internalType': 'uint256', 'name': '_value', 'type': 'uint256'}], 'name': 'transfer', 'outputs': [{'internalType': 'bool', 'name': '', 'type': 'bool'}], 'stateMutability': 'nonpayable', 'type': 'function'}, {'inputs': [{'internalType': 'address', 'name': '_from', 'type': 'address'}, {'internalType': 'address', 'name': '_to', 'type': 'address'}, {'internalType': 'uint256', 'name': '_value', 'type': 'uint256'}], 'name': 'transferFrom', 'outputs': [{'internalType': 'bool', 'name': '', 'type': 'bool'}], 'stateMutability': 'nonpayable', 'type': 'function'}], 'address': '0x2791BfD60D232150Bff86b39B7146c0eaAA2BA81', 'contractName': 'ERC20', 'type': 'contract'}\r\n```\r\n\r\nCompile list\r\n```\r\n...\r\n...\r\n...\r\n - SupportsInterface\r\n - Address\r\n - ERC20\r\n - LowGasSafeMath\r\n - SafeERC20\r\n```\r\n\r\n\r\n### How can it be fixed?\r\nin my case\r\nOriginal\r\n```\r\nif contract._build[\"language\"] == \"Solidity\":\r\n```\r\n\r\nFixed\r\n```\r\nif True or contract._build[\"language\"] == \"Solidity\":\r\n```\r\n\r\nBut I don't think this is a fundamental solution.",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1139/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
