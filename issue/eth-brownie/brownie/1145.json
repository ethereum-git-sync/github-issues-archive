{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1145",
  "id": 941259901,
  "node_id": "MDU6SXNzdWU5NDEyNTk5MDE=",
  "number": 1145,
  "title": "contract deploy function returns `brownie.exceptions.VirtualMachineError: revert`",
  "user": {
    "login": "liam-ot",
    "id": 48032728,
    "node_id": "MDQ6VXNlcjQ4MDMyNzI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/48032728?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/liam-ot",
    "html_url": "https://github.com/liam-ot",
    "followers_url": "https://api.github.com/users/liam-ot/followers",
    "following_url": "https://api.github.com/users/liam-ot/following{/other_user}",
    "gists_url": "https://api.github.com/users/liam-ot/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/liam-ot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liam-ot/subscriptions",
    "organizations_url": "https://api.github.com/users/liam-ot/orgs",
    "repos_url": "https://api.github.com/users/liam-ot/repos",
    "events_url": "https://api.github.com/users/liam-ot/events{/privacy}",
    "received_events_url": "https://api.github.com/users/liam-ot/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-07-10T14:23:13Z",
  "updated_at": "2021-07-10T19:20:33Z",
  "closed_at": "2021-07-10T19:20:33Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: 1.14.6\r\n* `ganache-cli` Version: 6.12.2\r\n* `vyper` Version: 0.2.12+commit.2c6842c\r\n* Python Version: 3.9.4\r\n* OS: osx\r\n\r\n### What was wrong?\r\n\r\nin my  `conftest.py` file i have:\r\n```\r\nimport pytest\r\nimport brownie\r\nfrom brownie import accounts, contract_name\r\n\r\n# deploy contract\r\n@pytest.fixture(scope=\"module\")\r\ndef deploy(contract_name, accounts):\r\n    return contract_name.deploy({'from':accounts[0]}) # yes, the contract constructor takes no args\r\n\r\n# clean chain for each function, ensures clean working environment\r\n@pytest.fixture(autouse=True)\r\ndef shared_setup(fn_isolation):\r\n    pass\r\n```\r\n\r\n\r\nand then in my `tests/some_test_file.py` i have:\r\n```\r\nimport pytest\r\nimport brownie\r\nfrom brownie import accounts\r\nfrom brownie.test import given, strategy\r\n\r\n@given(amount_sent = strategy('uint256', max_value=10**18, min_value=2))\r\ndef test_tax_amount_deducted_from_party_balances(amount_sent, deploy):\r\n    # do stuff\r\n\r\n```\r\n\r\nrunning `brownie test tests/some_test_file.py` or any test for that matter returns this error:\r\n```\r\nBrownie v1.14.6 - Python development framework for Ethereum\r\n\r\n======================================================== test session starts ========================================================\r\nplatform darwin -- Python 3.9.4, pytest-6.2.3, py-1.10.0, pluggy-0.13.1\r\nrootdir: /Users/REDACTED/Desktop/file/another_file\r\nplugins: eth-brownie-1.14.6, hypothesis-6.10.0, xdist-1.34.0, forked-1.3.0, web3-5.18.0\r\ncollected 1 item                                                                                                                    \r\n\r\nLaunching 'ganache-cli --port 8545 --gasLimit 12000000 --accounts 10 --hardfork istanbul --mnemonic brownie'...\r\n\r\ntests/test_tax.py E                                                                                                           [100%]\r\n\r\n============================================================== ERRORS ===============================================================\r\n__________________________________ ERROR at setup of test_tax_amount_deducted_from_party_balances ___________________________________\r\n\r\ncontract_name = <brownie.network.contract.ContractContainer object at 0x7ffbcdc44c10>\r\naccounts = <brownie.network.account.Accounts object at 0x7ffbcb881880>\r\n\r\n    @pytest.fixture(scope=\"module\")\r\n    def deploy(contract_name, accounts):\r\n>       return contract_name.deploy({'from':accounts[0]})\r\nE       brownie.exceptions.VirtualMachineError: revert\r\n\r\ntests/conftest.py:8: VirtualMachineError\r\n====================================================== short test summary info ======================================================\r\nERROR tests/test_tax.py::test_tax_amount_deducted_from_party_balances - brownie.exceptions.VirtualMachineError: revert\r\n========================================================= 1 error in 10.91s =========================================================\r\nTerminating local RPC client...\r\n```\r\n\r\nodd because it was working before i put it into the conftest, but moving it back to the individual test file makes no difference so not the cause\r\n\r\nthanks in advance for the help, brownie is awesome i much prefer it to truffle",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877647599",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1145#issuecomment-877647599",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
    "id": 877647599,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzY0NzU5OQ==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T14:34:17Z",
    "updated_at": "2021-07-10T14:34:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Do you get this error if you run the deploy in a script? ",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877647599/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877654107",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1145#issuecomment-877654107",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
    "id": 877654107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzY1NDEwNw==",
    "user": {
      "login": "liam-ot",
      "id": 48032728,
      "node_id": "MDQ6VXNlcjQ4MDMyNzI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/48032728?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liam-ot",
      "html_url": "https://github.com/liam-ot",
      "followers_url": "https://api.github.com/users/liam-ot/followers",
      "following_url": "https://api.github.com/users/liam-ot/following{/other_user}",
      "gists_url": "https://api.github.com/users/liam-ot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liam-ot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liam-ot/subscriptions",
      "organizations_url": "https://api.github.com/users/liam-ot/orgs",
      "repos_url": "https://api.github.com/users/liam-ot/repos",
      "events_url": "https://api.github.com/users/liam-ot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liam-ot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T15:17:46Z",
    "updated_at": "2021-07-10T15:17:46Z",
    "author_association": "NONE",
    "body": "yes",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877654107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877654819",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1145#issuecomment-877654819",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
    "id": 877654819,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzY1NDgxOQ==",
    "user": {
      "login": "skellet0r",
      "id": 23556333,
      "node_id": "MDQ6VXNlcjIzNTU2MzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/23556333?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skellet0r",
      "html_url": "https://github.com/skellet0r",
      "followers_url": "https://api.github.com/users/skellet0r/followers",
      "following_url": "https://api.github.com/users/skellet0r/following{/other_user}",
      "gists_url": "https://api.github.com/users/skellet0r/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skellet0r/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skellet0r/subscriptions",
      "organizations_url": "https://api.github.com/users/skellet0r/orgs",
      "repos_url": "https://api.github.com/users/skellet0r/repos",
      "events_url": "https://api.github.com/users/skellet0r/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skellet0r/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T15:22:31Z",
    "updated_at": "2021-07-10T15:22:31Z",
    "author_association": "COLLABORATOR",
    "body": "Does it happen in the brownie console as well?\nDoes your constructor make any assumption that are causing it to revert? Or no constructor?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877654819/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877657401",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1145#issuecomment-877657401",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
    "id": 877657401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzY1NzQwMQ==",
    "user": {
      "login": "liam-ot",
      "id": 48032728,
      "node_id": "MDQ6VXNlcjQ4MDMyNzI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/48032728?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liam-ot",
      "html_url": "https://github.com/liam-ot",
      "followers_url": "https://api.github.com/users/liam-ot/followers",
      "following_url": "https://api.github.com/users/liam-ot/following{/other_user}",
      "gists_url": "https://api.github.com/users/liam-ot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liam-ot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liam-ot/subscriptions",
      "organizations_url": "https://api.github.com/users/liam-ot/orgs",
      "repos_url": "https://api.github.com/users/liam-ot/repos",
      "events_url": "https://api.github.com/users/liam-ot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liam-ot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T15:39:24Z",
    "updated_at": "2021-07-10T15:39:24Z",
    "author_association": "NONE",
    "body": "output from deploying with `contract_name.deploy({'from':accounts[0]})`\r\n\r\n```\r\nTransaction sent: 0xd6c0358295c9d9adbc8855c01c06922ef009f0979b59b9d47d22d3dbe10fb5c0\r\n  Gas price: 0.0 gwei   Gas limit: 12000000   Nonce: 0\r\n  new_metawhale.constructor confirmed (reverted) - Block: 1   Gas used: 261099 (2.18%)\r\n\r\n<Transaction '0xd6c0358295c9d9adbc8855c01c06922ef009f0979b59b9d47d22d3dbe10fb5c0'>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877657401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877657818",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1145#issuecomment-877657818",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1145",
    "id": 877657818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzY1NzgxOA==",
    "user": {
      "login": "liam-ot",
      "id": 48032728,
      "node_id": "MDQ6VXNlcjQ4MDMyNzI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/48032728?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liam-ot",
      "html_url": "https://github.com/liam-ot",
      "followers_url": "https://api.github.com/users/liam-ot/followers",
      "following_url": "https://api.github.com/users/liam-ot/following{/other_user}",
      "gists_url": "https://api.github.com/users/liam-ot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liam-ot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liam-ot/subscriptions",
      "organizations_url": "https://api.github.com/users/liam-ot/orgs",
      "repos_url": "https://api.github.com/users/liam-ot/repos",
      "events_url": "https://api.github.com/users/liam-ot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liam-ot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T15:42:28Z",
    "updated_at": "2021-07-10T15:42:28Z",
    "author_association": "NONE",
    "body": "@skellet0r actually, you made a good point that there was an assumption in the constructor, I was attempting to set a variable in the contract with an interface call, commenting out lead to a different issue, but the issue described here is fixed, thanks",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877657818/reactions",
      "total_count": 5,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 2,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
