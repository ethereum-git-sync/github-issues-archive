{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1406",
  "id": 1110601920,
  "node_id": "I_kwDOCUsNcc5CMnDA",
  "number": 1406,
  "title": "support ganache v7",
  "user": {
    "login": "gosuto-inzasheru",
    "id": 2835259,
    "node_id": "MDQ6VXNlcjI4MzUyNTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2835259?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gosuto-inzasheru",
    "html_url": "https://github.com/gosuto-inzasheru",
    "followers_url": "https://api.github.com/users/gosuto-inzasheru/followers",
    "following_url": "https://api.github.com/users/gosuto-inzasheru/following{/other_user}",
    "gists_url": "https://api.github.com/users/gosuto-inzasheru/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gosuto-inzasheru/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gosuto-inzasheru/subscriptions",
    "organizations_url": "https://api.github.com/users/gosuto-inzasheru/orgs",
    "repos_url": "https://api.github.com/users/gosuto-inzasheru/repos",
    "events_url": "https://api.github.com/users/gosuto-inzasheru/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gosuto-inzasheru/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-01-21T15:35:49Z",
  "updated_at": "2022-02-14T20:58:15Z",
  "closed_at": "2022-02-14T20:58:15Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: 1.17.0\r\n* ~~`ganache-cli`~~`ganache` Version: 7.0.0\r\n\r\n### What was wrong?\r\n\r\n```\r\n$ npm uninstall --global ganache-cli ganache-core\r\n\r\nremoved 101 packages, and audited 1 package in 680ms\r\n\r\nfound 0 vulnerabilities\r\n```\r\n```\r\n$ npm install --global ganache\r\n\r\nadded 29 packages, and audited 30 packages in 1m\r\n\r\nfound 0 vulnerabilities\r\n```\r\n```\r\n$ ganache --version\r\nganache v7.0.0 (@ganache/cli: 0.1.1, @ganache/core: 0.1.1)\r\n```\r\n```\r\n$ brownie console\r\nBrownie v1.17.0 - Python development framework for Ethereum\r\n\r\nGenerating interface ABIs...\r\n*** is the active project.\r\n\r\nLaunching 'ganache-cli --fork https://mainnet.infura.io/v3/*** --port 8545 --chainId 1 --hardfork istanbul'...\r\n  File \"brownie/_cli/__main__.py\", line 64, in main\r\n    importlib.import_module(f\"brownie._cli.{cmd}\").main()\r\n  File \"brownie/_cli/run.py\", line 44, in main\r\n    network.connect(CONFIG.argv[\"network\"])\r\n  File \"brownie/network/main.py\", line 50, in connect\r\n    rpc.launch(active[\"cmd\"], **active[\"cmd_settings\"])\r\n  File \"brownie/network/rpc/__init__.py\", line 93, in launch\r\n    raise RPCProcessError(cmd, uri)\r\nRPCProcessError: Unable to launch local RPC client.\r\nCommand: ganache-cli\r\nURI: http://127.0.0.1:8545\r\n```\r\n```\r\nnpm uninstall --global ganache                 \r\n\r\nremoved 29 packages, and audited 1 package in 636ms\r\n\r\nfound 0 vulnerabilities\r\n```\r\n```\r\n$ npm install --global ganache-cli\r\nnpm WARN deprecated ganache-cli@6.12.2: ganache-cli is now ganache; visit https://trfl.io/g7 for details\r\n\r\nadded 1 package, and audited 102 packages in 4s\r\n```\r\n```\r\n$ ganache-cli --version\r\nGanache CLI v6.12.2 (ganache-core: 2.13.2)\r\n```\r\n```\r\n$ brownie console                        \r\nBrownie v1.17.0 - Python development framework for Ethereum\r\n\r\n*** is the active project.\r\n\r\nLaunching 'ganache-cli --fork https://mainnet.infura.io/v3/*** --port 8545 --chainId 1 --hardfork istanbul'...\r\nBrownie environment is ready.\r\n>>>\r\n```\r\n\r\n### How can it be fixed?\r\n\r\nobviously starting v7 `ganache-cli` got renamed to `ganache`, but i do not know if there are any other breaking changes. there is an official upgrade guide here: https://github.com/trufflesuite/ganache/blob/develop/UPGRADE-GUIDE.md\r\n",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406/reactions",
    "total_count": 3,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019210733",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1406#issuecomment-1019210733",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
    "id": 1019210733,
    "node_id": "IC_kwDOCUsNcc48v-vt",
    "user": {
      "login": "felixsc1",
      "id": 18417664,
      "node_id": "MDQ6VXNlcjE4NDE3NjY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/18417664?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/felixsc1",
      "html_url": "https://github.com/felixsc1",
      "followers_url": "https://api.github.com/users/felixsc1/followers",
      "following_url": "https://api.github.com/users/felixsc1/following{/other_user}",
      "gists_url": "https://api.github.com/users/felixsc1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/felixsc1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/felixsc1/subscriptions",
      "organizations_url": "https://api.github.com/users/felixsc1/orgs",
      "repos_url": "https://api.github.com/users/felixsc1/repos",
      "events_url": "https://api.github.com/users/felixsc1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/felixsc1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-22T11:51:15Z",
    "updated_at": "2022-01-22T11:53:14Z",
    "author_association": "NONE",
    "body": "It works fine for me. After the update the ganache-cli command still exists but shows version 0.7.\r\n\r\nI notice a problem with it though:\r\nIt seems that the new ganache is not returning virtual machine errors in the same way as brownie expects. Whatever this \"exc\" variable below usually contains, it is now None.\r\n\r\nTo get the error below I tested a solidity onlyOwner function with a non-owner account and with pytest.raises(exceptions.VirtualMachineError). The workaround is to use AttributeError instead\r\n\r\n```\r\nself = <Transaction '0x1af548f26bc63c4ba1144ff2c03583cdd92a907d37442178272bfcb8dc5eacd8'>, exc = None\r\n\r\n    def _raise_if_reverted(self, exc: Any) -> None:\r\n        if self.status or CONFIG.mode == \"console\":\r\n            return\r\n        if not web3.supports_traces:\r\n            # if traces are not available, do not attempt to determine the revert reason\r\n            raise exc or ValueError(\"Execution reverted\")\r\n\r\n        if self._dev_revert_msg is None:\r\n            # no revert message and unable to check dev string - have to get trace\r\n            self._expand_trace()\r\n        if self.contract_address:\r\n            source = \"\"\r\n        elif CONFIG.argv[\"revert\"]:\r\n            source = self._traceback_string()\r\n        else:\r\n            source = self._error_string(1)\r\n            contract = state._find_contract(self.receiver)\r\n            if contract:\r\n                marker = \"//\" if contract._build[\"language\"] == \"Solidity\" else \"#\"\r\n                line = self._traceback_string().split(\"\\n\")[-1]\r\n                if marker + \" dev: \" in line:\r\n                    self._dev_revert_msg = line[line.index(marker) + len(marker) : -5].strip()\r\n\r\n>       raise exc._with_attr(\r\n            source=source, revert_msg=self._revert_msg, dev_revert_msg=self._dev_revert_msg\r\n        )\r\nE       AttributeError: 'NoneType' object has no attribute '_with_attr'\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019210733/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019248821",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1406#issuecomment-1019248821",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
    "id": 1019248821,
    "node_id": "IC_kwDOCUsNcc48wIC1",
    "user": {
      "login": "iSOcH",
      "id": 10696022,
      "node_id": "MDQ6VXNlcjEwNjk2MDIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/10696022?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iSOcH",
      "html_url": "https://github.com/iSOcH",
      "followers_url": "https://api.github.com/users/iSOcH/followers",
      "following_url": "https://api.github.com/users/iSOcH/following{/other_user}",
      "gists_url": "https://api.github.com/users/iSOcH/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iSOcH/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iSOcH/subscriptions",
      "organizations_url": "https://api.github.com/users/iSOcH/orgs",
      "repos_url": "https://api.github.com/users/iSOcH/repos",
      "events_url": "https://api.github.com/users/iSOcH/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iSOcH/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-22T12:58:42Z",
    "updated_at": "2022-01-22T12:58:42Z",
    "author_association": "NONE",
    "body": "Forking a network with ganache v7 also currently does not work. Looks like they changed `--chainId` to `--chain.chainId`",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019248821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019868860",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1406#issuecomment-1019868860",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
    "id": 1019868860,
    "node_id": "IC_kwDOCUsNcc48yfa8",
    "user": {
      "login": "gosuto-inzasheru",
      "id": 2835259,
      "node_id": "MDQ6VXNlcjI4MzUyNTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2835259?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gosuto-inzasheru",
      "html_url": "https://github.com/gosuto-inzasheru",
      "followers_url": "https://api.github.com/users/gosuto-inzasheru/followers",
      "following_url": "https://api.github.com/users/gosuto-inzasheru/following{/other_user}",
      "gists_url": "https://api.github.com/users/gosuto-inzasheru/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gosuto-inzasheru/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gosuto-inzasheru/subscriptions",
      "organizations_url": "https://api.github.com/users/gosuto-inzasheru/orgs",
      "repos_url": "https://api.github.com/users/gosuto-inzasheru/repos",
      "events_url": "https://api.github.com/users/gosuto-inzasheru/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gosuto-inzasheru/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-24T09:05:31Z",
    "updated_at": "2022-01-24T09:05:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "@felixsc1 could it be that this is due to [`vmErrorsOnRPCResponse` now defaulting to `false`](https://github.com/trufflesuite/ganache/blob/develop/UPGRADE-GUIDE.md#vmerrorsonrpcresponse-now-defaults-to-false)? do you experience the same issue when starting ganache using the `--vmErrorsOnRpcResponse` flag?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1019868860/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1029450213",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1406#issuecomment-1029450213",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
    "id": 1029450213,
    "node_id": "IC_kwDOCUsNcc49XCnl",
    "user": {
      "login": "mliudev",
      "id": 11674155,
      "node_id": "MDQ6VXNlcjExNjc0MTU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11674155?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mliudev",
      "html_url": "https://github.com/mliudev",
      "followers_url": "https://api.github.com/users/mliudev/followers",
      "following_url": "https://api.github.com/users/mliudev/following{/other_user}",
      "gists_url": "https://api.github.com/users/mliudev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mliudev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mliudev/subscriptions",
      "organizations_url": "https://api.github.com/users/mliudev/orgs",
      "repos_url": "https://api.github.com/users/mliudev/repos",
      "events_url": "https://api.github.com/users/mliudev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mliudev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-03T22:12:52Z",
    "updated_at": "2022-02-03T22:12:52Z",
    "author_association": "NONE",
    "body": "I found this PR which should address this issue: https://github.com/eth-brownie/brownie/pull/1410",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1029450213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1039550139",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1406#issuecomment-1039550139",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1406",
    "id": 1039550139,
    "node_id": "IC_kwDOCUsNcc499ka7",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-14T20:58:15Z",
    "updated_at": "2022-02-14T20:58:15Z",
    "author_association": "MEMBER",
    "body": "Support for ganache v7 is added in the `v1.18.0` release",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1039550139/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
