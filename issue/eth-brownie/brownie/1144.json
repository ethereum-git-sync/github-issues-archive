{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1144",
  "id": 940979091,
  "node_id": "MDU6SXNzdWU5NDA5NzkwOTE=",
  "number": 1144,
  "title": "Tests on testnet are buggy when using `Contract.at`",
  "user": {
    "login": "PatrickAlphaC",
    "id": 54278053,
    "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PatrickAlphaC",
    "html_url": "https://github.com/PatrickAlphaC",
    "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
    "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
    "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
    "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
    "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
    "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2021-07-09T18:24:17Z",
  "updated_at": "2024-01-29T18:18:52Z",
  "closed_at": "2024-01-29T18:18:52Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: 1.14.6\r\n* `ganache-cli` Version: N/A\r\n* `solc` Version: N/A\r\n* Python Version: 3.9.5\r\n* OS: OSX\r\n\r\n### What was wrong?\r\n\r\nWhen running tests on a live network like kovan, brownie attempts to \"tear down\" instances with the `close` function and calls `_remove_contract` from a list it gathers:\r\n\r\n[On line 468](https://github.com/eth-brownie/brownie/blob/4a399b1323b75226a801c16af1cc170273506bef/brownie/project/main.py#L468)\r\n```python\r\nfor contract in [x for v in self._containers.values() for x in v._contracts]\r\n```\r\n\r\nThis can bring in duplicates, so when brownie `del`s them, it runs into a keyerror since it will have already deleted it. \r\n\r\nHere is a full output:\r\n\r\n```bash\r\npatrick@iMac: [~/code/nft-mix -  (main)] $ brownie test --network kovan -s\r\nBrownie v1.14.6 - Python development framework for Ethereum\r\n\r\n================================================================================= test session starts ==================================================================================\r\nplatform darwin -- Python 3.9.5, pytest-6.2.3, py-1.10.0, pluggy-0.13.1 -- /Library/Frameworks/Python.framework/Versions/3.9/bin/python3\r\ncachedir: .pytest_cache\r\nhypothesis profile 'brownie-verbose' -> verbosity=2, deadline=None, max_examples=50, stateful_step_count=10, report_multiple_bugs=False, database=DirectoryBasedExampleDatabase(PosixPath('/Users/patrick/.brownie/hypothesis'))\r\nrootdir: /Users/patrick/code/nft-mix\r\nplugins: eth-brownie-1.14.6, web3-5.18.0, xdist-1.34.0, forked-1.3.0, hypothesis-6.10.0, flaky-3.7.0\r\ncollected 3 items                                                                                                                                                                      \r\n\r\ntests/integration/test_advanced_int.py::test_can_create_advanced_collectible_integration PASSED\r\n\r\n============================================================================= 1 passed, 2 skipped in 8.72s =============================================================================\r\n  File \"/Users/patrick/code/brownie/brownie/_cli/__main__.py\", line 64, in main\r\n    importlib.import_module(f\"brownie._cli.{cmd}\").main()\r\n  File \"/Users/patrick/code/brownie/brownie/_cli/test.py\", line 61, in main\r\n    return_code = pytest.main(pytest_args, [\"pytest-brownie\"])\r\n  File \"pytest-6.2.3-py3.9.egg/_pytest/config/__init__.py\", line 162, in main\r\n    ret: Union[ExitCode, int] = config.hook.pytest_cmdline_main(\r\n  File \"pluggy/hooks.py\", line 286, in __call__\r\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\r\n  File \"pluggy/manager.py\", line 93, in _hookexec\r\n    return self._inner_hookexec(hook, methods, kwargs)\r\n  File \"pluggy/manager.py\", line 84, in <lambda>\r\n    self._inner_hookexec = lambda hook, methods, kwargs: hook.multicall(\r\n  File \"pluggy/callers.py\", line 208, in _multicall\r\n    return outcome.get_result()\r\n  File \"pluggy/callers.py\", line 80, in get_result\r\n    raise ex[1].with_traceback(ex[2])\r\n  File \"pluggy/callers.py\", line 187, in _multicall\r\n    res = hook_impl.function(*args)\r\n  File \"pytest-6.2.3-py3.9.egg/_pytest/main.py\", line 316, in pytest_cmdline_main\r\n    return wrap_session(config, _main)\r\n  File \"pytest-6.2.3-py3.9.egg/_pytest/main.py\", line 311, in wrap_session\r\n    config._ensure_unconfigure()\r\n  File \"pytest-6.2.3-py3.9.egg/_pytest/config/__init__.py\", line 987, in _ensure_unconfigure\r\n    self.hook.pytest_unconfigure(config=self)\r\n  File \"pluggy/hooks.py\", line 286, in __call__\r\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\r\n  File \"pluggy/manager.py\", line 93, in _hookexec\r\n    return self._inner_hookexec(hook, methods, kwargs)\r\n  File \"pluggy/manager.py\", line 84, in <lambda>\r\n    self._inner_hookexec = lambda hook, methods, kwargs: hook.multicall(\r\n  File \"pluggy/callers.py\", line 208, in _multicall\r\n    return outcome.get_result()\r\n  File \"pluggy/callers.py\", line 80, in get_result\r\n    raise ex[1].with_traceback(ex[2])\r\n  File \"pluggy/callers.py\", line 187, in _multicall\r\n    res = hook_impl.function(*args)\r\n  File \"/Users/patrick/code/brownie/brownie/test/managers/base.py\", line 263, in pytest_unconfigure\r\n    project.close(raises=False)\r\n  File \"/Users/patrick/code/brownie/brownie/project/main.py\", line 469, in close\r\n    _remove_contract(contract)\r\n  File \"/Users/patrick/code/brownie/brownie/network/state.py\", line 563, in _remove_contract\r\n    del _contract_map[contract.address]\r\nKeyError: '0xdD3782915140c8f3b190B5D67eAc6dc5760C46E9'\r\n```\r\n\r\nPlease include information like:\r\n\r\n### Fix\r\n\r\nThis can be fixed easily by changing that one line to:\r\n```python\r\nfor contract in list(set([x for v in self._containers.values() for x in v._contracts])):\r\n```\r\n",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877401610",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877401610",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877401610,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzQwMTYxMA==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-09T19:12:32Z",
    "updated_at": "2021-07-09T19:12:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "After doing some more testing, it looks like the `Contract.at` function is adding the duplicates.\r\n\r\nIf I have in my `map.json` a contract already, and then I call `Contract.at` it appears to add _a duplicate_ contract into brownie, but only 1 is in the`map.json`\r\n\r\n\r\nCommenting out this line also appears to do the trick of fixing the error https://github.com/eth-brownie/brownie/blob/4a399b1323b75226a801c16af1cc170273506bef/brownie/network/contract.py#L231\r\n\r\n```python\r\n        contract._save_deployment()\r\n        _add_contract(contract)\r\n        # self._contracts.append(contract)\r\n        if CONFIG.network_type == \"live\":\r\n            _add_deployment(contract)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877401610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877509017",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877509017",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877509017,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzUwOTAxNw==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-09T23:34:21Z",
    "updated_at": "2021-07-09T23:34:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok, I think I got it. \r\n\r\nIt's adding a `Contract` the first time, and then a `ProjectContract` the second time:\r\n```\r\n> /Users/patrick/code/brownie/brownie/project/main.py(469)close()\r\n    468         breakpoint()\r\n--> 469         for contract in [x for v in self._containers.values() for x in v._contracts]:\r\n    470             _remove_contract(contract)\r\n\r\nipdb> stuff = [x for v in self._containers.values() for x in v._contracts]\r\nipdb> stuff\r\n[<VRFCoordinatorMock Contract '0xdD3782915140c8f3b190B5D67eAc6dc5760C46E9'>, <VRFCoordinatorMock Contract '0xdD3782915140c8f3b190B5D67eAc6dc5760C46E9'>, <AdvancedCollectible Contract '0x31989dd1D2F718561Fbe1dCaa8Cf00933C0800c3'>, <AdvancedCollectible Contract '0x39ebC36a317f4537829Cd67aC65E85497886a2bD'>, <LinkToken Contract '0xa36085F69e2889c224210F603D836748e7dC0088'>, <LinkToken Contract '0xa36085F69e2889c224210F603D836748e7dC0088'>]\r\nipdb> type(stuff[0])\r\n<class 'brownie.network.contract.Contract'>\r\nipdb> type(stuff[1])\r\n<class 'brownie.network.contract.ProjectContract'>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877509017/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877509393",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877509393",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877509393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzUwOTM5Mw==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-09T23:35:55Z",
    "updated_at": "2021-07-09T23:35:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "`contract = _find_contract(address)` in `contract.py` will then return a `Contract` the first time. ",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877509393/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877526761",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877526761",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877526761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzUyNjc2MQ==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T00:54:56Z",
    "updated_at": "2021-07-10T00:54:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Aha.... I should use `from_abi` instead of `at`....",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877526761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877530996",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877530996",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877530996,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzUzMDk5Ng==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T01:19:05Z",
    "updated_at": "2021-07-10T01:19:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looks like we could do a few things:\r\n\r\n1. Stop recording contracts in the _contract_map\r\n2. Check to see if the address is already full in the _contract_map\r\n3. Disallow people to use `at` with contracts deployed outside of brownie\r\n\r\nHappy to help here if there are any thoughts",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877530996/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877531141",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-877531141",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 877531141,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NzUzMTE0MQ==",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-10T01:20:04Z",
    "updated_at": "2021-07-10T01:20:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've gone deep down the brownie hole on this, and I think I see a few easy wins. Let me know what you think. ",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/877531141/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1114459776",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-1114459776",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 1114459776,
    "node_id": "IC_kwDOCUsNcc5CbU6A",
    "user": {
      "login": "zmeghji",
      "id": 2966373,
      "node_id": "MDQ6VXNlcjI5NjYzNzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2966373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zmeghji",
      "html_url": "https://github.com/zmeghji",
      "followers_url": "https://api.github.com/users/zmeghji/followers",
      "following_url": "https://api.github.com/users/zmeghji/following{/other_user}",
      "gists_url": "https://api.github.com/users/zmeghji/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zmeghji/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zmeghji/subscriptions",
      "organizations_url": "https://api.github.com/users/zmeghji/orgs",
      "repos_url": "https://api.github.com/users/zmeghji/repos",
      "events_url": "https://api.github.com/users/zmeghji/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zmeghji/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-02T03:23:41Z",
    "updated_at": "2022-05-02T03:23:41Z",
    "author_association": "NONE",
    "body": "@PatrickAlphaC  How did you even get the tests running on Kovan? Whenever I try running tests in Brownie on a test network, I get the following error. They work fine on the mainnet-fork network though.\r\n\r\n```\r\n    def _request(method: str, args: List) -> int:\r\n        try:\r\n            response = web3.provider.make_request(method, args)  # type: ignore\r\n            if \"result\" in response:\r\n                return response[\"result\"]\r\n        except (AttributeError, RequestsConnectionError):\r\n            raise RPCRequestError(\"Web3 is not connected.\")\r\n>       raise RPCRequestError(response[\"error\"][\"message\"])\r\nE       brownie.exceptions.RPCRequestError: The method evm_snapshot does not exist/is not available\r\n\r\n../../.local/pipx/venvs/eth-brownie/lib/python3.8/site-packages/brownie/network/rpc/ganache.py:129: RPCRequestError\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1114459776/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1204163368",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-1204163368",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 1204163368,
    "node_id": "IC_kwDOCUsNcc5HxhMo",
    "user": {
      "login": "xrave110",
      "id": 81583607,
      "node_id": "MDQ6VXNlcjgxNTgzNjA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/81583607?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xrave110",
      "html_url": "https://github.com/xrave110",
      "followers_url": "https://api.github.com/users/xrave110/followers",
      "following_url": "https://api.github.com/users/xrave110/following{/other_user}",
      "gists_url": "https://api.github.com/users/xrave110/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xrave110/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xrave110/subscriptions",
      "organizations_url": "https://api.github.com/users/xrave110/orgs",
      "repos_url": "https://api.github.com/users/xrave110/repos",
      "events_url": "https://api.github.com/users/xrave110/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xrave110/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-03T16:09:20Z",
    "updated_at": "2022-08-04T17:53:09Z",
    "author_association": "NONE",
    "body": "> @PatrickAlphaC How did you even get the tests running on Kovan? Whenever I try running tests in Brownie on a test network, I get the following error. They work fine on the mainnet-fork network though.\r\n> \r\n> ```\r\n>     def _request(method: str, args: List) -> int:\r\n>         try:\r\n>             response = web3.provider.make_request(method, args)  # type: ignore\r\n>             if \"result\" in response:\r\n>                 return response[\"result\"]\r\n>         except (AttributeError, RequestsConnectionError):\r\n>             raise RPCRequestError(\"Web3 is not connected.\")\r\n> >       raise RPCRequestError(response[\"error\"][\"message\"])\r\n> E       brownie.exceptions.RPCRequestError: The method evm_snapshot does not exist/is not available\r\n> \r\n> ../../.local/pipx/venvs/eth-brownie/lib/python3.8/site-packages/brownie/network/rpc/ganache.py:129: RPCRequestError\r\n> ```\r\n\r\n\r\n\r\n\r\nI have the same issue, kovan works when I write brownie run <scripts> but not working for brownie test.\r\n![Screenshot from 2022-08-03 17-39-14](https://user-images.githubusercontent.com/81583607/182656923-6833e437-7220-44c3-85cc-af62440eeef1.png)\r\nDoes anybody know how to fix it ?\r\n\r\n\r\nUPDATE 04-08-2022:\r\nRemoving this function helped (it is default function after baking the aave/flashloans). \r\n![Screenshot from 2022-08-04 19-49-22](https://user-images.githubusercontent.com/81583607/182917384-548f8884-f7d1-4967-8c72-53e73442ff28.png)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1204163368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1205684271",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1144#issuecomment-1205684271",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1144",
    "id": 1205684271,
    "node_id": "IC_kwDOCUsNcc5H3Ugv",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-04T19:30:02Z",
    "updated_at": "2022-08-04T19:30:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just used `from_abi` instead of `at`",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1205684271/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
