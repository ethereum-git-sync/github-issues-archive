{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/443",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/443",
  "id": 606059121,
  "node_id": "MDU6SXNzdWU2MDYwNTkxMjE=",
  "number": 443,
  "title": "Add a flag to go into the console on test case failure",
  "user": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1114236590,
      "node_id": "MDU6TGFiZWwxMTE0MjM2NTkw",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 1429692429,
      "node_id": "MDU6TGFiZWwxNDI5NjkyNDI5",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/test",
      "name": "test",
      "color": "0a918c",
      "default": false,
      "description": "Related to brownie.test"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/milestones/10",
    "html_url": "https://github.com/eth-brownie/brownie/milestone/10",
    "labels_url": "https://api.github.com/repos/eth-brownie/brownie/milestones/10/labels",
    "id": 5356373,
    "node_id": "MDk6TWlsZXN0b25lNTM1NjM3Mw==",
    "number": 10,
    "title": "Brownie 1.8.0",
    "description": "Next minor release.",
    "creator": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 6,
    "state": "closed",
    "created_at": "2020-04-27T21:22:30Z",
    "updated_at": "2020-05-29T09:30:09Z",
    "due_on": null,
    "closed_at": "2020-05-29T09:30:09Z"
  },
  "comments": 2,
  "created_at": "2020-04-24T05:49:38Z",
  "updated_at": "2020-04-28T16:44:05Z",
  "closed_at": "2020-04-28T16:44:05Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Overview\r\nNormally, when testing with `pytest` one can add the `--pdb` flag to have `pytest` enter into the debugger when a test failure occurs (allowing you to debug it). Brownie already has a console available, so having the test case enter into this mode (or even `pdb` more generally) on a failure to allow a debug would be helpful.\r\n\r\n### Specification\r\nHave a flag, like maybe `brownie test --debug`, that launches into an appropiate debug console to be able to introspect the conditions inside a test case, and be able to work with the contracts under test to identify what the failure might be. This mode might happen after all test cases have executed so that ordering doesn't become a problem, and it might want to revert the last transaction under certain scenarios.",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/443/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/618863971",
    "html_url": "https://github.com/eth-brownie/brownie/issues/443#issuecomment-618863971",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443",
    "id": 618863971,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODg2Mzk3MQ==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-24T07:56:46Z",
    "updated_at": "2020-04-24T07:56:46Z",
    "author_association": "MEMBER",
    "body": "I like it! I think implementation won't be trivial, but also not impossible.\r\n\r\n1. After a test fails, rerun it and take a snapshot prior to every transaction.\r\n2. When the test fails, revert the last transaction.\r\n3. Output the test code with the lines that haven't run yet greyed out, and the trace for the pending fail.\r\n4. Open the console with the namespace of the test. The user plays around and when finished, `exit()` and onto the next failed test.\r\n\r\nChallenges I can see immediately are making it work with `xdist` and moving this functionality to the session teardown phase instead of happening as tests are failing. My gut tells me that the 2nd problem solves the 1st one.\r\n\r\nDoes what I'm describing make sense?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/618863971/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/618996746",
    "html_url": "https://github.com/eth-brownie/brownie/issues/443#issuecomment-618996746",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/443",
    "id": 618996746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxODk5Njc0Ng==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-24T13:06:14Z",
    "updated_at": "2020-04-24T13:06:14Z",
    "author_association": "MEMBER",
    "body": "Did some experimenting, the basic functionality is possible with just 4 lines of code.\r\n\r\nadded to the `PytestBrownieRunner` class in  `brownie/test/managers/runner.py`:\r\n\r\n```python\r\n    def pytest_exception_interact(self, report):\r\n        if report.failed:\r\n            from brownie._cli.console import Console\r\n            Console().interact()\r\n```\r\n\r\nIt requires use of the `-s` flag, otherwise pytest's stdout capture breaks it. There'll be a fair bit of experimenting to get this right, but it's really encouraging to see how easy the core functionality can be added!\r\n\r\nRelated: [Pytest API documentation](https://docs.pytest.org/en/latest/reference.html#_pytest.hookspec.pytest_exception_interact)",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/618996746/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
