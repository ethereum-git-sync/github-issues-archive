{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1396",
  "id": 1099578867,
  "node_id": "I_kwDOCUsNcc5Bij3z",
  "number": 1396,
  "title": "Implement new transaction type to include optional access lists: per EIP 2930",
  "user": {
    "login": "wavey0x",
    "id": 82397455,
    "node_id": "MDQ6VXNlcjgyMzk3NDU1",
    "avatar_url": "https://avatars.githubusercontent.com/u/82397455?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wavey0x",
    "html_url": "https://github.com/wavey0x",
    "followers_url": "https://api.github.com/users/wavey0x/followers",
    "following_url": "https://api.github.com/users/wavey0x/following{/other_user}",
    "gists_url": "https://api.github.com/users/wavey0x/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wavey0x/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wavey0x/subscriptions",
    "organizations_url": "https://api.github.com/users/wavey0x/orgs",
    "repos_url": "https://api.github.com/users/wavey0x/repos",
    "events_url": "https://api.github.com/users/wavey0x/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wavey0x/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-01-11T20:15:48Z",
  "updated_at": "2022-01-12T17:47:28Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Overview\r\n[EIP-2930](https://eips.ethereum.org/EIPS/eip-2930) introduced a new transaction type which allows user to supply \"optional access lists\".\r\nAdding this capability will allow us to overcome a very annoying problem we are experiencing with Gnosis Safe, which is that we cannot currently use a Brownie script to unwrap `weth` to `eth`.  \r\n\r\nReason for this? I believe it is because the weth contract uses `.transfer()` method to send ETH. As a result, it only has a gas allocation of 2300. While older versions of Gnosis Safe handle this without issue, the most recent version of Gnosis Safe (which our team uses) appears to consume more than 2300 gas in its fallback function, which causes withdrawals from weth to run out of gas.\r\n\r\nPer EIP-2930 the way to fix this is to implement access lists in Brownie transactions:\r\n> Mitigates contract breakage risks introduced by EIP-2929, as transactions could pre-specify and pre-pay for the accounts and storage slots that the transaction plans to access; as a result, in the actual execution, the SLOAD and EXT* opcodes would only cost 100 gas: low enough that it would not only prevent breakage due to that EIP but also “unstuck” any contracts that became stuck due to EIP 1884.\r\n\r\n### Specification\r\nAllow `access_list` as an optional argument in transactions. Reference to Ethers implementation [here](https://docs.ethers.io/v5/api/providers/types/#providers-AccessList).\r\n```\r\naccessList = [\r\n  {\r\n    address: \"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e\",\r\n    storageKeys: [\r\n        \"0x0000000000000000000000000000000000000000000000000000000000000004\",\r\n        \"0x0bcad17ecf260d6506c6b97768bdc2acfb6694445d27ffd3f9c1cfbee4a9bd6d\"\r\n    ]\r\n  },\r\n  {\r\n    address: \"0x5FfC014343cd971B7eb70732021E26C35B744cc4\",\r\n    storageKeys: [\r\n        \"0x0000000000000000000000000000000000000000000000000000000000000001\"\r\n    ]\r\n  }\r\n]\r\n```\r\n\r\nI am not sure if there are libraries available to auto-generate access lists or if it must be done manually.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1011296904",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1396#issuecomment-1011296904",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1396",
    "id": 1011296904,
    "node_id": "IC_kwDOCUsNcc48RyqI",
    "user": {
      "login": "wavey0x",
      "id": 82397455,
      "node_id": "MDQ6VXNlcjgyMzk3NDU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/82397455?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wavey0x",
      "html_url": "https://github.com/wavey0x",
      "followers_url": "https://api.github.com/users/wavey0x/followers",
      "following_url": "https://api.github.com/users/wavey0x/following{/other_user}",
      "gists_url": "https://api.github.com/users/wavey0x/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wavey0x/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wavey0x/subscriptions",
      "organizations_url": "https://api.github.com/users/wavey0x/orgs",
      "repos_url": "https://api.github.com/users/wavey0x/repos",
      "events_url": "https://api.github.com/users/wavey0x/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wavey0x/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T17:43:06Z",
    "updated_at": "2022-01-12T17:43:06Z",
    "author_association": "NONE",
    "body": "More information here: \r\nhttps://help.gnosis-safe.io/en/articles/5249851-why-can-t-i-transfer-eth-from-a-contract-into-a-safe",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1011296904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
