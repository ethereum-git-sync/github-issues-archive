{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/250",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/250",
  "id": 524398946,
  "node_id": "MDU6SXNzdWU1MjQzOTg5NDY=",
  "number": 250,
  "title": "Need \"brownie clean\" ? Found issues when changing name and signature of contracts",
  "user": {
    "login": "jo-tm",
    "id": 30682875,
    "node_id": "MDQ6VXNlcjMwNjgyODc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/30682875?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jo-tm",
    "html_url": "https://github.com/jo-tm",
    "followers_url": "https://api.github.com/users/jo-tm/followers",
    "following_url": "https://api.github.com/users/jo-tm/following{/other_user}",
    "gists_url": "https://api.github.com/users/jo-tm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jo-tm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jo-tm/subscriptions",
    "organizations_url": "https://api.github.com/users/jo-tm/orgs",
    "repos_url": "https://api.github.com/users/jo-tm/repos",
    "events_url": "https://api.github.com/users/jo-tm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jo-tm/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1114236588,
      "node_id": "MDU6TGFiZWwxMTE0MjM2NTg4",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-11-18T14:21:59Z",
  "updated_at": "2019-11-23T13:52:55Z",
  "closed_at": "2019-11-23T13:52:55Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "* `brownie` Version: 1.1.0\r\n* `ganache-cli` Version: \r\n* `solc` Version: 0.5.12\r\n* Python Version: 3.7.0\r\n* OS: win\r\n\r\nI am really enjoying working with this tool. I report a small bug.\r\n\r\n### What was wrong?\r\n\r\nI found issues when changing the signature of a contract that already has some tests. Happens when you change the signature of a contract that already has some tests working. Then got worse when I tried new names for the contract, the old contract name was still hanging around somewhere. I solved cloning again the repo somewhere.\r\n\r\nIn the following output, the contract name 'IdentityMasterService2' is no longer used anywhere.\r\n\r\nMaybe this can be solved including some 'brownie clean' command for cleaning caches or something.\r\n\r\nOutput:\r\n\r\n brownie compile\r\nBrownie v1.1.0 - Python development framework for Ethereum\r\n\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\_cli\\__main__.py\", line 55, in main\r\n    importlib.import_module(f\"brownie._cli.{args['<command>']}\").main()\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\_cli\\compile.py\", line 28, in main\r\n    project.load(project_path)\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\main.py\", line 366, in load\r\n    return Project(name, project_path)\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\main.py\", line 123, in __init__\r\n    self.load()\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\main.py\", line 137, in load\r\n    changed = self._get_changed_contracts()\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\main.py\", line 163, in _get_changed_contracts\r\n    changed_set: Set = set(self._sources.get_source_path(i) for i in final)\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\main.py\", line 163, in <genexpr>\r\n    changed_set: Set = set(self._sources.get_source_path(i) for i in final)\r\n  File \"c:\\python37\\lib\\site-packages\\brownie\\project\\sources.py\", line 58, in get_source_path\r\n    return self._contracts[contract_name][\"path\"]\r\nKeyError: 'IdentityMasterService2'\r\n\r\nIf you need more detailed info let me know. Thanks.\r\n",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/250/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555051263",
    "html_url": "https://github.com/eth-brownie/brownie/issues/250#issuecomment-555051263",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250",
    "id": 555051263,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTA1MTI2Mw==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-18T14:57:40Z",
    "updated_at": "2019-11-18T14:57:40Z",
    "author_association": "MEMBER",
    "body": "Interesting, thanks for letting me know.  It likely something to do with files in the `build/` folder not being properly updated or erased.\r\n\r\n> Happens when you change the signature of a contract that already has some tests working.\r\n\r\nWhat was happening in this case?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555051263/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555054740",
    "html_url": "https://github.com/eth-brownie/brownie/issues/250#issuecomment-555054740",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250",
    "id": 555054740,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTA1NDc0MA==",
    "user": {
      "login": "jo-tm",
      "id": 30682875,
      "node_id": "MDQ6VXNlcjMwNjgyODc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/30682875?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jo-tm",
      "html_url": "https://github.com/jo-tm",
      "followers_url": "https://api.github.com/users/jo-tm/followers",
      "following_url": "https://api.github.com/users/jo-tm/following{/other_user}",
      "gists_url": "https://api.github.com/users/jo-tm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jo-tm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jo-tm/subscriptions",
      "organizations_url": "https://api.github.com/users/jo-tm/orgs",
      "repos_url": "https://api.github.com/users/jo-tm/repos",
      "events_url": "https://api.github.com/users/jo-tm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jo-tm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-18T15:05:16Z",
    "updated_at": "2019-11-18T15:05:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "In this case, the contract name was not found on the Python file containing the prev working tests. Thanks a lot.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555054740/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555106368",
    "html_url": "https://github.com/eth-brownie/brownie/issues/250#issuecomment-555106368",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/250",
    "id": 555106368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTEwNjM2OA==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-18T16:53:43Z",
    "updated_at": "2019-11-18T16:53:43Z",
    "author_association": "MEMBER",
    "body": "OK this is useful.  My guesses:\r\n\r\n* For the first issue `build/tests.json` is not properly removing records for files that no longer exist\r\n* For the second issue, while checking for changed sources Brownie isn't verifying the existence of the files listed in each build json's `allSourcePaths` field\r\n\r\nI'll have a look at both of them ASAP.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/555106368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
