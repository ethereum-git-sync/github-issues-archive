{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/766",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/766",
  "id": 704998910,
  "node_id": "MDU6SXNzdWU3MDQ5OTg5MTA=",
  "number": 766,
  "title": "Contracts compiled with Brownie won't verify on Etherscan",
  "user": {
    "login": "Netherdrake",
    "id": 3516903,
    "node_id": "MDQ6VXNlcjM1MTY5MDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3516903?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Netherdrake",
    "html_url": "https://github.com/Netherdrake",
    "followers_url": "https://api.github.com/users/Netherdrake/followers",
    "following_url": "https://api.github.com/users/Netherdrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/Netherdrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Netherdrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Netherdrake/subscriptions",
    "organizations_url": "https://api.github.com/users/Netherdrake/orgs",
    "repos_url": "https://api.github.com/users/Netherdrake/repos",
    "events_url": "https://api.github.com/users/Netherdrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Netherdrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-09-19T21:11:52Z",
  "updated_at": "2021-01-08T19:56:52Z",
  "closed_at": "2021-01-08T19:56:52Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: ==1.11.5\r\n* `ganache-cli` Version: Ganache CLI v6.10.2 (ganache-core: 2.11.3)\r\n* `solc` Version: Version: 0.6.12+commit.27d51765.Linux.g++\r\n* Python Version: 3.8.2\r\n* OS: ubuntu 20.04\r\n\r\n### What was wrong?\r\n\r\nFor about half the contacts compiled and deployed via brownie I'm struggling to verify the bytecode on Etherscan. \r\n\r\nAfter deploying a contract with `Contract.deploy(...)` I would use [truffle-flattener](https://github.com/nomiclabs/truffle-flattener) to generate a single solidity file, and https://abi.hashex.org/ to re-create abi-encoded constructor arguments.\r\n\r\nI made sure to always check the right compiler version and optimization params.\r\n\r\nHere is my brownie config:\r\n```\r\ncompiler:\r\n  evm_version: null\r\n  solc:\r\n    version: 0.6.12\r\n    optimizer:\r\n      enabled: true\r\n      runs: 200\r\n    remappings:\r\n      - \"@openzeppelin=OpenZeppelin/openzeppelin-contracts@3.1.0\"\r\n```\r\n\r\nWhen I compile the same contract trough Remix (https://remix.ethereum.org/) it verifies without issues.\r\n\r\nCompiled with Brownie:\r\nhttps://etherscan.io/address/0xFD01f7a212eAa4aCAdB986fCb74951D510594c8E#code\r\n\r\nCompiled with Remix:\r\nhttps://etherscan.io/address/0x214f2421950de2ee4ff6a394ed677cf296efec0f#code\r\n\r\nI really like Brownie and would like to use it to deploy contracts (instead of having to do them by hand via Remix). \r\nAny ideas for how to debug this?",
  "closed_by": {
    "login": "matnad",
    "id": 18177452,
    "node_id": "MDQ6VXNlcjE4MTc3NDUy",
    "avatar_url": "https://avatars.githubusercontent.com/u/18177452?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matnad",
    "html_url": "https://github.com/matnad",
    "followers_url": "https://api.github.com/users/matnad/followers",
    "following_url": "https://api.github.com/users/matnad/following{/other_user}",
    "gists_url": "https://api.github.com/users/matnad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matnad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matnad/subscriptions",
    "organizations_url": "https://api.github.com/users/matnad/orgs",
    "repos_url": "https://api.github.com/users/matnad/repos",
    "events_url": "https://api.github.com/users/matnad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matnad/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/766/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/695815103",
    "html_url": "https://github.com/eth-brownie/brownie/issues/766#issuecomment-695815103",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766",
    "id": 695815103,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTgxNTEwMw==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-20T17:45:25Z",
    "updated_at": "2020-09-20T17:45:25Z",
    "author_association": "MEMBER",
    "body": "Hi,\r\n\r\nLikely the issue you're running into is related to the compiler version or an optimization setting, but it's hard to say for sure. I think the best solution to this is to have Brownie submitting the source code to etherscan via their API.\r\n\r\nEtherscan's API accepts either flattened single-file contracts, or standard JSON compiler input.  I'm not sure which method I prefer.. as an end user I find the flattened files easier to read, but for composability with other tooling the JSON input is a much cleaner approach. Also generating the JSON input is a part of Brownie's compilation process and so much more straightforward to submit as opposed to having to add logic for flattening.\r\n\r\nSome work toward submitting via the API has been done in #651 but it isn't finished yet. It's been on my TODO list for a minute now, but unfortunately never made it to the top.  If you have the bandwidth to work on it I'll happily accept a PR :pray:  otherwise, best I can offer is that it definitely will happen, but I can't can't say for sure _when_ it will happen.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/695815103/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/695849603",
    "html_url": "https://github.com/eth-brownie/brownie/issues/766#issuecomment-695849603",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766",
    "id": 695849603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTg0OTYwMw==",
    "user": {
      "login": "Netherdrake",
      "id": 3516903,
      "node_id": "MDQ6VXNlcjM1MTY5MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3516903?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Netherdrake",
      "html_url": "https://github.com/Netherdrake",
      "followers_url": "https://api.github.com/users/Netherdrake/followers",
      "following_url": "https://api.github.com/users/Netherdrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/Netherdrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Netherdrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Netherdrake/subscriptions",
      "organizations_url": "https://api.github.com/users/Netherdrake/orgs",
      "repos_url": "https://api.github.com/users/Netherdrake/repos",
      "events_url": "https://api.github.com/users/Netherdrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Netherdrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-20T23:21:22Z",
    "updated_at": "2020-09-20T23:21:22Z",
    "author_association": "NONE",
    "body": "I tried to quickly modify https://github.com/eth-brownie/brownie/blob/master/brownie/project/compiler/__init__.py to dump standard json input, but etherscan did not accept it.\r\n\r\nI will experiment a bit with compiler version and try disabling optimization.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/695849603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/711619114",
    "html_url": "https://github.com/eth-brownie/brownie/issues/766#issuecomment-711619114",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766",
    "id": 711619114,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMTYxOTExNA==",
    "user": {
      "login": "sabotagebeats",
      "id": 27985126,
      "node_id": "MDQ6VXNlcjI3OTg1MTI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27985126?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sabotagebeats",
      "html_url": "https://github.com/sabotagebeats",
      "followers_url": "https://api.github.com/users/sabotagebeats/followers",
      "following_url": "https://api.github.com/users/sabotagebeats/following{/other_user}",
      "gists_url": "https://api.github.com/users/sabotagebeats/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sabotagebeats/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sabotagebeats/subscriptions",
      "organizations_url": "https://api.github.com/users/sabotagebeats/orgs",
      "repos_url": "https://api.github.com/users/sabotagebeats/repos",
      "events_url": "https://api.github.com/users/sabotagebeats/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sabotagebeats/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-19T05:56:53Z",
    "updated_at": "2020-10-19T05:56:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "@iamdefinitelyahuman I believe found the appropriate json, but how can I find the appropriately deployed hex constructor ABI to submit to etherscan?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/711619114/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/756963410",
    "html_url": "https://github.com/eth-brownie/brownie/issues/766#issuecomment-756963410",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/766",
    "id": 756963410,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1Njk2MzQxMA==",
    "user": {
      "login": "matnad",
      "id": 18177452,
      "node_id": "MDQ6VXNlcjE4MTc3NDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/18177452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matnad",
      "html_url": "https://github.com/matnad",
      "followers_url": "https://api.github.com/users/matnad/followers",
      "following_url": "https://api.github.com/users/matnad/following{/other_user}",
      "gists_url": "https://api.github.com/users/matnad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matnad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matnad/subscriptions",
      "organizations_url": "https://api.github.com/users/matnad/orgs",
      "repos_url": "https://api.github.com/users/matnad/repos",
      "events_url": "https://api.github.com/users/matnad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matnad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-08T19:56:52Z",
    "updated_at": "2021-01-08T19:56:52Z",
    "author_association": "COLLABORATOR",
    "body": "Implemented in #914",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/756963410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
