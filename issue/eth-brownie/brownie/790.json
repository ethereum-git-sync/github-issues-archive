{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/790",
  "id": 714234450,
  "node_id": "MDU6SXNzdWU3MTQyMzQ0NTA=",
  "number": 790,
  "title": "Allow specify block to fork at for \"mainnet-fork\"",
  "user": {
    "login": "yanncks",
    "id": 36580759,
    "node_id": "MDQ6VXNlcjM2NTgwNzU5",
    "avatar_url": "https://avatars.githubusercontent.com/u/36580759?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yanncks",
    "html_url": "https://github.com/yanncks",
    "followers_url": "https://api.github.com/users/yanncks/followers",
    "following_url": "https://api.github.com/users/yanncks/following{/other_user}",
    "gists_url": "https://api.github.com/users/yanncks/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yanncks/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yanncks/subscriptions",
    "organizations_url": "https://api.github.com/users/yanncks/orgs",
    "repos_url": "https://api.github.com/users/yanncks/repos",
    "events_url": "https://api.github.com/users/yanncks/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yanncks/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1114236590,
      "node_id": "MDU6TGFiZWwxMTE0MjM2NTkw",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2020-10-04T04:59:42Z",
  "updated_at": "2021-08-31T20:20:26Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Ganache supports specifying the block to fork at:\r\n`-f or --fork: Fork from another currently running Ethereum client at a given block. Input should be the HTTP location and port of the other client, e.g. http://localhost:8545. You can optionally specify the block to fork from using an @ sign: http://localhost:8545@1599200.`\r\n\r\nWould it be possible to surface this as a config or CLI option in brownie?",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/790/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703212981",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-703212981",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 703212981,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzIxMjk4MQ==",
    "user": {
      "login": "yanncks",
      "id": 36580759,
      "node_id": "MDQ6VXNlcjM2NTgwNzU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/36580759?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yanncks",
      "html_url": "https://github.com/yanncks",
      "followers_url": "https://api.github.com/users/yanncks/followers",
      "following_url": "https://api.github.com/users/yanncks/following{/other_user}",
      "gists_url": "https://api.github.com/users/yanncks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yanncks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yanncks/subscriptions",
      "organizations_url": "https://api.github.com/users/yanncks/orgs",
      "repos_url": "https://api.github.com/users/yanncks/repos",
      "events_url": "https://api.github.com/users/yanncks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yanncks/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-04T07:02:34Z",
    "updated_at": "2020-10-04T07:02:34Z",
    "author_association": "NONE",
    "body": "alternatively, it isn't clear from these docs how to revert state to a specific block https://eth-brownie.readthedocs.io/en/stable/core-chain.html?highlight=time%20travel#time-travel. is that possible?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703212981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703315098",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-703315098",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 703315098,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzMxNTA5OA==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-04T20:57:56Z",
    "updated_at": "2020-10-04T20:57:56Z",
    "author_association": "MEMBER",
    "body": "Should be possible, as a setting or cli flag, yes.  Since most users don't have an archive node and thus are limited to the most recent 128 blocks, I figured there wouldn't be much demand.  But it's not that hard to expose.\r\n\r\nFor time travel it isn't as easy.  Ganache lets you declare a height when you launch, but you can't adjust that value once it's already running. So you can only ever go back in time as far as the initial height that you forked at.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703315098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703364181",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-703364181",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 703364181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzM2NDE4MQ==",
    "user": {
      "login": "yanncks",
      "id": 36580759,
      "node_id": "MDQ6VXNlcjM2NTgwNzU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/36580759?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yanncks",
      "html_url": "https://github.com/yanncks",
      "followers_url": "https://api.github.com/users/yanncks/followers",
      "following_url": "https://api.github.com/users/yanncks/following{/other_user}",
      "gists_url": "https://api.github.com/users/yanncks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yanncks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yanncks/subscriptions",
      "organizations_url": "https://api.github.com/users/yanncks/orgs",
      "repos_url": "https://api.github.com/users/yanncks/repos",
      "events_url": "https://api.github.com/users/yanncks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yanncks/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T02:30:48Z",
    "updated_at": "2020-10-05T02:30:48Z",
    "author_association": "NONE",
    "body": "Oh I see. When using Infura, does that give you access to an archive node?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703364181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703533055",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-703533055",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 703533055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzUzMzA1NQ==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T10:04:14Z",
    "updated_at": "2020-10-05T10:04:14Z",
    "author_association": "MEMBER",
    "body": "Unfortunately not.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/703533055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/788175741",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-788175741",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 788175741,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4ODE3NTc0MQ==",
    "user": {
      "login": "lmittmann",
      "id": 3458786,
      "node_id": "MDQ6VXNlcjM0NTg3ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3458786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lmittmann",
      "html_url": "https://github.com/lmittmann",
      "followers_url": "https://api.github.com/users/lmittmann/followers",
      "following_url": "https://api.github.com/users/lmittmann/following{/other_user}",
      "gists_url": "https://api.github.com/users/lmittmann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lmittmann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lmittmann/subscriptions",
      "organizations_url": "https://api.github.com/users/lmittmann/orgs",
      "repos_url": "https://api.github.com/users/lmittmann/repos",
      "events_url": "https://api.github.com/users/lmittmann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lmittmann/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-01T18:37:06Z",
    "updated_at": "2021-03-01T18:37:06Z",
    "author_association": "NONE",
    "body": "Any update on exposing the fork block? ",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/788175741/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/857734483",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-857734483",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 857734483,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzczNDQ4Mw==",
    "user": {
      "login": "michaelbnewman",
      "id": 9017734,
      "node_id": "MDQ6VXNlcjkwMTc3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9017734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelbnewman",
      "html_url": "https://github.com/michaelbnewman",
      "followers_url": "https://api.github.com/users/michaelbnewman/followers",
      "following_url": "https://api.github.com/users/michaelbnewman/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelbnewman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelbnewman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelbnewman/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelbnewman/orgs",
      "repos_url": "https://api.github.com/users/michaelbnewman/repos",
      "events_url": "https://api.github.com/users/michaelbnewman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelbnewman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-09T14:18:28Z",
    "updated_at": "2021-06-09T14:18:28Z",
    "author_association": "NONE",
    "body": "I found a temporary solution is to run mainnet forking with hardhat at a specific block number I'm interested in, then connect brownie to that hardhat localhost RPC. Very handy for looking at internal transfers.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/857734483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/869108310",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-869108310",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 869108310,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2OTEwODMxMA==",
    "user": {
      "login": "0xalfalfa",
      "id": 86546366,
      "node_id": "MDQ6VXNlcjg2NTQ2MzY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/86546366?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xalfalfa",
      "html_url": "https://github.com/0xalfalfa",
      "followers_url": "https://api.github.com/users/0xalfalfa/followers",
      "following_url": "https://api.github.com/users/0xalfalfa/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xalfalfa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xalfalfa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xalfalfa/subscriptions",
      "organizations_url": "https://api.github.com/users/0xalfalfa/orgs",
      "repos_url": "https://api.github.com/users/0xalfalfa/repos",
      "events_url": "https://api.github.com/users/0xalfalfa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xalfalfa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-27T06:05:57Z",
    "updated_at": "2021-06-27T07:36:39Z",
    "author_association": "NONE",
    "body": "Here's my workaround:\r\n\r\n- You need an archive node to go back more than 128 blocks. You can get one with the with Alchemy free tier.\r\n- In brownie-config.yaml set the fork up like this (adapt accordingly if you have a local archive node):\r\n```networks:\r\n  mainnet-fork:\r\n    cmd_settings:\r\n        fork: https://eth-mainnet.alchemyapi.io/v2/$ALCHEMY_KEY$FORK_BLOCK_NUMBER\r\n```\r\n- In your .env file set `ALCHEMY_KEY=<ALCHECHMY_KEY>`\r\n- If you always want to go back to the same block, also set e.g. `FORK_BLOCK_NUMBER=@12710000` in the .env file.\r\n- If you want to go to a specific block in a python script, e.g. a test case, set the FORK_BLOCK_NUMBER environment variable in the first line of your python code:\r\n```\r\nimport os\r\nos.environ[\"FORK_BLOCK_NUMBER\"] = \"@127110000\"\r\n```\r\nThis will only work when starting your python script yourself or through your VSCode debugger or such. If you start with `brownie run` or `brownie test`, you have to set all env variables before starting brownie.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/869108310/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 3,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/909602208",
    "html_url": "https://github.com/eth-brownie/brownie/issues/790#issuecomment-909602208",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/790",
    "id": 909602208,
    "node_id": "IC_kwDOCUsNcc42N22g",
    "user": {
      "login": "gosuto-inzasheru",
      "id": 2835259,
      "node_id": "MDQ6VXNlcjI4MzUyNTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2835259?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gosuto-inzasheru",
      "html_url": "https://github.com/gosuto-inzasheru",
      "followers_url": "https://api.github.com/users/gosuto-inzasheru/followers",
      "following_url": "https://api.github.com/users/gosuto-inzasheru/following{/other_user}",
      "gists_url": "https://api.github.com/users/gosuto-inzasheru/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gosuto-inzasheru/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gosuto-inzasheru/subscriptions",
      "organizations_url": "https://api.github.com/users/gosuto-inzasheru/orgs",
      "repos_url": "https://api.github.com/users/gosuto-inzasheru/repos",
      "events_url": "https://api.github.com/users/gosuto-inzasheru/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gosuto-inzasheru/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-31T20:20:26Z",
    "updated_at": "2021-08-31T20:20:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "i like that work-around @0xalfalfa! i was thinking something similar but with some bash magic and run it through `brownie run`.\r\n\r\na proper implementation doesn't seem far away though, after finding out that `ganache-cli` already has the parameter `--fork_block_number`: https://github.com/trufflesuite/ganache/blob/master/README.md#options.\r\n\r\nappears to me it only needs to be supported by the `cmd-settings` part of the app that passes args to ganache? eg `brownie run --network mainnet-fork --fork_block_number 13131313`.\r\n\r\ndont know if i am the one to tackle this, but if anyone could give pointers on where to look in the code in order to prep a pr that would be cool :-) initial thought is to start by adding the cli flag here: https://github.com/eth-brownie/brownie/blob/master/brownie/network/rpc/ganache.py",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/909602208/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
