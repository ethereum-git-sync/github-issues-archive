{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/1667",
  "id": 1571646002,
  "node_id": "I_kwDOCUsNcc5drWoy",
  "number": 1667,
  "title": "basefee OPCODE support in london fork and Awaiting transaction in the mempool error",
  "user": {
    "login": "penandlim",
    "id": 4276174,
    "node_id": "MDQ6VXNlcjQyNzYxNzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4276174?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/penandlim",
    "html_url": "https://github.com/penandlim",
    "followers_url": "https://api.github.com/users/penandlim/followers",
    "following_url": "https://api.github.com/users/penandlim/following{/other_user}",
    "gists_url": "https://api.github.com/users/penandlim/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/penandlim/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/penandlim/subscriptions",
    "organizations_url": "https://api.github.com/users/penandlim/orgs",
    "repos_url": "https://api.github.com/users/penandlim/repos",
    "events_url": "https://api.github.com/users/penandlim/events{/privacy}",
    "received_events_url": "https://api.github.com/users/penandlim/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-02-05T22:43:38Z",
  "updated_at": "2023-04-20T15:36:23Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Environment information\r\n\r\n* `brownie` Version: 1.19.2\r\n* `ganache-cli` Version: 7.7.3\r\n* `solc` Version: 0.8.18\r\n* Python Version: 3.9.9\r\n* OS: osx M1\r\n\r\n### What was wrong?\r\n\r\nContracts that use `block.basefee` cannot be fetched from explorer due to `VirtualMachineError: invalid opcode`\r\nWhen instantiated with ABI, still fails in istanbul hardfork network at the time of simulation.\r\n\r\nTrying to use london as fork setting will accept the opcode but then get stuck with `Awaiting transaction in the mempool`\r\n\r\nThis can be replicated via this repo\r\nhttps://github.com/penandlim/brownie-base-fee-test\r\n\r\n> Replicating basefee fails using ape-safe and eth-brownie\r\n> \r\n> After applying the network-config.yaml, runing the below script fails due to invalid opcode\r\n> \r\n> `brownie run --network goerli-fork scripts/basefee_simulation_get_from_explorer.py`\r\n> Using the hardfork london setting still fails with same error\r\n> \r\n> `brownie run --network goerli-fork-london scripts/basefee_simulation_get_from_explorer.py`\r\n> If we try bypassing compiling by providing the ABI, we encounter a new error. The transaction gets stuck with Awaiting transaction in the mempool and does not proceed.\r\n> \r\n> `brownie run --network goerli-fork-london scripts/basefee_simulation_from_abi.py`\r\n\r\n### How can it be fixed?\r\n\r\nAllow compiling with london evm_version when contracts are fetched from explorer.\r\nAllow using 0 gwei for gas to prevent tx from getting stuck .\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1510636715",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1667#issuecomment-1510636715",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667",
    "id": 1510636715,
    "node_id": "IC_kwDOCUsNcc5aCnyr",
    "user": {
      "login": "Shchepetov",
      "id": 61561908,
      "node_id": "MDQ6VXNlcjYxNTYxOTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61561908?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Shchepetov",
      "html_url": "https://github.com/Shchepetov",
      "followers_url": "https://api.github.com/users/Shchepetov/followers",
      "following_url": "https://api.github.com/users/Shchepetov/following{/other_user}",
      "gists_url": "https://api.github.com/users/Shchepetov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Shchepetov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Shchepetov/subscriptions",
      "organizations_url": "https://api.github.com/users/Shchepetov/orgs",
      "repos_url": "https://api.github.com/users/Shchepetov/repos",
      "events_url": "https://api.github.com/users/Shchepetov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Shchepetov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-17T03:19:06Z",
    "updated_at": "2023-04-17T03:19:06Z",
    "author_association": "NONE",
    "body": "Bumping this, this is an extremely necessary change",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1510636715/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1510637218",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1667#issuecomment-1510637218",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667",
    "id": 1510637218,
    "node_id": "IC_kwDOCUsNcc5aCn6i",
    "user": {
      "login": "Shchepetov",
      "id": 61561908,
      "node_id": "MDQ6VXNlcjYxNTYxOTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61561908?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Shchepetov",
      "html_url": "https://github.com/Shchepetov",
      "followers_url": "https://api.github.com/users/Shchepetov/followers",
      "following_url": "https://api.github.com/users/Shchepetov/following{/other_user}",
      "gists_url": "https://api.github.com/users/Shchepetov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Shchepetov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Shchepetov/subscriptions",
      "organizations_url": "https://api.github.com/users/Shchepetov/orgs",
      "repos_url": "https://api.github.com/users/Shchepetov/repos",
      "events_url": "https://api.github.com/users/Shchepetov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Shchepetov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-17T03:20:23Z",
    "updated_at": "2023-04-17T03:20:23Z",
    "author_association": "NONE",
    "body": "@penandlim can you please tell, have you found a workaround for this?",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1510637218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1511716099",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1667#issuecomment-1511716099",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667",
    "id": 1511716099,
    "node_id": "IC_kwDOCUsNcc5aGvUD",
    "user": {
      "login": "penandlim",
      "id": 4276174,
      "node_id": "MDQ6VXNlcjQyNzYxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4276174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/penandlim",
      "html_url": "https://github.com/penandlim",
      "followers_url": "https://api.github.com/users/penandlim/followers",
      "following_url": "https://api.github.com/users/penandlim/following{/other_user}",
      "gists_url": "https://api.github.com/users/penandlim/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/penandlim/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/penandlim/subscriptions",
      "organizations_url": "https://api.github.com/users/penandlim/orgs",
      "repos_url": "https://api.github.com/users/penandlim/repos",
      "events_url": "https://api.github.com/users/penandlim/events{/privacy}",
      "received_events_url": "https://api.github.com/users/penandlim/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-17T16:38:06Z",
    "updated_at": "2023-04-17T16:39:29Z",
    "author_association": "NONE",
    "body": "@Shchepetov Unforuntately no :(\r\n\r\nUsing ganache v7 + brownie 1.19.2 with impartial support for forking seems at best right now. (workaround for waiting in mempool but the new opcodes still doesnt work)\r\n\r\nUnfortunately we aren't able to fork and test all contracts using brownie so we have moved to using foundry and hardhat more when we can with tenderly as another supportive tool.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1511716099/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1516547295",
    "html_url": "https://github.com/eth-brownie/brownie/issues/1667#issuecomment-1516547295",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/1667",
    "id": 1516547295,
    "node_id": "IC_kwDOCUsNcc5aZKzf",
    "user": {
      "login": "penandlim",
      "id": 4276174,
      "node_id": "MDQ6VXNlcjQyNzYxNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4276174?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/penandlim",
      "html_url": "https://github.com/penandlim",
      "followers_url": "https://api.github.com/users/penandlim/followers",
      "following_url": "https://api.github.com/users/penandlim/following{/other_user}",
      "gists_url": "https://api.github.com/users/penandlim/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/penandlim/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/penandlim/subscriptions",
      "organizations_url": "https://api.github.com/users/penandlim/orgs",
      "repos_url": "https://api.github.com/users/penandlim/repos",
      "events_url": "https://api.github.com/users/penandlim/events{/privacy}",
      "received_events_url": "https://api.github.com/users/penandlim/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-20T15:36:22Z",
    "updated_at": "2023-04-20T15:36:22Z",
    "author_association": "NONE",
    "body": "@Shchepetov \n\nApeworkx/ape package might be able to be used as an alternative. I havent tried it yet but looks like a successor of the brownie project.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/1516547295/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
