{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/709",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/709/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/709/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/709/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/709",
  "id": 672061578,
  "node_id": "MDU6SXNzdWU2NzIwNjE1Nzg=",
  "number": 709,
  "title": "Use `evm_mine` to control the block times",
  "user": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1114236590,
      "node_id": "MDU6TGFiZWwxMTE0MjM2NTkw",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/milestones/13",
    "html_url": "https://github.com/eth-brownie/brownie/milestone/13",
    "labels_url": "https://api.github.com/repos/eth-brownie/brownie/milestones/13/labels",
    "id": 6870201,
    "node_id": "MDk6TWlsZXN0b25lNjg3MDIwMQ==",
    "number": 13,
    "title": "Brownie 1.15.0",
    "description": "Issues to complete for the next minor release.",
    "creator": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 4,
    "closed_issues": 8,
    "state": "open",
    "created_at": "2021-06-19T10:37:20Z",
    "updated_at": "2021-08-09T06:32:04Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 1,
  "created_at": "2020-08-03T13:04:34Z",
  "updated_at": "2021-06-19T10:41:22Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Ganache adds challenges when testing time-dependent behaviors, because the clock is always advancing. This can be mitigated by disabling auto-mine with [`miner_stop`](https://github.com/ethereum/go-ethereum/wiki/Management-APIs#miner_stop) and then controlling the mining process manually with `evm_mine`.  `evm_mine` accepts a timestamp as an optional argument, which we can use to force the blocktimes.\r\n\r\nUnder the hood this could require some significant changes, so it probably belongs in the context of Brownie v2. I think happening in a middleware makes sense, where any call to `eth_sendTransaction` spawns and waits for thread that calls `evm_mine`.\r\n\r\nAnother benefit I see here is the issue with calls-as-transactions sometimes causing issues when the called method relies on a timestamp. For these calls we can always force the mined block to have a timestamp `==` that of the last transaction, and then we can trust the return value.\r\n\r\nI'm not sure how to best expose something like this to the user.  Two ideas come to mind:\r\n\r\n1. `chain.set_blocktime(seconds=None)` where if `seconds` is `None` the clock advances normally, otherwise each block is exactly `seconds` apart.\r\n2. As a context manager...  `with chain.blocktimes(seconds): ...` to temporarily override the default behavior.\r\n\r\nIn implementing this, there will also need to be consideration for how `chain.sleep` and `chain.time` work.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/709/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/709/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/803540961",
    "html_url": "https://github.com/eth-brownie/brownie/issues/709#issuecomment-803540961",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/709",
    "id": 803540961,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzU0MDk2MQ==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-21T09:28:23Z",
    "updated_at": "2021-03-21T09:28:23Z",
    "author_association": "MEMBER",
    "body": "With the general middleware framework added in #997, I think this should be much easier to implement.\r\n\r\nAlso, once hardhat support arrives this can be accomplished using [`evm_setNextBlockTimestamp`](https://hardhat.org/hardhat-network/#special-testing-debugging-methods).",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/803540961/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
