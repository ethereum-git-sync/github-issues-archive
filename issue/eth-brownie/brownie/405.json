{
  "url": "https://api.github.com/repos/eth-brownie/brownie/issues/405",
  "repository_url": "https://api.github.com/repos/eth-brownie/brownie",
  "labels_url": "https://api.github.com/repos/eth-brownie/brownie/issues/405/labels{/name}",
  "comments_url": "https://api.github.com/repos/eth-brownie/brownie/issues/405/comments",
  "events_url": "https://api.github.com/repos/eth-brownie/brownie/issues/405/events",
  "html_url": "https://github.com/eth-brownie/brownie/issues/405",
  "id": 598402746,
  "node_id": "MDU6SXNzdWU1OTg0MDI3NDY=",
  "number": 405,
  "title": "Support for --optimize-yul in brownie-config.yaml",
  "user": {
    "login": "jonathanmalo",
    "id": 7378938,
    "node_id": "MDQ6VXNlcjczNzg5Mzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7378938?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jonathanmalo",
    "html_url": "https://github.com/jonathanmalo",
    "followers_url": "https://api.github.com/users/jonathanmalo/followers",
    "following_url": "https://api.github.com/users/jonathanmalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/jonathanmalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jonathanmalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jonathanmalo/subscriptions",
    "organizations_url": "https://api.github.com/users/jonathanmalo/orgs",
    "repos_url": "https://api.github.com/users/jonathanmalo/repos",
    "events_url": "https://api.github.com/users/jonathanmalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jonathanmalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1319496835,
      "node_id": "MDU6TGFiZWwxMzE5NDk2ODM1",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/compiler",
      "name": "compiler",
      "color": "bfd4f2",
      "default": false,
      "description": "Related to contract compilation"
    },
    {
      "id": 1319593249,
      "node_id": "MDU6TGFiZWwxMzE5NTkzMjQ5",
      "url": "https://api.github.com/repos/eth-brownie/brownie/labels/priority",
      "name": "priority",
      "color": "ee0014",
      "default": false,
      "description": "Should be included in next release"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/milestones/9",
    "html_url": "https://github.com/eth-brownie/brownie/milestone/9",
    "labels_url": "https://api.github.com/repos/eth-brownie/brownie/milestones/9/labels",
    "id": 5275531,
    "node_id": "MDk6TWlsZXN0b25lNTI3NTUzMQ==",
    "number": 9,
    "title": "Brownie 1.7.0",
    "description": "Target issues for the next minor release.",
    "creator": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 7,
    "state": "closed",
    "created_at": "2020-04-05T07:33:23Z",
    "updated_at": "2020-04-27T21:22:14Z",
    "due_on": null,
    "closed_at": "2020-04-27T21:22:14Z"
  },
  "comments": 1,
  "created_at": "2020-04-12T03:39:28Z",
  "updated_at": "2020-04-13T15:12:47Z",
  "closed_at": "2020-04-13T15:12:47Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Overview\r\n* What you are trying to do\r\nPass --optimize-yul to solc.\r\n* Why Brownie's current functionality is inadequate to address your goal\r\nCompiling the 0x asset proxy contracts may require the --optimize-yul solc option. To see what I mean, clone the repository https://github.com/jonathanmalo/brownie-0x and run the `refactor.sh` script. This throws an error:\r\n```\r\nCompilerError: Compiler returned the following errors:\r\nYulException: Stack too deep when compiling inline assembly: Variable assetDataOffset is 2 slot(s) too deep inside the stack.\r\n```\r\nWhich seems to be related to the inline assembly found in contracts-asset-proxy/contracts/src/MultiAssetProxy.sol. A \"Stack too deep\" error was corrected with the --optimize-yul option in https://github.com/ethereum/solidity/issues/6392 and this option is set in https://github.com/0xProject/0x-monorepo/blob/development/contracts/asset-proxy/compiler.json#L12. This sol-compiler config file (compiler.json) also suggests that common subexpression elimination (opetion \"cse\") and \"constantOptimizer\" may need to be set for successful compile.\r\nIn earlier versions of solc, the yul optimizer, which optimizes stack slot allocation for inline assembly, was not enabled by default: https://solidity.readthedocs.io/en/v0.6.6/using-the-compiler.html\r\n```\r\n        // The new Yul optimizer. Mostly operates on the code of ABIEncoderV2\r\n        // and inline assembly.\r\n        // It is activated together with the global optimizer setting\r\n        // and can be deactivated here.\r\n        // Before Solidity 0.6.0 it had to be activated through this switch.\r\n        \"yul\": false,\r\n        // Tuning options for the Yul optimizer.\r\n        \"yulDetails\": {\r\n          // Improve allocation of stack slots for variables, can free up stack slots early.\r\n          // Activated by default if the Yul optimizer is activated.\r\n          \"stackAllocation\": true\r\n        }\r\n```\r\n\r\n### Specification\r\nThe option could be passed via another field in brownie-config.yaml: `optimize-yul: true` May as well add all optimization options to future proof this type of issue. However, it may be simpler to add support for sol-compiler to brownie for this particular use case.\r\n\r\nThanks for all your help so far.\r\n",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/405/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/eth-brownie/brownie/issues/405/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/612625748",
    "html_url": "https://github.com/eth-brownie/brownie/issues/405#issuecomment-612625748",
    "issue_url": "https://api.github.com/repos/eth-brownie/brownie/issues/405",
    "id": 612625748,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMjYyNTc0OA==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-12T14:38:33Z",
    "updated_at": "2020-04-12T14:38:33Z",
    "author_association": "MEMBER",
    "body": "Adding support for other optimizer settings in the config file should be fairly straightforward.  I'll have a look at it right away.",
    "reactions": {
      "url": "https://api.github.com/repos/eth-brownie/brownie/issues/comments/612625748/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
