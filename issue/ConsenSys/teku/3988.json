{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/3988",
  "id": 891787665,
  "node_id": "MDU6SXNzdWU4OTE3ODc2NjU=",
  "number": 3988,
  "title": "Build for tag 21.5.0 fails on clean checkout",
  "user": {
    "login": "tdiesler",
    "id": 244946,
    "node_id": "MDQ6VXNlcjI0NDk0Ng==",
    "avatar_url": "https://avatars.githubusercontent.com/u/244946?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tdiesler",
    "html_url": "https://github.com/tdiesler",
    "followers_url": "https://api.github.com/users/tdiesler/followers",
    "following_url": "https://api.github.com/users/tdiesler/following{/other_user}",
    "gists_url": "https://api.github.com/users/tdiesler/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tdiesler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tdiesler/subscriptions",
    "organizations_url": "https://api.github.com/users/tdiesler/orgs",
    "repos_url": "https://api.github.com/users/tdiesler/repos",
    "events_url": "https://api.github.com/users/tdiesler/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tdiesler/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-05-14T09:57:15Z",
  "updated_at": "2021-05-17T01:12:09Z",
  "closed_at": "2021-05-16T21:34:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nThe build for the latest tag fails on RaspberryPi\r\n\r\n```\r\n> Task :teku:compileJava\r\nNote: Some input files use or override a deprecated API.\r\nNote: Recompile with -Xlint:deprecation for details.\r\n> Task :checkMavenCoordinateCollisions FAILED\r\nFAILURE: Build failed with an exception.\r\n* Where:\r\nBuild file '/home/pi/git/teku/build.gradle' line: 261\r\n* What went wrong:\r\nExecution failed for task ':checkMavenCoordinateCollisions'.\r\n> Basedir /home/pi/git/teku/http does not exist\r\n```\r\n\r\nIs `teku/http` supposed to be there?\r\n\r\n### Versions (Add all that apply)\r\n* Software version: 21.5.0\r\n* Java version: openjdk 11.0.11 2021-04-20\r\n* OS Name & Version: Debian10\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/3988/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841580470",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841580470",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841580470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTU4MDQ3MA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-15T01:41:29Z",
    "updated_at": "2021-05-15T01:41:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "What was the exact command you ran? \r\n\r\nThere shouldn't be a teku/http directory so I'm not exactly sure why its looking for it.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841580470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841603496",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841603496",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841603496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTYwMzQ5Ng==",
    "user": {
      "login": "tdiesler",
      "id": 244946,
      "node_id": "MDQ6VXNlcjI0NDk0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/244946?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tdiesler",
      "html_url": "https://github.com/tdiesler",
      "followers_url": "https://api.github.com/users/tdiesler/followers",
      "following_url": "https://api.github.com/users/tdiesler/following{/other_user}",
      "gists_url": "https://api.github.com/users/tdiesler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tdiesler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tdiesler/subscriptions",
      "organizations_url": "https://api.github.com/users/tdiesler/orgs",
      "repos_url": "https://api.github.com/users/tdiesler/repos",
      "events_url": "https://api.github.com/users/tdiesler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tdiesler/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-15T05:22:11Z",
    "updated_at": "2021-05-15T05:22:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Same failure shows on MacOS\r\n\r\n```\r\n$ git log --oneline\r\n7f8105062 (HEAD, tag: 21.5.0) Add cli option to override the altair fork block and enable it (#3961)\r\n...\r\n\r\n$ ./gradlew clean build\r\n...\r\n> Task :checkMavenCoordinateCollisions FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* Where:\r\nBuild file '.../teku/build.gradle' line: 261\r\n\r\n* What went wrong:\r\nExecution failed for task ':checkMavenCoordinateCollisions'.\r\n> Basedir .../teku/http does not exist\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841603496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841636093",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841636093",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841636093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTYzNjA5Mw==",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-15T10:25:46Z",
    "updated_at": "2021-05-15T10:31:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can reproduce this on Linux from a fresh clone:\r\n\r\n```\r\ntmp> git clone https://github.com/ConsenSys/teku.git\r\ntmp> cd teku\r\nteku> ./gradlew build\r\n> Task :checkMavenCoordinateCollisions FAILED\r\n\r\nFAILURE: Build failed with an exception.\r\n\r\n* Where:\r\nBuild file '/tmp/teku/build.gradle' line: 261\r\n\r\n* What went wrong:\r\nExecution failed for task ':checkMavenCoordinateCollisions'.\r\n> Basedir /tmp/teku/http does not exist\r\n```\r\n\r\nThe following workaround, however, succeeds: manually creating the `http` directory before building.\r\n```\r\ntmp> git clone https://github.com/ConsenSys/teku.git\r\ntmp> cd teku\r\nteku> mkdir http\r\nteku> ./gradlew build\r\n...\r\nBUILD SUCCESSFUL in 4m 45s\r\n504 actionable tasks: 504 executed\r\n```\r\n\r\nI'll leave it to greater minds than mine to work out why.\r\n\r\nNote that, after building, the `http` directory contains only a `build` directory (which has stuff in it), but this is ignored by git due to the `.gitignore` rules. Thus, git thinks `http` is empty and therefore does not include it in the archive. Old installations with a pre-existing `http` directory will work, and git doesn't know the difference.\r\n\r\n```\r\nteku> ls -l http\r\ntotal 0\r\ndrwxrwxr-x 5 ben ben 100 May 15 11:21 build\r\nteku> git status\r\nOn branch master\r\nYour branch is up-to-date with 'origin/master'.\r\n\r\nnothing to commit, working tree clean\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841636093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841810126",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841810126",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841810126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTgxMDEyNg==",
    "user": {
      "login": "tdiesler",
      "id": 244946,
      "node_id": "MDQ6VXNlcjI0NDk0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/244946?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tdiesler",
      "html_url": "https://github.com/tdiesler",
      "followers_url": "https://api.github.com/users/tdiesler/followers",
      "following_url": "https://api.github.com/users/tdiesler/following{/other_user}",
      "gists_url": "https://api.github.com/users/tdiesler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tdiesler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tdiesler/subscriptions",
      "organizations_url": "https://api.github.com/users/tdiesler/orgs",
      "repos_url": "https://api.github.com/users/tdiesler/repos",
      "events_url": "https://api.github.com/users/tdiesler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tdiesler/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-16T12:24:23Z",
    "updated_at": "2021-05-16T12:24:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Merci, I can work with that",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841810126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841879729",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841879729",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841879729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTg3OTcyOQ==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-16T21:23:58Z",
    "updated_at": "2021-05-16T21:23:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah that's a fun one.  So it turns out there was still a reference to a `http` module in the gradle config which didn't exist.  If you ran `spotlessCheck` or `spotlessApply` the directory would be created and everything works, but if the `checkMavenCoordinateCollisions` task ran before that directory got created it would fail. Both tasks run as part of the default build but the order isn't guaranteed.\r\n\r\nSo creating the directory is the right work around for 21.5.0 and #3991 will fix it for the next release.\r\n\r\nThanks for reporting this and sorry for the inconvenience.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841879729/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841914164",
    "html_url": "https://github.com/ConsenSys/teku/issues/3988#issuecomment-841914164",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3988",
    "id": 841914164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTkxNDE2NA==",
    "user": {
      "login": "tdiesler",
      "id": 244946,
      "node_id": "MDQ6VXNlcjI0NDk0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/244946?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tdiesler",
      "html_url": "https://github.com/tdiesler",
      "followers_url": "https://api.github.com/users/tdiesler/followers",
      "following_url": "https://api.github.com/users/tdiesler/following{/other_user}",
      "gists_url": "https://api.github.com/users/tdiesler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tdiesler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tdiesler/subscriptions",
      "organizations_url": "https://api.github.com/users/tdiesler/orgs",
      "repos_url": "https://api.github.com/users/tdiesler/repos",
      "events_url": "https://api.github.com/users/tdiesler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tdiesler/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-17T01:12:09Z",
    "updated_at": "2021-05-17T01:12:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "UR welcome",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/841914164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
