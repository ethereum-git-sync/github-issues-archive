{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6130",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6130",
  "id": 1350895194,
  "node_id": "I_kwDOCM9I9M5QhQZa",
  "number": 6130,
  "title": "Teku validator client requires fee recipient before Bellatrix upgrade",
  "user": {
    "login": "ybstaked",
    "id": 85460995,
    "node_id": "MDQ6VXNlcjg1NDYwOTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/85460995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ybstaked",
    "html_url": "https://github.com/ybstaked",
    "followers_url": "https://api.github.com/users/ybstaked/followers",
    "following_url": "https://api.github.com/users/ybstaked/following{/other_user}",
    "gists_url": "https://api.github.com/users/ybstaked/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ybstaked/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ybstaked/subscriptions",
    "organizations_url": "https://api.github.com/users/ybstaked/orgs",
    "repos_url": "https://api.github.com/users/ybstaked/repos",
    "events_url": "https://api.github.com/users/ybstaked/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ybstaked/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-08-25T13:23:26Z",
  "updated_at": "2022-09-01T22:38:27Z",
  "closed_at": "2022-09-01T22:38:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\n- Teku validator client requires fee recipient before Bellatrix upgrade, prysm validator client does not.  This miss in config caused many of our validators to miss attestations\r\n\r\n### Steps to Reproduce (Bug)\r\n[Please be as specific as possible]\r\n- teku beacon upgraded to 22.8.1 and configured with default fee recipient\r\n- teku validator client running at 22.6.1 (not upgraded as we did not want to restart yet)\r\n\r\n\r\n**Expected behavior:** [What you expect to happen]\r\n- Consistent behavior as prysm\r\n- Backwards compatibility between beacon and validator client\r\n- Make it clear in release notes at what point exactly the config is needed\r\n\r\n**Actual behavior:** [What actually happens]\r\n- Failed with:\r\n\r\n```\r\n[eth-validator-teku-eth-wallet-0222-0] Invalid configuration. --validators-proposer-default-fee-recipient or --validators-proposer-config must be specified when Bellatrix milestone is active\r\n```\r\n\r\n**Frequency:** [How regularly does it occur?]\r\n\r\n### Versions (Add all that apply)\r\n* Software version: [`teku --version` or look for log lines starting with `Teku version:`] teku beacon: 22.8.1; teku validator client: 22.6.1\r\n* Java version: [`java -version`]\r\n* OS Name & Version: [`cat /etc/*release`]\r\n* Docker Version: [`docker version`]\r\n* Cloud VM, type, size: [Amazon Web Services I3-large]",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6130/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1227745697",
    "html_url": "https://github.com/ConsenSys/teku/issues/6130#issuecomment-1227745697",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130",
    "id": 1227745697,
    "node_id": "IC_kwDOCM9I9M5JLemh",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T20:45:45Z",
    "updated_at": "2022-08-25T20:45:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for raising this, can you confirm your validator-client was either not specifying `--network` or was using `--network=auto`?\n\nThis setting would fetch network settings from the beacon-node when it connects, and that would result in the VC getting informed of the pending bellatrix network upgrade, and it would behave as you are describing...\n\nA workaround would be to specify `--validators-proposer-default-fee-recipient`, and you'll be able to continue to use the old VC with the new network configuration, and be compliant with the minimal requirements for the merge. If we were to default the setting, it'd be to 0x00, and that'd cause the flow on effect of burning any earnt eth silently if you don't give an appropriate value.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1227745697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1227765060",
    "html_url": "https://github.com/ConsenSys/teku/issues/6130#issuecomment-1227765060",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130",
    "id": 1227765060,
    "node_id": "IC_kwDOCM9I9M5JLjVE",
    "user": {
      "login": "ybstaked",
      "id": 85460995,
      "node_id": "MDQ6VXNlcjg1NDYwOTk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/85460995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ybstaked",
      "html_url": "https://github.com/ybstaked",
      "followers_url": "https://api.github.com/users/ybstaked/followers",
      "following_url": "https://api.github.com/users/ybstaked/following{/other_user}",
      "gists_url": "https://api.github.com/users/ybstaked/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ybstaked/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ybstaked/subscriptions",
      "organizations_url": "https://api.github.com/users/ybstaked/orgs",
      "repos_url": "https://api.github.com/users/ybstaked/repos",
      "events_url": "https://api.github.com/users/ybstaked/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ybstaked/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T21:09:23Z",
    "updated_at": "2022-08-25T21:09:23Z",
    "author_association": "NONE",
    "body": "yes, validator client was using `--network=auto`, and we fixed it by specifying `--validators-proposer-config` and upgrading validator client to 22.8.1.  But we had to do it more as a firedrill, rather than the intended planned rollout to beacons first and then validator clients.  \r\n\r\nNot sure, there is much to fix here, other than docs and consistent workflow as prysm for next time.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1227765060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1234857619",
    "html_url": "https://github.com/ConsenSys/teku/issues/6130#issuecomment-1234857619",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6130",
    "id": 1234857619,
    "node_id": "IC_kwDOCM9I9M5Jmm6T",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T22:38:26Z",
    "updated_at": "2022-09-01T22:38:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok, going to close this one. We expect that fee recipient is required for any network where bellatrix is scheduled. I can see why this is a bit surprising given the VC didn't update, but it was still a configuration change applied to the validator client which caused it. This is a one off transition where we had to make a choice between refusing to startup when required config is missing or running with the invalid config and then failing when the merge actually happened (or burning the fees).  We went with refusing to start because it's much more visible, ensuring the configuration problem gets fixed rather than missing block proposals (which is also then bad for overall network health).",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1234857619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
