{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/7238",
  "id": 1747189666,
  "node_id": "I_kwDOCM9I9M5oI_-i",
  "number": 7238,
  "title": "Insane amount of data written during synchronisation",
  "user": {
    "login": "RogerHKW",
    "id": 135605677,
    "node_id": "U_kgDOCBUtrQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/135605677?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/RogerHKW",
    "html_url": "https://github.com/RogerHKW",
    "followers_url": "https://api.github.com/users/RogerHKW/followers",
    "following_url": "https://api.github.com/users/RogerHKW/following{/other_user}",
    "gists_url": "https://api.github.com/users/RogerHKW/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/RogerHKW/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/RogerHKW/subscriptions",
    "organizations_url": "https://api.github.com/users/RogerHKW/orgs",
    "repos_url": "https://api.github.com/users/RogerHKW/repos",
    "events_url": "https://api.github.com/users/RogerHKW/events{/privacy}",
    "received_events_url": "https://api.github.com/users/RogerHKW/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-06-08T06:43:46Z",
  "updated_at": "2023-06-13T08:23:50Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Basically, when launching a new node from scratch, Teku wears out 1 TB of SSD for 6 GB of effective data stored. Maybe is there something to optimize in the software when it rewrites 166× everything ?\n\nAfter the synchronisation, the problem stops.\n\nI noticed this problem with `smartctl` on my Samsung Evo 970 Plus last week (31 TB written for 1 TB of data stored after synchronisation with Mainnet) but I was not sure whether it was a bug of smartctl or Besu or the controller of the SSD. Since then, I separated Teku and Besu on two different SSDs. I'm synchronizing with Görli since yesterday and today I notice that the new SSD devoted to Teku (Samsung PM961) stores 6GB more data but the _Data units written_ field of `smartctl` gained almost 1 TB. `iostat` confirms that 1TB has been written since yesterday on this disk used exclusively by Teku.\n\nNo swap. Teku runs with _-Xmx22G_. There is always between 10 and 17 GB of RAM free (so used by Linux to cache files).",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/7238/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1587717441",
    "html_url": "https://github.com/ConsenSys/teku/issues/7238#issuecomment-1587717441",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
    "id": 1587717441,
    "node_id": "IC_kwDOCM9I9M5eoqVB",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-12T17:00:12Z",
    "updated_at": "2023-06-12T17:00:12Z",
    "author_association": "NONE",
    "body": "Is this a checkpoint sync?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1587717441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1587745689",
    "html_url": "https://github.com/ConsenSys/teku/issues/7238#issuecomment-1587745689",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
    "id": 1587745689,
    "node_id": "IC_kwDOCM9I9M5eoxOZ",
    "user": {
      "login": "RogerHKW",
      "id": 135605677,
      "node_id": "U_kgDOCBUtrQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/135605677?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RogerHKW",
      "html_url": "https://github.com/RogerHKW",
      "followers_url": "https://api.github.com/users/RogerHKW/followers",
      "following_url": "https://api.github.com/users/RogerHKW/following{/other_user}",
      "gists_url": "https://api.github.com/users/RogerHKW/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RogerHKW/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RogerHKW/subscriptions",
      "organizations_url": "https://api.github.com/users/RogerHKW/orgs",
      "repos_url": "https://api.github.com/users/RogerHKW/repos",
      "events_url": "https://api.github.com/users/RogerHKW/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RogerHKW/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-12T17:18:13Z",
    "updated_at": "2023-06-12T17:18:13Z",
    "author_association": "NONE",
    "body": "I tried both and it seems to write less with a checkpoint : about ×20 instead of ×166.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1587745689/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588247956",
    "html_url": "https://github.com/ConsenSys/teku/issues/7238#issuecomment-1588247956",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
    "id": 1588247956,
    "node_id": "IC_kwDOCM9I9M5eqr2U",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-12T23:33:13Z",
    "updated_at": "2023-06-12T23:33:13Z",
    "author_association": "NONE",
    "body": "Given that checkpoint sync is the preferred, safer, recommended way, I’m not sure this is a thing that needs to be fixed. ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588247956/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588474851",
    "html_url": "https://github.com/ConsenSys/teku/issues/7238#issuecomment-1588474851",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
    "id": 1588474851,
    "node_id": "IC_kwDOCM9I9M5erjPj",
    "user": {
      "login": "RogerHKW",
      "id": 135605677,
      "node_id": "U_kgDOCBUtrQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/135605677?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RogerHKW",
      "html_url": "https://github.com/RogerHKW",
      "followers_url": "https://api.github.com/users/RogerHKW/followers",
      "following_url": "https://api.github.com/users/RogerHKW/following{/other_user}",
      "gists_url": "https://api.github.com/users/RogerHKW/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RogerHKW/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RogerHKW/subscriptions",
      "organizations_url": "https://api.github.com/users/RogerHKW/orgs",
      "repos_url": "https://api.github.com/users/RogerHKW/repos",
      "events_url": "https://api.github.com/users/RogerHKW/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RogerHKW/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-13T03:40:08Z",
    "updated_at": "2023-06-13T04:00:05Z",
    "author_association": "NONE",
    "body": "There is malfunction in the code which rewrites every byte at least 20 times within two days and that's fine? Is it how serious the developers of a software managing tens of billions dollars are?\n\nYou are kidding right? If not, it might also explain why Teku (and Besu) use way more RAM than specified with `-Xmx`. What's next? 99% of the CPU consistently and it's fine as long it's not 100?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588474851/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588796918",
    "html_url": "https://github.com/ConsenSys/teku/issues/7238#issuecomment-1588796918",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/7238",
    "id": 1588796918,
    "node_id": "IC_kwDOCM9I9M5esx32",
    "user": {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-13T08:23:50Z",
    "updated_at": "2023-06-13T08:23:50Z",
    "author_association": "MEMBER",
    "body": "@RogerHKW I appreciate the feedback and the details from your investigation and reporting this to the team. We will take a look into it.\r\n\r\nAs a separate note, please keep in mind that we have a [code of conduct](https://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md) for our projects and it applies to any of the developers that contribute to the project and people participating in the community (Discord, GH Issues, etc.). We do ask you to be mindful of your tone and the way you talk to our developers and members of the community. We won't tolerate abusive behaviour.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1588796918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
