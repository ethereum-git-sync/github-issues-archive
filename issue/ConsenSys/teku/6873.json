{
  "url": "https://api.github.com/repos/Consensys/teku/issues/6873",
  "repository_url": "https://api.github.com/repos/Consensys/teku",
  "labels_url": "https://api.github.com/repos/Consensys/teku/issues/6873/labels{/name}",
  "comments_url": "https://api.github.com/repos/Consensys/teku/issues/6873/comments",
  "events_url": "https://api.github.com/repos/Consensys/teku/issues/6873/events",
  "html_url": "https://github.com/Consensys/teku/issues/6873",
  "id": 1601442539,
  "node_id": "I_kwDOCM9I9M5fdBLr",
  "number": 6873,
  "title": "Review of peer connection strategy after network outage",
  "user": {
    "login": "zilm13",
    "id": 6196452,
    "node_id": "MDQ6VXNlcjYxOTY0NTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6196452?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zilm13",
    "html_url": "https://github.com/zilm13",
    "followers_url": "https://api.github.com/users/zilm13/followers",
    "following_url": "https://api.github.com/users/zilm13/following{/other_user}",
    "gists_url": "https://api.github.com/users/zilm13/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zilm13/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zilm13/subscriptions",
    "organizations_url": "https://api.github.com/users/zilm13/orgs",
    "repos_url": "https://api.github.com/users/zilm13/repos",
    "events_url": "https://api.github.com/users/zilm13/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zilm13/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-02-27T15:45:37Z",
  "updated_at": "2023-07-12T14:16:05Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\nCurrent strategy is good when peer starts but is lagging when recovering from network outage. From initial research changes that were made in #6139 are not relevant here, we have enough peers in discovery.\r\nSo, the most common issues are:\r\n- not enough connected peers after recovery\r\n- not enough connected peers in all needed subnets after recovery",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/Consensys/teku/issues/6873/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/Consensys/teku/issues/6873/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1534314337",
    "html_url": "https://github.com/Consensys/teku/issues/6873#issuecomment-1534314337",
    "issue_url": "https://api.github.com/repos/Consensys/teku/issues/6873",
    "id": 1534314337,
    "node_id": "IC_kwDOCM9I9M5bc8dh",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-04T08:40:09Z",
    "updated_at": "2023-05-04T08:40:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "We would like to see subnet subscriptions recover within minutes on mainnet, not hours...\n\nStart by looking at `ConnectionManager` and `PeerSelectionStrategy`\n\nSpecific issues also after network outage without even restarting teku... this may be harder to reproduce... Could potentially use an AWS node and stop its network for 20 minutes or similar... ",
    "reactions": {
      "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1534314337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1632612498",
    "html_url": "https://github.com/Consensys/teku/issues/6873#issuecomment-1632612498",
    "issue_url": "https://api.github.com/repos/Consensys/teku/issues/6873",
    "id": 1632612498,
    "node_id": "IC_kwDOCM9I9M5hT7CS",
    "user": {
      "login": "StefanBratanov",
      "id": 14827647,
      "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/StefanBratanov",
      "html_url": "https://github.com/StefanBratanov",
      "followers_url": "https://api.github.com/users/StefanBratanov/followers",
      "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
      "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
      "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
      "repos_url": "https://api.github.com/users/StefanBratanov/repos",
      "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-12T14:16:05Z",
    "updated_at": "2023-07-12T14:16:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sharing BN logs of an user of Discord who experienced network outage and had missed attestation due to VC using this BN as primary and it switched back to it prematurely before having enough peers (because chain was synced somehow). It' s worth investigating why we were still connected to 6 peers without network connectivity as well as following an empty chain.\r\n\r\n[message.txt](https://github.com/Consensys/teku/files/12028832/message.txt)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1632612498/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
