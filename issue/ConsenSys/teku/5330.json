{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5330",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5330/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5330/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5330/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5330",
  "id": 1200903215,
  "node_id": "I_kwDOCM9I9M5HlFQv",
  "number": 5330,
  "title": "[Merge] Print Syncing message when attestations due",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-04-12T03:05:23Z",
  "updated_at": "2022-05-03T06:22:33Z",
  "closed_at": "2022-05-03T06:22:33Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\nCurrently Teku prints the \"Syncing\" message at the very start of the slot so when waiting for EL sync to complete it always reports the remaining slots as 1 because the block for the just started slot hasn't been received yet.  This suggests the beacon chain isn't completely in sync when it actually is.\n\nThe \"Slot Event\" message we print is delayed until attestations are due to give the block for the current slot a chance to be imported.  We should move the \"Syncing\" message to this same point so that it can report 0.\n\nKey acceptance criteria:\nThe \"Syncing\" messages report \"Remaining slots: 0\" when optimistic sync has completed and we are just waiting on the EL to finish syncing.\n\nEasiest way to test this is to change `ExecutionEngineService.doStart` to use `ExecutionEngineChannel.NOOP` instead of creating a real execution engine channel then run teku on kiln. To sync more quickly grab a checkpoint state from one of our kiln nodes.  The NOOP execution engine always returns syncing so Teku will stay in optimistic sync mode.",
  "closed_by": {
    "login": "tbenr",
    "id": 15999009,
    "node_id": "MDQ6VXNlcjE1OTk5MDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tbenr",
    "html_url": "https://github.com/tbenr",
    "followers_url": "https://api.github.com/users/tbenr/followers",
    "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
    "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
    "organizations_url": "https://api.github.com/users/tbenr/orgs",
    "repos_url": "https://api.github.com/users/tbenr/repos",
    "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tbenr/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5330/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5330/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1115587727",
    "html_url": "https://github.com/ConsenSys/teku/issues/5330#issuecomment-1115587727",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5330",
    "id": 1115587727,
    "node_id": "IC_kwDOCM9I9M5CfoSP",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-03T03:15:50Z",
    "updated_at": "2022-05-03T03:15:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Probably better to take a different approach to this - when the CL is only one slot behind and waiting for the EL, just report that in the message instead of our usual Syncing message.  Can still print at the start of the slot then which is much easier and it provides more info to the user.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1115587727/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
