{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5700",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5700",
  "id": 1260717199,
  "node_id": "I_kwDOCM9I9M5LJQSP",
  "number": 5700,
  "title": "500 on POST /eth/v1/validator/{pubkey}/feerecipient",
  "user": {
    "login": "ThomasDalla",
    "id": 609945,
    "node_id": "MDQ6VXNlcjYwOTk0NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/609945?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ThomasDalla",
    "html_url": "https://github.com/ThomasDalla",
    "followers_url": "https://api.github.com/users/ThomasDalla/followers",
    "following_url": "https://api.github.com/users/ThomasDalla/following{/other_user}",
    "gists_url": "https://api.github.com/users/ThomasDalla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ThomasDalla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ThomasDalla/subscriptions",
    "organizations_url": "https://api.github.com/users/ThomasDalla/orgs",
    "repos_url": "https://api.github.com/users/ThomasDalla/repos",
    "events_url": "https://api.github.com/users/ThomasDalla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ThomasDalla/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rolfyone",
    "id": 2967240,
    "node_id": "MDQ6VXNlcjI5NjcyNDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rolfyone",
    "html_url": "https://github.com/rolfyone",
    "followers_url": "https://api.github.com/users/rolfyone/followers",
    "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
    "organizations_url": "https://api.github.com/users/rolfyone/orgs",
    "repos_url": "https://api.github.com/users/rolfyone/repos",
    "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rolfyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-06-04T11:16:21Z",
  "updated_at": "2022-06-05T21:41:38Z",
  "closed_at": "2022-06-05T21:41:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nI have enabled the validator API and can list the keystores. I have both read-only (imported manually in the folder) and read-write keystores (imported via the API).\r\nWhen I try to set the recipient fee (`POST /eth/v1/validator/{pubkey}/feerecipient for a read-only validator` with `--data '{\"ethaddress\":\"0xMyEth1Address\"}'`, I receive a 500.\r\n\r\n### Steps to Reproduce (Bug)\r\n\r\n```\r\ncurl -X POST --insecure -H \"Authorization: Bearer XYZ\" -H \"Accept: application/json\" -H \"Content-Type: application/json\" --data '{\"ethaddress\":\"0xMyEth1Address\"}' https://127.0.0.1:5052/eth/v1/validator/{pubkey}/feerecipient\r\n```\r\n\r\nReponse:\r\n```json\r\n{\r\n    \"code\": 500,\r\n    \"message\": \"An unexpected error occurred\"\r\n}\r\n```\r\n\r\n**Expected behavior:** Either it works and returns a success, or it fails and returns a useful error message telling us why it failed.\r\n\r\n**Actual behavior:** Return an error 500 with a generic `\"An unexpected error occurred\"` message.\r\n\r\n**Frequency:** Every time I query it.\r\n\r\n### Logs\r\n\r\n```\r\n2022-06-04 12:17:42.797+01:00 | qtp353489239-34 | ERROR | RestApiBuilder | Failed to process request to URL https://alderlake.tail:5062/eth/v1/validator/{{PUBKEY-REDACTED}}/feerecipient\r\njava.util.NoSuchElementException: No value present\r\nat java.util.Optional.orElseThrow(Unknown Source) ~[?:?]\r\nat tech.pegasys.teku.validator.client.restapi.apis.SetFeeRecipient.handleRequest(SetFeeRecipient.java:82) ~[teku-validator-client-22.5.2.jar:22.5.2]\r\nat tech.pegasys.teku.infrastructure.restapi.endpoints.JavalinEndpointAdapter.handle(JavalinEndpointAdapter.java:36) ~[teku-infrastructure-restapi-22.5.2.jar:22.5.2]\r\nat tech.pegasys.teku.infrastructure.restapi.AuthorizationManager.manage(AuthorizationManager.java:89) ~[teku-infrastructure-restapi-22.5.2.jar:22.5.2]\r\nat io.javalin.http.JavalinServlet.addHandler$lambda-5(JavalinServlet.kt:115) ~[javalin-4.4.0.jar:4.4.0]\r\nat io.javalin.http.JavalinServlet$service$tryBeforeAndEndpointHandlers$1.invoke(JavalinServlet.kt:44) ~[javalin-4.4.0.jar:4.4.0]\r\nat io.javalin.http.JavalinServlet$service$tryBeforeAndEndpointHandlers$1.invoke(JavalinServlet.kt:39) ~[javalin-4.4.0.jar:4.4.0]\r\nat io.javalin.http.JavalinServlet.service$tryWithExceptionMapper(JavalinServlet.kt:131) ~[javalin-4.4.0.jar:4.4.0]\r\nat io.javalin.http.JavalinServlet.service$tryBeforeAndEndpointHandlers(JavalinServlet.kt:39) ~[javalin-4.4.0.jar:4.4.0]\r\nat io.javalin.http.JavalinServlet.service(JavalinServlet.kt:87) ~[javalin-4.4.0.jar:4.4.0]\r\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:790) ~[javax.servlet-api-3.1.0.jar:3.1.0]\r\nat io.javalin.jetty.JavalinJettyServlet.service(JavalinJettyServlet.kt:58) ~[javalin-4.4.0.jar:4.4.0]\r\nat javax.servlet.http.HttpServlet.service(HttpServlet.java:790) ~[javax.servlet-api-3.1.0.jar:3.1.0]\r\nat org.eclipse.jetty.servlet.ServletHolder.handle(ServletHolder.java:799) ~[jetty-servlet-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:550) ~[jetty-servlet-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat io.javalin.jetty.JettyServer$start$wsAndHttpHandler$1.doHandle(JettyServer.kt:52) ~[javalin-4.4.0.jar:4.4.0]\r\nat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501) ~[jetty-servlet-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.Server.handle(Server.java:516) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[jetty-server-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) ~[jetty-io-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034) ~[jetty-util-9.4.45.v20220203.jar:9.4.45.v20220203]\r\nat java.lang.Thread.run(Unknown Source) ~[?:?]\r\n```\r\n\r\n### Versions\r\n* Software version: `teku/v22.5.2/linux-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17`\r\n* Java version: `OpenJDK 64-Bit Server VM Temurin-17.0.3+7 (build 17.0.3+7, mixed mode)`\r\n* OS Name & Version: `Ubuntu 20.04.4 LTS`\r\n* Docker Version: `Community 20.10.16`\r\n* Cloud VM, type, size: `My own bare metal`",
  "closed_by": {
    "login": "rolfyone",
    "id": 2967240,
    "node_id": "MDQ6VXNlcjI5NjcyNDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rolfyone",
    "html_url": "https://github.com/rolfyone",
    "followers_url": "https://api.github.com/users/rolfyone/followers",
    "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
    "organizations_url": "https://api.github.com/users/rolfyone/orgs",
    "repos_url": "https://api.github.com/users/rolfyone/repos",
    "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rolfyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5700/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146744245",
    "html_url": "https://github.com/ConsenSys/teku/issues/5700#issuecomment-1146744245",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700",
    "id": 1146744245,
    "node_id": "IC_kwDOCM9I9M5EWe21",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-05T05:20:44Z",
    "updated_at": "2022-06-05T07:31:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for raising.\n\nWhat network are you on at the moment? Basically that's being thrown because the the network doesn't think it needs to do anything with Bellatrix...\n\nWhen I tested it, bellatrix was enabled so i didnt see the 500, but I'll add a better message for that...\n\nI had a quick look and I think that should only be only in the case where the Bellatrix milestone isn't enabled, but if you can share what network you were on it'll help me get a better understanding of why...\n\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146744245/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146761923",
    "html_url": "https://github.com/ConsenSys/teku/issues/5700#issuecomment-1146761923",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700",
    "id": 1146761923,
    "node_id": "IC_kwDOCM9I9M5EWjLD",
    "user": {
      "login": "ThomasDalla",
      "id": 609945,
      "node_id": "MDQ6VXNlcjYwOTk0NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/609945?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ThomasDalla",
      "html_url": "https://github.com/ThomasDalla",
      "followers_url": "https://api.github.com/users/ThomasDalla/followers",
      "following_url": "https://api.github.com/users/ThomasDalla/following{/other_user}",
      "gists_url": "https://api.github.com/users/ThomasDalla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ThomasDalla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ThomasDalla/subscriptions",
      "organizations_url": "https://api.github.com/users/ThomasDalla/orgs",
      "repos_url": "https://api.github.com/users/ThomasDalla/repos",
      "events_url": "https://api.github.com/users/ThomasDalla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ThomasDalla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-05T08:12:03Z",
    "updated_at": "2022-06-05T08:12:03Z",
    "author_association": "NONE",
    "body": "That's right, I was testing these commands on Prater/Goerli where Bellatrix isn't enabled.\r\nAn error message telling us so would be great, thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146761923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146775982",
    "html_url": "https://github.com/ConsenSys/teku/issues/5700#issuecomment-1146775982",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5700",
    "id": 1146775982,
    "node_id": "IC_kwDOCM9I9M5EWmmu",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-05T09:58:35Z",
    "updated_at": "2022-06-05T09:58:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok that's great, just making sure there wasn't another scenario - thanks for clarifying.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1146775982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
