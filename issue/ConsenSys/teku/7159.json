{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/7159",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/7159/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/7159/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/7159/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/7159",
  "id": 1716936708,
  "node_id": "I_kwDOCM9I9M5mVmAE",
  "number": 7159,
  "title": "Forever Syncing with remaining slot 1",
  "user": {
    "login": "tbenr",
    "id": 15999009,
    "node_id": "MDQ6VXNlcjE1OTk5MDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tbenr",
    "html_url": "https://github.com/tbenr",
    "followers_url": "https://api.github.com/users/tbenr/followers",
    "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
    "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
    "organizations_url": "https://api.github.com/users/tbenr/orgs",
    "repos_url": "https://api.github.com/users/tbenr/repos",
    "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tbenr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-05-19T09:30:05Z",
  "updated_at": "2023-05-19T10:41:45Z",
  "closed_at": "2023-05-19T10:41:45Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Even if we are effectively in sync, EL is working and importing blocks and responding to fcu correctly we print:\r\n\r\n```\r\n2023-05-06 15:46:47.108 INFO  - Syncing     *** Target slot: 6380332, Head slot: 6380331, Remaining slots: 1, Connected peers: 127\r\n2023-05-06 15:46:59.110 INFO  - Syncing     *** Target slot: 6380333, Head slot: 6380332, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:47:11.100 INFO  - Syncing     *** Target slot: 6380334, Head slot: 6380333, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:47:23.114 INFO  - Syncing     *** Target slot: 6380335, Head slot: 6380334, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:47:35.115 INFO  - Syncing     *** Target slot: 6380336, Head slot: 6380335, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:47:47.097 INFO  - Syncing     *** Target slot: 6380337, Head slot: 6380336, Remaining slots: 1, Connected peers: 127\r\n2023-05-06 15:47:59.107 INFO  - Syncing     *** Target slot: 6380338, Head slot: 6380337, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:48:11.113 INFO  - Syncing     *** Target slot: 6380339, Head slot: 6380338, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:48:23.105 INFO  - Syncing     *** Target slot: 6380340, Head slot: 6380339, Remaining slots: 1, Connected peers: 128\r\n2023-05-06 15:48:35.108 INFO  - Syncing     *** Target slot: 6380341, Head slot: 6380340, Remaining slots: 1, Connected peers: 128\r\n```\r\n\r\nI manually recreated the situation by setting `executionLayerIsAvailable = false` in the `SyncStateTracker`  which leads to same logs printed out.\r\nSo most probably due to several concurrent calls to EL with mixed succesful\\error results, we end up remaining with that flag set  to false.\r\n\r\n\r\nfor reference, look at the weird unordered logs timestamps that leads to this:\r\n```\r\n2023-05-06 15:44:27.114 INFO  - Execution Client is responding to requests again after a previous failure\r\n2023-05-06 15:44:27.112 ERROR - Failed to process request to URL XXXXXXXX\r\njava.lang.IllegalStateException: payloadId still not suitable after requesting a new one via FcU with recalculated data\r\nat tech.pegasys.teku.statetransition.forkchoice.ForkChoiceNotifierImpl.lambda$internalGetPayloadId$6(ForkChoiceNotifierImpl.java:185) ~[teku-ethereum-statetransition-23.3.1.jar:23.3.1]\r\n...\r\n2023-05-06 15:44:27.116 ERROR - Failed to update fork choice\r\njava.util.concurrent.CompletionException: tech.pegasys.teku.ethereum.executionclient.response.InvalidRemoteResponseException: Invalid remote response from the execution client: -38003: Invalid payload attributes\r\n...\r\n2023-05-06 15:44:27.108 ERROR - Execution Client request failed. Make sure the Execution Client is online and can respond to requests.\r\njava.io.IOException: -38003: Invalid payload attributes\r\nat tech.pegasys.teku.ethereum.executionclient.web3j.Web3JClient.lambda$doRequest$0(Web3JClient.java:85) ~[teku-ethereum-executionclient-23.3.1.jar:23.3.1]\r\n...\r\n2023-05-06 15:44:27.118 ERROR - Failed to update fork choice\r\njava.util.concurrent.CompletionException: tech.pegasys.teku.ethereum.executionclient.response.InvalidRemoteResponseException: Invalid remote response from the execution client: -38003: Invalid payload attributes\r\n...\r\n2023-05-06 15:44:35.109 INFO  - Syncing     *** Target slot: 6380321, Head slot: 6380320, Remaining slots: 1, Connected peers: 128\r\n```",
  "closed_by": {
    "login": "tbenr",
    "id": 15999009,
    "node_id": "MDQ6VXNlcjE1OTk5MDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tbenr",
    "html_url": "https://github.com/tbenr",
    "followers_url": "https://api.github.com/users/tbenr/followers",
    "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
    "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
    "organizations_url": "https://api.github.com/users/tbenr/orgs",
    "repos_url": "https://api.github.com/users/tbenr/repos",
    "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tbenr/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/7159/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/7159/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
