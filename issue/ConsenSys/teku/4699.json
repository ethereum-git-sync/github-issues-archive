{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/4699",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/4699/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/4699/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/4699/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/4699",
  "id": 1062278879,
  "node_id": "I_kwDOCM9I9M4_URbf",
  "number": 4699,
  "title": "Failed to open database when downgrading beacon from 21.11.1 to 21.10.0",
  "user": {
    "login": "jmcruz1983",
    "id": 15966694,
    "node_id": "MDQ6VXNlcjE1OTY2Njk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/15966694?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jmcruz1983",
    "html_url": "https://github.com/jmcruz1983",
    "followers_url": "https://api.github.com/users/jmcruz1983/followers",
    "following_url": "https://api.github.com/users/jmcruz1983/following{/other_user}",
    "gists_url": "https://api.github.com/users/jmcruz1983/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jmcruz1983/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jmcruz1983/subscriptions",
    "organizations_url": "https://api.github.com/users/jmcruz1983/orgs",
    "repos_url": "https://api.github.com/users/jmcruz1983/repos",
    "events_url": "https://api.github.com/users/jmcruz1983/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jmcruz1983/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-11-24T10:55:53Z",
  "updated_at": "2021-11-30T10:10:19Z",
  "closed_at": "2021-11-30T10:10:19Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "```\r\n2021-11-24 10:53:15,150 main INFO Configuring logging for destination: console\r\n2021-11-24 10:53:15,153 main INFO Logging includes events: true\r\n2021-11-24 10:53:15,153 main INFO Logging includes validator duties: true\r\n2021-11-24 10:53:15,154 main INFO Logging includes color: true\r\n2021-11-24 10:53:15,162 main INFO Include P2P warnings set to: false\r\n10:53:15.164 INFO  - Teku version: teku/v21.10.0/linux-x86_64/-eclipsefoundation-openjdk64bitservervm-java-16\r\n10:53:15.168 INFO  - This software is licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this software except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n10:53:15.478 INFO  - Loading 0 validator keys...\r\n10:53:15.482 INFO  - Loaded 0 Validators: \r\n10:53:15.510 INFO  - Using default implementation for ThreadExecutor\r\n10:53:15.512 INFO  - Job execution threads will use class loader of thread: main\r\n10:53:15.538 INFO  - Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\n10:53:15.538 INFO  - Quartz Scheduler v.2.3.2 created.\r\n10:53:15.539 INFO  - RAMJobStore initialized.\r\n10:53:15.540 INFO  - Scheduler meta-data: Quartz Scheduler (v2.3.2) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'\r\n  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.\r\n  NOT STARTED.\r\n  Currently in standby mode.\r\n  Number of jobs executed: 0\r\n  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.\r\n  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.\r\n10:53:15.540 INFO  - Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'\r\n10:53:15.540 INFO  - Quartz scheduler version: 2.3.2\r\n10:53:15.586 INFO  - Storing beacon chain data in: /data/beacon\r\n10:53:15.594 INFO  - Starting metrics http service on 0.0.0.0:8008\r\n10:53:15.737 INFO  - Metrics service started and listening on 8008:8008\r\n10:53:15.739 INFO  - Beacon data directory set to: /data/beacon\r\n10:53:15.825 FATAL - Failed to open database\r\ntech.pegasys.teku.storage.server.DatabaseStorageException: Failed to open database\r\n    at tech.pegasys.teku.storage.server.DatabaseStorageException.unrecoverable(DatabaseStorageException.java:31) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.storage.server.leveldb.LevelDbInstanceFactory.create(LevelDbInstanceFactory.java:47) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.storage.server.leveldb.LevelDbDatabaseFactory.createLevelDbV2(LevelDbDatabaseFactory.java:76) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.storage.server.VersionedDatabaseFactory.createLevelDbV2Database(VersionedDatabaseFactory.java:266) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.storage.server.VersionedDatabaseFactory.createDatabase(VersionedDatabaseFactory.java:159) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.services.chainstorage.StorageService.lambda$doStart$0(StorageService.java:61) ~[teku-services-chainstorage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.infrastructure.async.SafeFuture.fromRunnable(SafeFuture.java:154) ~[teku-infrastructure-async-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.services.chainstorage.StorageService.doStart(StorageService.java:48) ~[teku-services-chainstorage-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.service.serviceutils.Service.start(Service.java:35) ~[teku-services-serviceutils-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.services.ServiceController.doStart(ServiceController.java:29) ~[teku-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.service.serviceutils.Service.start(Service.java:35) ~[teku-services-serviceutils-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.AbstractNode.start(AbstractNode.java:96) ~[teku-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.Teku.start(Teku.java:50) ~[teku-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.cli.BeaconNodeCommand.call(BeaconNodeCommand.java:284) [teku-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.cli.BeaconNodeCommand.call(BeaconNodeCommand.java:72) [teku-21.10.0.jar:21.10.0[]\r\n    at picocli.CommandLine.executeUserObject(CommandLine.java:1933) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine.access$1100(CommandLine.java:145) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2332) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine$RunLast.handle(CommandLine.java:2326) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine$RunLast.handle(CommandLine.java:2291) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2159) [picocli-4.4.0.jar:4.4.0[]\r\n    at picocli.CommandLine.execute(CommandLine.java:2058) [picocli-4.4.0.jar:4.4.0[]\r\n    at tech.pegasys.teku.cli.BeaconNodeCommand.parse(BeaconNodeCommand.java:233) [teku-21.10.0.jar:21.10.0[]\r\n    at tech.pegasys.teku.Teku.main(Teku.java:32) [teku-21.10.0.jar:21.10.0[]\r\nCaused by: org.fusesource.leveldbjni.internal.NativeDB$DBException: Corruption: 21 missing files; e.g.: /data/beacon/db/1948020.sst\r\n    at org.fusesource.leveldbjni.internal.NativeDB.checkStatus(NativeDB.java:200) ~[leveldbjni-all-1.8.jar:1.8[]\r\n    at org.fusesource.leveldbjni.internal.NativeDB.open(NativeDB.java:218) ~[leveldbjni-all-1.8.jar:1.8[]\r\n    at org.fusesource.leveldbjni.JniDBFactory.open(JniDBFactory.java:168) ~[leveldbjni-all-1.8.jar:1.8[]\r\n    at tech.pegasys.teku.storage.server.leveldb.LevelDbInstanceFactory.create(LevelDbInstanceFactory.java:44) ~[teku-storage-21.10.0.jar:21.10.0[]\r\n    ... 22 more\r\nFailed to open database\r\nTo display full help:\r\nteku [COMMAND[] --help\r\n```",
  "closed_by": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/4699/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/4699/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/982484390",
    "html_url": "https://github.com/ConsenSys/teku/issues/4699#issuecomment-982484390",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4699",
    "id": 982484390,
    "node_id": "IC_kwDOCM9I9M46j4Wm",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-30T10:10:19Z",
    "updated_at": "2021-11-30T10:10:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Apologies - this is due to an upgrade of LevelDB that is not backward compatible. We were aware of this but failed to announce it in the release notes. We'll take care to note any future incompatibilities in the release notes.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/982484390/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
