{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5226",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5226",
  "id": 1178025567,
  "node_id": "I_kwDOCM9I9M5GNz5f",
  "number": 5226,
  "title": "Issue configuring TLS communication with Web3signer",
  "user": {
    "login": "Roavill2",
    "id": 32643274,
    "node_id": "MDQ6VXNlcjMyNjQzMjc0",
    "avatar_url": "https://avatars.githubusercontent.com/u/32643274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Roavill2",
    "html_url": "https://github.com/Roavill2",
    "followers_url": "https://api.github.com/users/Roavill2/followers",
    "following_url": "https://api.github.com/users/Roavill2/following{/other_user}",
    "gists_url": "https://api.github.com/users/Roavill2/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Roavill2/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Roavill2/subscriptions",
    "organizations_url": "https://api.github.com/users/Roavill2/orgs",
    "repos_url": "https://api.github.com/users/Roavill2/repos",
    "events_url": "https://api.github.com/users/Roavill2/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Roavill2/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-03-23T12:03:14Z",
  "updated_at": "2022-03-23T13:45:04Z",
  "closed_at": "2022-03-23T13:45:04Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\nFollowing the tutorial for how to configure an external signer (https://docs.teku.consensys.net/en/latest/Tutorials/Configure-External-Signer-TLS/). When trying to start Teku, it falls over with an error stating `Port 9000 (TCP) is already in use.`\r\n\r\nThere is one minute difference in that my command to start Teku doesn't include `--validators-external-signer-public-keys` which could potentially be causing the issue, but I see you closed #5130 so I'm not too sure.\r\n\r\nBit new to ETH staking so apologies if there are any oversights.\r\n\r\n### Steps to Reproduce (Bug)\r\nI've followed the above tutorial step-by-step. For testing purposes I'm trying to connect to mainnet so if that is causing the issue, relatively easy to fix. \r\n\r\nThe command to start web3signer:\r\n\r\n```\r\n./web3signer \\\r\n--tls-keystore-file=/path/to/certs/web3signer_keystore.p12 \\\r\n--tls-keystore-password-file=/path/to/certs/web3signer_keystore_password.txt \\\r\n--tls-known-clients-file=/path/to/certs/knownClients.txt \\\r\neth2 --slashing-protection-enabled=false\r\n```\r\n\r\nThe command to start Teku:\r\n\r\n```\r\n./teku --network=mainnet \\\r\n--eth1-endpoint=https://mainnet.infura.io/v3/4680b6de8566466398040c5768a41436 \\\r\n--validators-external-signer-url=https://localhost:9000 \\\r\n--validators-external-signer-truststore=/path/to/certs/web3signer_truststore.p12 \\\r\n--validators-external-signer-truststore-password-file=/path/to/certs/truststore_pass.txt \\\r\n--validators-external-signer-keystore=/path/to/certs/teku_client_keystore.p12 \\\r\n--validators-external-signer-keystore-password-file=/path/to/certs/teku_keystore_password.txt\r\n```\r\n\r\n**Expected behavior:**\r\nI would expect Teku to start and connect to the web3signer.\r\n\r\n**Actual behavior:**\r\nWeb3Signer is able to be brought up no issues, however, when trying to run the command to start Teku, this error is returned:\r\n\r\n`P2P Port 9000 (TCP) is already in use. Check for other processes using this port.`\r\n\r\n### Versions (Add all that apply)\r\n* Software version: `teku/v22.3.2+7-g3c443aa/linux-x86_64/-ubuntu-openjdk64bitservervm-java-11`\r\n* Java version: `openjdk version \"11.0.14\" 2022-01-18`\r\n* OS Name & Version: `Ubuntu:20.04.3 LTS (Focal Fossa)`\r\n* Docker Version: `20.10.10`",
  "closed_by": {
    "login": "Roavill2",
    "id": 32643274,
    "node_id": "MDQ6VXNlcjMyNjQzMjc0",
    "avatar_url": "https://avatars.githubusercontent.com/u/32643274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Roavill2",
    "html_url": "https://github.com/Roavill2",
    "followers_url": "https://api.github.com/users/Roavill2/followers",
    "following_url": "https://api.github.com/users/Roavill2/following{/other_user}",
    "gists_url": "https://api.github.com/users/Roavill2/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Roavill2/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Roavill2/subscriptions",
    "organizations_url": "https://api.github.com/users/Roavill2/orgs",
    "repos_url": "https://api.github.com/users/Roavill2/repos",
    "events_url": "https://api.github.com/users/Roavill2/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Roavill2/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5226/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1076321499",
    "html_url": "https://github.com/ConsenSys/teku/issues/5226#issuecomment-1076321499",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226",
    "id": 1076321499,
    "node_id": "IC_kwDOCM9I9M5AJ1zb",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-23T12:30:24Z",
    "updated_at": "2022-03-23T12:30:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah, there's a gotcha here. Both Teku and Web3Signer default to using port 9000 for networking. As per the error message Web3Signer is already running and using the port, so Teku cannot start.\r\n\r\nThe fix is to run one or the other with a different port assignment. I suggest you add `--p2p-port=9001` to the Teku configuration.\r\n\r\nNormally Teku and Web3Signer are not run on the same machine - the intention is for W3S to be run elsewhere in a much more heavily firewalled part of the network - so this isn't usually a problem.\r\n\r\nLet us know if this fixes things or not.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1076321499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1076393230",
    "html_url": "https://github.com/ConsenSys/teku/issues/5226#issuecomment-1076393230",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5226",
    "id": 1076393230,
    "node_id": "IC_kwDOCM9I9M5AKHUO",
    "user": {
      "login": "Roavill2",
      "id": 32643274,
      "node_id": "MDQ6VXNlcjMyNjQzMjc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/32643274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Roavill2",
      "html_url": "https://github.com/Roavill2",
      "followers_url": "https://api.github.com/users/Roavill2/followers",
      "following_url": "https://api.github.com/users/Roavill2/following{/other_user}",
      "gists_url": "https://api.github.com/users/Roavill2/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Roavill2/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Roavill2/subscriptions",
      "organizations_url": "https://api.github.com/users/Roavill2/orgs",
      "repos_url": "https://api.github.com/users/Roavill2/repos",
      "events_url": "https://api.github.com/users/Roavill2/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Roavill2/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-23T13:44:58Z",
    "updated_at": "2022-03-23T13:44:58Z",
    "author_association": "NONE",
    "body": "Thanks very much for the explanation! Makes sense to have them running on separate systems.\r\n\r\nJust tried out your suggestion and it has fixed my issue!\r\n\r\nAppreciate the speediness of your response. Much appreciated.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1076393230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
