{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/4111",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/4111",
  "id": 928910121,
  "node_id": "MDU6SXNzdWU5Mjg5MTAxMjE=",
  "number": 4111,
  "title": "Public key aggregation ambiguous infinite points handling",
  "user": {
    "login": "veorq",
    "id": 3204810,
    "node_id": "MDQ6VXNlcjMyMDQ4MTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3204810?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/veorq",
    "html_url": "https://github.com/veorq",
    "followers_url": "https://api.github.com/users/veorq/followers",
    "following_url": "https://api.github.com/users/veorq/following{/other_user}",
    "gists_url": "https://api.github.com/users/veorq/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/veorq/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/veorq/subscriptions",
    "organizations_url": "https://api.github.com/users/veorq/orgs",
    "repos_url": "https://api.github.com/users/veorq/repos",
    "events_url": "https://api.github.com/users/veorq/events{/privacy}",
    "received_events_url": "https://api.github.com/users/veorq/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-06-24T06:57:21Z",
  "updated_at": "2021-09-21T13:33:38Z",
  "closed_at": "2021-09-21T13:33:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n`BlstPublicKey.aggregate()` will return `infinitePublicKey` in two cases:\r\n\r\n1. If one of the public keys to aggregate is invalid (not in the subgroup or infinity point)\r\n2. If the sum of (valid) public keys happens to be zero\r\n\r\nhttps://github.com/ConsenSys/teku/blob/a0270026d4e70db13b0042eb057ffbdb5709e4ca/bls/src/main/java/tech/pegasys/teku/bls/impl/blst/BlstPublicKey.java#L56-L74\r\n\r\nThe two cases should be distinguished, so that the caller can handle them differently.",
  "closed_by": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/4111/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/867434843",
    "html_url": "https://github.com/ConsenSys/teku/issues/4111#issuecomment-867434843",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111",
    "id": 867434843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NzQzNDg0Mw==",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-24T08:11:31Z",
    "updated_at": "2021-06-24T08:11:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you for raising this.\r\n\r\nWhile the distinction between the two cases is true, for all practical purposes (in Teku, at least) it makes no difference. In the astronomically unlikely event that an aggregate public key results in the point at infinity, it would be invalid for signature verification. This is because the standard's [`CoreVerify`](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-04#section-2.7) function ([arguably](https://github.com/supranational/blst/issues/11)) requires the secret key [not to be zero](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-04#section-2.4). This is maybe an issue with the standard, but that's how it is.\r\n\r\nIn other applications, getting an infinite public key from aggregation likely suggests a rogue public key attack or similar, and granted that it might be useful to know about this.\r\n\r\nI'll leave this open for a while for discussion, but we probably won't be making changes here unless/until we are doing some further work. However, if this is a blocker to another project, we can modify to return an optional, or throw an exception if invalid individual keys are present. Lmk.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/867434843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/867443606",
    "html_url": "https://github.com/ConsenSys/teku/issues/4111#issuecomment-867443606",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4111",
    "id": 867443606,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NzQ0MzYwNg==",
    "user": {
      "login": "veorq",
      "id": 3204810,
      "node_id": "MDQ6VXNlcjMyMDQ4MTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3204810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/veorq",
      "html_url": "https://github.com/veorq",
      "followers_url": "https://api.github.com/users/veorq/followers",
      "following_url": "https://api.github.com/users/veorq/following{/other_user}",
      "gists_url": "https://api.github.com/users/veorq/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/veorq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/veorq/subscriptions",
      "organizations_url": "https://api.github.com/users/veorq/orgs",
      "repos_url": "https://api.github.com/users/veorq/repos",
      "events_url": "https://api.github.com/users/veorq/events{/privacy}",
      "received_events_url": "https://api.github.com/users/veorq/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-24T08:24:56Z",
    "updated_at": "2021-06-24T08:24:56Z",
    "author_association": "NONE",
    "body": "Thanks @benjaminion for the quick and clear response. I agree with your evaluation of the risk. \r\n\r\nI was less worried about the zero sum than about a single invalid key not being detected, as you suggest what about throwing an exception, as `BlstSignature.aggregate()` is doing in \r\n\r\nhttps://github.com/ConsenSys/teku/blob/a0270026d4e70db13b0042eb057ffbdb5709e4ca/bls/src/main/java/tech/pegasys/teku/bls/impl/blst/BlstSignature.java#L71-L78\r\n\r\n?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/867443606/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
