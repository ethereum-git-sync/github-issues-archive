{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/1720",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/1720",
  "id": 612451605,
  "node_id": "MDU6SXNzdWU2MTI0NTE2MDU=",
  "number": 1720,
  "title": "Null pointer exception when starting Teku without some options",
  "user": {
    "login": "NicolasMassart",
    "id": 4677568,
    "node_id": "MDQ6VXNlcjQ2Nzc1Njg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4677568?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NicolasMassart",
    "html_url": "https://github.com/NicolasMassart",
    "followers_url": "https://api.github.com/users/NicolasMassart/followers",
    "following_url": "https://api.github.com/users/NicolasMassart/following{/other_user}",
    "gists_url": "https://api.github.com/users/NicolasMassart/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NicolasMassart/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NicolasMassart/subscriptions",
    "organizations_url": "https://api.github.com/users/NicolasMassart/orgs",
    "repos_url": "https://api.github.com/users/NicolasMassart/repos",
    "events_url": "https://api.github.com/users/NicolasMassart/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NicolasMassart/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1048919129,
      "node_id": "MDU6TGFiZWwxMDQ4OTE5MTI5",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/bug%20%F0%9F%90%9E",
      "name": "bug üêû",
      "color": "dd6c94",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1168112221,
      "node_id": "MDU6TGFiZWwxMTY4MTEyMjIx",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/blocks%20another%20PR/issue%20%F0%9F%9B%A1",
      "name": "blocks another PR/issue üõ°",
      "color": "4bcc74",
      "default": false,
      "description": "This issue or pull request blocks another"
    },
    {
      "id": 1846512527,
      "node_id": "MDU6TGFiZWwxODQ2NTEyNTI3",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/TeamZiz",
      "name": "TeamZiz",
      "color": "fcf879",
      "default": false,
      "description": "Under active development by TeamZiz @PegaSys"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "arash009",
    "id": 33149995,
    "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arash009",
    "html_url": "https://github.com/arash009",
    "followers_url": "https://api.github.com/users/arash009/followers",
    "following_url": "https://api.github.com/users/arash009/following{/other_user}",
    "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
    "organizations_url": "https://api.github.com/users/arash009/orgs",
    "repos_url": "https://api.github.com/users/arash009/repos",
    "events_url": "https://api.github.com/users/arash009/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arash009/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "arash009",
      "id": 33149995,
      "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arash009",
      "html_url": "https://github.com/arash009",
      "followers_url": "https://api.github.com/users/arash009/followers",
      "following_url": "https://api.github.com/users/arash009/following{/other_user}",
      "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
      "organizations_url": "https://api.github.com/users/arash009/orgs",
      "repos_url": "https://api.github.com/users/arash009/repos",
      "events_url": "https://api.github.com/users/arash009/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arash009/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-05-05T09:05:25Z",
  "updated_at": "2020-06-24T22:55:45Z",
  "closed_at": "2020-06-24T22:55:44Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/PegasysEng/teku/blob/master/CODE-OF-CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging wiki: https://github.com/PegasysEng/teku/wiki/debugging -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3APegasysEng/Teku -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\nAs a user, I want Teku to start without NPE even if I don't provide any options. Seeing a NPE and being told that it's a misuse of the software is not acceptable for an enterprise grade product.\r\n\r\n### Acceptance Criteria\r\n* Run Teku binaries and Docker image without options and have no error.\r\n* Have a smoke test in CI to make sure Teku works when ran with minimal (no) options.\r\n* Find a way to spot these kind of NPE in the future as manual review is not enough (a code checker rule, SonarCube ?) or at least track this need in an issue. Link the issue in this one.\r\n\r\n### Steps to Reproduce (Bug)\r\n\r\nWith binaries built from source:\r\n\r\n1. run Gradle installDist task `./gradlew clean installDist`\r\n1. run the binary without options `build/install/teku/bin/teku`\r\n\r\nor with the develop docker image:\r\n\r\n1. `docker pull pegasyseng/teku:develop`\r\n1. `docker run pegasyseng/teku:develop`\r\n\r\n**Expected behavior:** [What you expect to happen]\r\n\r\n1. no error should be thrown\r\n1. Teku should be up and running with a viable default setup, perhaps matching the most obvious use case.\r\n\r\n**Actual behavior:** [What actually happens]\r\n\r\nA null pointer exception is thrown and Teku crashes.\r\n\r\n**Frequency:** [What percentage of the time does it occur?]\r\n\r\n100%\r\n\r\n### Versions (Add all that apply)\r\n* Software version: master commit 22e214d1043edcd3990e44ea02814e28e8f0b691\r\n* Java version: 12.0.2 but also happens on the Teku develop Docker image which is openjdk:11.0.2-jre-slim-stretch\r\n* OS Name & Version: Circle CI linux, Docker image, macOS, so probably on all OSes\r\n\r\n### Additional Information\r\n\r\nStacktrace:\r\n\r\n```\r\n% build/install/teku/bin/teku\r\nTeku failed to start.\r\njava.lang.NullPointerException\r\n\tat tech.pegasys.artemis.services.powchain.PowchainService.<init>(PowchainService.java:54)\r\n\tat tech.pegasys.artemis.services.ServiceController.<init>(ServiceController.java:37)\r\n\tat tech.pegasys.artemis.BeaconNode.<init>(BeaconNode.java:77)\r\n\tat tech.pegasys.artemis.Artemis.start(Artemis.java:38)\r\n\tat tech.pegasys.artemis.cli.BeaconNodeCommand.call(BeaconNodeCommand.java:241)\r\n\tat tech.pegasys.artemis.cli.BeaconNodeCommand.call(BeaconNodeCommand.java:61)\r\n\tat picocli.CommandLine.executeUserObject(CommandLine.java:1783)\r\n\tat picocli.CommandLine.access$900(CommandLine.java:145)\r\n\tat picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2150)\r\n\tat picocli.CommandLine$RunLast.handle(CommandLine.java:2144)\r\n\tat picocli.CommandLine$RunLast.handle(CommandLine.java:2108)\r\n\tat picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:1975)\r\n\tat picocli.CommandLine.execute(CommandLine.java:1904)\r\n\tat tech.pegasys.artemis.cli.BeaconNodeCommand.parse(BeaconNodeCommand.java:194)\r\n\tat tech.pegasys.artemis.Artemis.main(Artemis.java:31)\r\n```",
  "closed_by": {
    "login": "arash009",
    "id": 33149995,
    "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arash009",
    "html_url": "https://github.com/arash009",
    "followers_url": "https://api.github.com/users/arash009/followers",
    "following_url": "https://api.github.com/users/arash009/following{/other_user}",
    "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
    "organizations_url": "https://api.github.com/users/arash009/orgs",
    "repos_url": "https://api.github.com/users/arash009/repos",
    "events_url": "https://api.github.com/users/arash009/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arash009/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/1720/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635242900",
    "html_url": "https://github.com/ConsenSys/teku/issues/1720#issuecomment-635242900",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720",
    "id": 635242900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTI0MjkwMA==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-28T09:57:55Z",
    "updated_at": "2020-05-28T09:57:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "see #1717 - it is the same exception just further along",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635242900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635705453",
    "html_url": "https://github.com/ConsenSys/teku/issues/1720#issuecomment-635705453",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720",
    "id": 635705453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTcwNTQ1Mw==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-29T01:33:39Z",
    "updated_at": "2020-05-29T01:33:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "ok so latest master behaves quite nicely with no args\n‚ûú  node_0 git:(master) ./bin/teku\n2020-05-29 11:24:00,872 main INFO Configuring logging for destination: console and file\n2020-05-29 11:24:00,877 main INFO Logging file location: /Users/sallymacfarlane/Library/teku/logs/teku.log\n2020-05-29 11:24:00,877 main INFO Logging includes events: true\n2020-05-29 11:24:00,877 main INFO Logging includes color: true\n11:24:01.217 INFO  - Using data path: /Users/sallymacfarlane/Library/teku/data\n11:24:01.233 INFO  - Initializing storage\n11:24:11.248 INFO  - Storage initialization complete\nETH1 is disabled but initial state is unknown. Enable ETH1 or specify an initial state.\nTo display full help:\nteku [COMMAND] --help",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635705453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635720162",
    "html_url": "https://github.com/ConsenSys/teku/issues/1720#issuecomment-635720162",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720",
    "id": 635720162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTcyMDE2Mg==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-29T02:28:15Z",
    "updated_at": "2020-05-29T02:28:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm handing this one back to @arash009 for the bigger picture issue",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/635720162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/649115438",
    "html_url": "https://github.com/ConsenSys/teku/issues/1720#issuecomment-649115438",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1720",
    "id": 649115438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0OTExNTQzOA==",
    "user": {
      "login": "arash009",
      "id": 33149995,
      "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arash009",
      "html_url": "https://github.com/arash009",
      "followers_url": "https://api.github.com/users/arash009/followers",
      "following_url": "https://api.github.com/users/arash009/following{/other_user}",
      "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
      "organizations_url": "https://api.github.com/users/arash009/orgs",
      "repos_url": "https://api.github.com/users/arash009/repos",
      "events_url": "https://api.github.com/users/arash009/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arash009/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-24T22:55:44Z",
    "updated_at": "2020-06-24T22:55:44Z",
    "author_association": "NONE",
    "body": "Closing this for now as starting with no options gives a meaningful error and no longer an NPE.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/649115438/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
