{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/838",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/838/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/838/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/838/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/838",
  "id": 487232530,
  "node_id": "MDU6SXNzdWU0ODcyMzI1MzA=",
  "number": 838,
  "title": "BLS performance testing",
  "user": {
    "login": "shahankhatch",
    "id": 14043935,
    "node_id": "MDQ6VXNlcjE0MDQzOTM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/14043935?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shahankhatch",
    "html_url": "https://github.com/shahankhatch",
    "followers_url": "https://api.github.com/users/shahankhatch/followers",
    "following_url": "https://api.github.com/users/shahankhatch/following{/other_user}",
    "gists_url": "https://api.github.com/users/shahankhatch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shahankhatch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shahankhatch/subscriptions",
    "organizations_url": "https://api.github.com/users/shahankhatch/orgs",
    "repos_url": "https://api.github.com/users/shahankhatch/repos",
    "events_url": "https://api.github.com/users/shahankhatch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shahankhatch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-08-30T00:38:53Z",
  "updated_at": "2020-02-28T00:23:37Z",
  "closed_at": "2020-02-28T00:23:37Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "This issue is to track any performance optimizations needed for BLS. \r\n\r\nA unit test that does a rough performance measurement of BLS public keys and signatures has been developed. ",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/838/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/838/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/527947184",
    "html_url": "https://github.com/ConsenSys/teku/issues/838#issuecomment-527947184",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/838",
    "id": 527947184,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzk0NzE4NA==",
    "user": {
      "login": "shahankhatch",
      "id": 14043935,
      "node_id": "MDQ6VXNlcjE0MDQzOTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14043935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shahankhatch",
      "html_url": "https://github.com/shahankhatch",
      "followers_url": "https://api.github.com/users/shahankhatch/followers",
      "following_url": "https://api.github.com/users/shahankhatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/shahankhatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shahankhatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shahankhatch/subscriptions",
      "organizations_url": "https://api.github.com/users/shahankhatch/orgs",
      "repos_url": "https://api.github.com/users/shahankhatch/repos",
      "events_url": "https://api.github.com/users/shahankhatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shahankhatch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-04T15:13:55Z",
    "updated_at": "2019-09-04T15:14:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Notes from Danny:\r\n...The recent interop survey asked about \"benchmark of verify-aggregate bench speed of 128 participants, same message being signed. Called from client\".\r\n\r\nMost performant reported is 9ms on an i5 laptop. Some others in the 20-40ms range. To be a performant client, you'll want to get in this sub 10ms range for this benchmark.\r\n\r\nIn terms of what is needed in mainnet...\r\nWe need to be able to process blocks in sub-slot times. Healthy network, expecting 10M eth validating (300k validators). In the most extreme case, all eth in existence is validating ~130M eth (4M validators). At such numbers, there are SHARD_COUNT (1024) committees per epoch, so 16 committees per slot.\r\n\r\nAt 300k validators, that's ~4500 validators split across 16 committees. In the optimal, these can be aggregated into 16 attestations of ~300 validators per slot. In the non-optimal, assume some latency and issues in coming to consensus with each other or aggregation issues, we might see some multiple of 16 attestations but fewer validators per attestation, so maybe 32 (~150 validators per) or 64 attestations (~75 validators per) in a block. These map to number of signatures and number of participants in each signature that we'll need to verify in a block\r\n\r\nSo you certainly want to be able to verify that signature load in sub 1s if not faster. Note that each of these attestations is essentially a single bls_verify, but in phase 1, they will be a bls_verify_multiple as each attestation will be composed of two types of signatures (ones with 0 and ones with 1 custody bit) so each attestation's participants on average gets split in half between two signatures rather than the single.\r\n\r\ndjrtwo\r\nThe ultimate target is to be able to perform these same number of signatures  in sub second time but for 4M instead of 300k validators. This looks like 16 signatures with 4000 participants each. To get anywhere near this goal, I expect you'll need to look into  this verification trick that can verify multiple BLS signatures with just one pairing check -- https://ethresear.ch/t/fast-verification-of-multiple-bls-signatures/5407\r\n\r\nFor our initial interop exercises, the fastest we'll probably need is to be able to verify ~8 signatures of 16 participants in sub 1s time, and likely much less",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/527947184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/528828363",
    "html_url": "https://github.com/ConsenSys/teku/issues/838#issuecomment-528828363",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/838",
    "id": 528828363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODgyODM2Mw==",
    "user": {
      "login": "shahankhatch",
      "id": 14043935,
      "node_id": "MDQ6VXNlcjE0MDQzOTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14043935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shahankhatch",
      "html_url": "https://github.com/shahankhatch",
      "followers_url": "https://api.github.com/users/shahankhatch/followers",
      "following_url": "https://api.github.com/users/shahankhatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/shahankhatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shahankhatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shahankhatch/subscriptions",
      "organizations_url": "https://api.github.com/users/shahankhatch/orgs",
      "repos_url": "https://api.github.com/users/shahankhatch/repos",
      "events_url": "https://api.github.com/users/shahankhatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shahankhatch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T12:05:44Z",
    "updated_at": "2019-09-06T12:05:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Further notes from the chat:\r\nPhore BLS, what prysm is using, benches, go test -bench : https://github.com/phoreproject/bls/blob/master/g1pubs/verify_benchmark_test.go\r\n\r\nMilagro BLS, sigma prime fork, what most teams are using in some form or another. Run with cargo bench --features=\"bench\"\r\nhttps://github.com/sigp/milagro_bls/blob/master/benches/bls381_benches.rs",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/528828363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/528829970",
    "html_url": "https://github.com/ConsenSys/teku/issues/838#issuecomment-528829970",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/838",
    "id": 528829970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODgyOTk3MA==",
    "user": {
      "login": "shahankhatch",
      "id": 14043935,
      "node_id": "MDQ6VXNlcjE0MDQzOTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14043935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shahankhatch",
      "html_url": "https://github.com/shahankhatch",
      "followers_url": "https://api.github.com/users/shahankhatch/followers",
      "following_url": "https://api.github.com/users/shahankhatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/shahankhatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shahankhatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shahankhatch/subscriptions",
      "organizations_url": "https://api.github.com/users/shahankhatch/orgs",
      "repos_url": "https://api.github.com/users/shahankhatch/repos",
      "events_url": "https://api.github.com/users/shahankhatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shahankhatch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T12:11:24Z",
    "updated_at": "2019-09-06T12:13:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "A review of the implementations linked above reveals that the signature and key API in Artemis is different. Specifically, the above implementations treat sigs and keys as lists using methods such as `add`,`push`, and `append` (not the same across implementations), while Artemis returns a new object explicitly. \r\n\r\nExamples:\r\nhttps://github.com/phoreproject/bls/blob/master/g1pubs/verify_benchmark_test.go#L72\r\nhttps://github.com/phoreproject/bls/blob/master/g1pubs/verify_benchmark_test.go#L73\r\nhttps://github.com/sigp/milagro_bls/blob/master/benches/bls381_benches.rs#L169",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/528829970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/529048425",
    "html_url": "https://github.com/ConsenSys/teku/issues/838#issuecomment-529048425",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/838",
    "id": 529048425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyOTA0ODQyNQ==",
    "user": {
      "login": "shahankhatch",
      "id": 14043935,
      "node_id": "MDQ6VXNlcjE0MDQzOTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14043935?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shahankhatch",
      "html_url": "https://github.com/shahankhatch",
      "followers_url": "https://api.github.com/users/shahankhatch/followers",
      "following_url": "https://api.github.com/users/shahankhatch/following{/other_user}",
      "gists_url": "https://api.github.com/users/shahankhatch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shahankhatch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shahankhatch/subscriptions",
      "organizations_url": "https://api.github.com/users/shahankhatch/orgs",
      "repos_url": "https://api.github.com/users/shahankhatch/repos",
      "events_url": "https://api.github.com/users/shahankhatch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shahankhatch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T23:45:39Z",
    "updated_at": "2019-09-06T23:45:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Current rough benchmark puts us in the 20-40ms range, as expected. The sigp benchmark runs in ~7ms on an i7.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/529048425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
