{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/851",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/851/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/851/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/851/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/851",
  "id": 489268675,
  "node_id": "MDU6SXNzdWU0ODkyNjg2NzU=",
  "number": 851,
  "title": "Error if num validators < slots per epoch",
  "user": {
    "login": "jrhea",
    "id": 5555162,
    "node_id": "MDQ6VXNlcjU1NTUxNjI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5555162?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrhea",
    "html_url": "https://github.com/jrhea",
    "followers_url": "https://api.github.com/users/jrhea/followers",
    "following_url": "https://api.github.com/users/jrhea/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrhea/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrhea/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrhea/subscriptions",
    "organizations_url": "https://api.github.com/users/jrhea/orgs",
    "repos_url": "https://api.github.com/users/jrhea/repos",
    "events_url": "https://api.github.com/users/jrhea/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrhea/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-09-04T16:32:52Z",
  "updated_at": "2019-10-30T20:40:31Z",
  "closed_at": "2019-10-30T20:40:31Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/PegasysEng/artemis/blob/master/CODE-OF-CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging wiki: https://github.com/PegasysEng/artemis/wiki/debugging -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3APegasysEng/Artemis -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\nIf the number of Validators is less than the number of slots in an epoch.  Artemis produces an error at the slot where we run out of validators.\r\n\r\n```\r\nSetting logging level to INFO\r\n11:28:18.211 [INFO ] - nodeCounter: 0 startIndex: 0 endIndex: 6\r\n11:28:19.032 [INFO ] - ******* Eth2Genesis Event detected ******* : \r\n11:28:19.051 [INFO ] - Initial state root is 0xCCC5326122BE87A9636DBF3EB9B3F60210C7491C8E4D4FD4E6760FE6075024A1\r\n11:28:19.051 [INFO ] - Genesis block root is 0xE28477159E8AE322C53CE0E5F79D82A24476940734DB1A83AF1F53C405A5726F\r\n11:28:24.157 [INFO ] - ******* Slot Event *******\r\n11:28:24.158 [INFO ] - Node slot:                             0\r\n11:28:27.168 [INFO ] - Head block slot:                       0\r\n11:28:27.169 [INFO ] - Justified epoch:                       0\r\n11:28:27.169 [INFO ] - Finalized epoch:                       0\r\n11:28:30.154 [INFO ] - ******* Slot Event *******\r\n11:28:30.154 [INFO ] - Node slot:                             1\r\n11:28:30.155 [INFO ] - New BeaconBlock with state root:  0xE9926AD8BDD2C448AD3BF2E0772298E6C51B6CE2F6CBC99EB78EDE1AC743A148 detected.\r\n11:28:33.163 [INFO ] - Head block slot:                       1\r\n11:28:33.163 [INFO ] - Justified epoch:                       0\r\n11:28:33.163 [INFO ] - Finalized epoch:                       0\r\n11:28:33.234 [INFO ] - New Attestation with block root:  0x42A5AB6E69FEE321F78F084C85C1113CD51A0287C4F3BB869D8CD2C5A8D37494 detected.\r\n11:28:36.157 [INFO ] - ******* Slot Event *******\r\n11:28:36.158 [INFO ] - New BeaconBlock with state root:  0x8AE94D1BDEC3DF1AEFF44BCE08A8C20D59031A98CC5FDE77831A957135A9B864 detected.\r\n11:28:36.158 [INFO ] - Node slot:                             2\r\n11:28:39.163 [INFO ] - Head block slot:                       2\r\n11:28:39.163 [INFO ] - Justified epoch:                       0\r\n11:28:39.163 [INFO ] - Finalized epoch:                       0\r\n11:28:39.216 [INFO ] - New Attestation with block root:  0x9C40A26D0024D9DCFA185DBEF998F3F660DD5FE1ECCD4F3E582FCF0EA576A520 detected.\r\n11:28:42.153 [INFO ] - ******* Slot Event *******\r\n11:28:42.154 [INFO ] - New BeaconBlock with state root:  0x40C8726DE416872E5121726786FBB066C008496FABC4DC958982F2F66741719F detected.\r\n11:28:42.154 [INFO ] - Node slot:                             3\r\n11:28:45.159 [INFO ] - Head block slot:                       3\r\n11:28:45.159 [INFO ] - Justified epoch:                       0\r\n11:28:45.159 [INFO ] - Finalized epoch:                       0\r\n11:28:45.200 [INFO ] - New Attestation with block root:  0x8E8E24B44C351B6EF4C13F5E36638C8CC61F8F7545FCB3575CD90888464ECFBA detected.\r\n11:28:48.152 [INFO ] - ******* Slot Event *******\r\n11:28:48.153 [INFO ] - Node slot:                             4\r\n11:28:48.153 [INFO ] - New BeaconBlock with state root:  0x8E4153A6C612240CD84CEFC379433FB38B5E7D26EA0EEA2F735AB3A6113DA5B5 detected.\r\n11:28:51.157 [INFO ] - Head block slot:                       4\r\n11:28:51.157 [INFO ] - Justified epoch:                       0\r\n11:28:51.157 [INFO ] - Finalized epoch:                       0\r\n11:28:51.201 [INFO ] - New Attestation with block root:  0xEF433FB6E4385A55270732AECFBDF5729C7C30CEE3BFAB8C86C066D56C37D75E detected.\r\n11:28:54.152 [INFO ] - ******* Slot Event *******\r\n11:28:54.152 [INFO ] - New BeaconBlock with state root:  0xAF3A20E1436B29789E7E54FDD5DE803E3C88A6E86CF685A1D1FA4248DFA4F552 detected.\r\n11:28:54.152 [INFO ] - Node slot:                             5\r\n11:28:57.157 [INFO ] - Head block slot:                       5\r\n11:28:57.158 [INFO ] - Justified epoch:                       0\r\n11:28:57.158 [INFO ] - Finalized epoch:                       0\r\n11:28:57.191 [INFO ] - New Attestation with block root:  0x56A417B4EEA1F3E462EFD65A4F5C24FFF48B2A0B921B7C6883A905E31519FE97 detected.\r\n11:29:00.155 [INFO ] - ******* Slot Event *******\r\n11:29:00.156 [INFO ] - New BeaconBlock with state root:  0x8AC4DEBDC6C6A52F32C032C1C1900E952159D3694D5735633F748C4894E0D7DC detected.\r\n11:29:00.156 [INFO ] - Node slot:                             6\r\n11:29:03.161 [INFO ] - Head block slot:                       6\r\n11:29:03.161 [INFO ] - Justified epoch:                       0\r\n11:29:03.161 [INFO ] - Finalized epoch:                       0\r\n11:29:03.187 [INFO ] - New Attestation with block root:  0x6FC9A074CF6B132F30F9D55CAB7508E949D8127E25807ACFB00A7FEE876AEEF0 detected.\r\n11:29:06.153 [INFO ] - ******* Slot Event *******\r\n11:29:06.154 [INFO ] - New BeaconBlock with state root:  0xAC63EE4A2296A77F6C222835841E0E8E68AFF49AFF93B2878D449F3F02F641B5 detected.\r\n11:29:06.154 [INFO ] - Node slot:                             7\r\n11:29:09.161 [INFO ] - Head block slot:                       7\r\n11:29:09.161 [INFO ] - Justified epoch:                       0\r\n11:29:09.161 [INFO ] - Finalized epoch:                       0\r\n11:29:09.189 [INFO ] - New Attestation with block root:  0x89AF795CEEF4A3E1AB14CDEB2B3F877F13376C9F986AB4368749E356503D701A detected.\r\nSep 04, 2019 11:29:09 AM com.google.common.eventbus.EventBus$LoggingHandler handleException\r\nSEVERE: Exception thrown by subscriber method onNewAssignment(tech.pegasys.artemis.statetransition.ValidatorAssignmentEvent) on subscriber tech.pegasys.artemis.validator.coordinator.ValidatorCoordinator@4e17913b when dispatching event: tech.pegasys.artemis.statetransition.ValidatorAssignmentEvent@101284c6\r\njava.lang.ArithmeticException: / by zero\r\n        at com.google.common.primitives.UnsignedLongs.remainder(UnsignedLongs.java:294)\r\n        at com.google.common.primitives.UnsignedLong.mod(UnsignedLong.java:171)\r\n        at tech.pegasys.artemis.datastructures.util.BeaconStateUtil.get_beacon_proposer_index(BeaconStateUtil.java:660)\r\n        at tech.pegasys.artemis.validator.coordinator.ValidatorCoordinator.createBlockIfNecessary(ValidatorCoordinator.java:522)\r\n        at tech.pegasys.artemis.validator.coordinator.ValidatorCoordinator.onNewAssignment(ValidatorCoordinator.java:287)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n        at java.base/java.lang.reflect.Method.invoke(Method.java:566)\r\n        at com.google.common.eventbus.Subscriber.invokeSubscriberMethod(Subscriber.java:87)\r\n        at com.google.common.eventbus.Subscriber$SynchronizedSubscriber.invokeSubscriberMethod(Subscriber.java:144)\r\n        at com.google.common.eventbus.Subscriber$1.run(Subscriber.java:72)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)\r\n        at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)\r\n        at java.base/java.lang.Thread.run(Thread.java:834)\r\n\r\n```\r\n\r\n### Acceptance Criteria\r\n* Preprocessing step to ensure that we have enough validators for the given configuration (8 with minimal and 64 with mainnet)\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "jrhea",
    "id": 5555162,
    "node_id": "MDQ6VXNlcjU1NTUxNjI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5555162?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrhea",
    "html_url": "https://github.com/jrhea",
    "followers_url": "https://api.github.com/users/jrhea/followers",
    "following_url": "https://api.github.com/users/jrhea/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrhea/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrhea/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrhea/subscriptions",
    "organizations_url": "https://api.github.com/users/jrhea/orgs",
    "repos_url": "https://api.github.com/users/jrhea/repos",
    "events_url": "https://api.github.com/users/jrhea/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrhea/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/851/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/851/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
