{
  "url": "https://api.github.com/repos/Consensys/teku/issues/5681",
  "repository_url": "https://api.github.com/repos/Consensys/teku",
  "labels_url": "https://api.github.com/repos/Consensys/teku/issues/5681/labels{/name}",
  "comments_url": "https://api.github.com/repos/Consensys/teku/issues/5681/comments",
  "events_url": "https://api.github.com/repos/Consensys/teku/issues/5681/events",
  "html_url": "https://github.com/Consensys/teku/issues/5681",
  "id": 1257797556,
  "node_id": "I_kwDOCM9I9M5K-He0",
  "number": 5681,
  "title": "Implement EIP-4844 (proto danksharding)",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4760070044,
      "node_id": "LA_kwDOCM9I9M8AAAABG7jnnA",
      "url": "https://api.github.com/repos/Consensys/teku/labels/Epic%20Deneb",
      "name": "Epic Deneb",
      "color": "E1ED95",
      "default": false,
      "description": "Issues required to implement Deneb upgrade"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "tbenr",
    "id": 15999009,
    "node_id": "MDQ6VXNlcjE1OTk5MDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tbenr",
    "html_url": "https://github.com/tbenr",
    "followers_url": "https://api.github.com/users/tbenr/followers",
    "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
    "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
    "organizations_url": "https://api.github.com/users/tbenr/orgs",
    "repos_url": "https://api.github.com/users/tbenr/repos",
    "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tbenr/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mehdi-aouadi",
      "id": 1208687,
      "node_id": "MDQ6VXNlcjEyMDg2ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1208687?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mehdi-aouadi",
      "html_url": "https://github.com/mehdi-aouadi",
      "followers_url": "https://api.github.com/users/mehdi-aouadi/followers",
      "following_url": "https://api.github.com/users/mehdi-aouadi/following{/other_user}",
      "gists_url": "https://api.github.com/users/mehdi-aouadi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mehdi-aouadi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mehdi-aouadi/subscriptions",
      "organizations_url": "https://api.github.com/users/mehdi-aouadi/orgs",
      "repos_url": "https://api.github.com/users/mehdi-aouadi/repos",
      "events_url": "https://api.github.com/users/mehdi-aouadi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mehdi-aouadi/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "zilm13",
      "id": 6196452,
      "node_id": "MDQ6VXNlcjYxOTY0NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6196452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zilm13",
      "html_url": "https://github.com/zilm13",
      "followers_url": "https://api.github.com/users/zilm13/followers",
      "following_url": "https://api.github.com/users/zilm13/following{/other_user}",
      "gists_url": "https://api.github.com/users/zilm13/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zilm13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zilm13/subscriptions",
      "organizations_url": "https://api.github.com/users/zilm13/orgs",
      "repos_url": "https://api.github.com/users/zilm13/repos",
      "events_url": "https://api.github.com/users/zilm13/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zilm13/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "StefanBratanov",
      "id": 14827647,
      "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/StefanBratanov",
      "html_url": "https://github.com/StefanBratanov",
      "followers_url": "https://api.github.com/users/StefanBratanov/followers",
      "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
      "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
      "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
      "repos_url": "https://api.github.com/users/StefanBratanov/repos",
      "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "tbenr",
      "id": 15999009,
      "node_id": "MDQ6VXNlcjE1OTk5MDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tbenr",
      "html_url": "https://github.com/tbenr",
      "followers_url": "https://api.github.com/users/tbenr/followers",
      "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
      "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
      "organizations_url": "https://api.github.com/users/tbenr/orgs",
      "repos_url": "https://api.github.com/users/tbenr/repos",
      "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tbenr/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-06-02T07:24:38Z",
  "updated_at": "2023-11-02T16:41:48Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "[Specification](https://github.com/ethereum/consensus-specs/tree/dev/specs/eip4844)\r\n\r\nEverything that builds on top of previous fork should build on top of `Capella`, so it is strongly suggested to wait `Capella` classes to be defined before introducing `Eip4844` versions.\r\n\r\n### Decoupling EIP-4844 blobs\r\n\r\n- [x] #6822 \r\n\r\n### backlog\r\n\r\n- [x] #7167 \r\n- [x] #7203\r\n- [x] #6668 \r\n- [x] Optimize interface to Kzg library #6520 (we should minimize unnecessary data copy)\r\n- [ ] Add integration + acceptance tests + more unit tests for syncing (forward sync, historical batch fetcher, recent block fetcher)\r\n- [x] https://github.com/ConsenSys/teku/issues/6969\r\n\r\n### Nice to have\r\n- [ ] Make a BlobSidecar replacement for tests: `retrieveSignedBlockAndBlobsSidecar_shouldReturnEmptyIfBlockNotPresent`, `retrieveSignedBlockAndBlobsSidecar_withInconsistentSidecar`, `retrieveSignedBlockAndBlobsSidecar_withEmptyBlobs`, `retrieveSignedBlockAndBlobsSidecar_withBlobs` removed in #7085 \r\n- [ ] Restore DebugDbCommand `validate-blobs-sidecars` with BlobSidecars removed in #7085 \r\n- [x] #7369\r\n- [ ] Add new blob related structures in `JsonProviderPropertyTest`\r\n- [ ] Package consistency (blobs vs blob and blocks vs block)\r\n- [x] #6395\r\n- [ ] Issues under the KZG library (https://github.com/ConsenSys/jc-kzg-4844/issues)\r\n\r\n## Tasks below are prior to the blobs decoupling spec change, so may not be required\r\n\r\n### Configuration\r\n\r\n- [x] #6377\r\n- [x] #6378\r\n- [x] #6379\r\n- [x] #6382\r\n- [x] #6608 \r\n\r\n### SSZ Containers and schema\r\n\r\n- [x] #6383\r\n- [x] #6388\r\n- [x] #6479\r\n\r\n### Spec\r\n- [x] #6391\r\n- [x] #6401\r\n- [x] #6392\r\n- [x] #6440\r\n  - [x] BlindBlockUtilEip4844\r\n    - [x] SignedBeaconBlockBlinderEip4844\r\n    - [x] SignedBeaconBlockUnblinderEip4844\r\n- [x] #6454\r\n- [x] #6673\r\n\r\n### Validator coordinator\r\n- [x] #6411\r\n\r\n### Storage\r\n- [x] #6586\r\n- [x] #6629\r\n- [x] #6633 \r\n- [x] #6724\r\n\r\ncontext:\r\n\r\n- expected minimum space requirements (with current mainnet params) for the worst case scenario (maximum blob capacity):\r\n`FIELD_ELEMENTS_PER_BLOB` * `BLSFieldElement` * `MAX_BLOBS_PER_BLOCK` *  `MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS` * `SLOTS_PER_EPOCH` = 4096*32 _(131KB: max blob size)_ * 16  _(2MB max blobs sidecar)_ * 4096 * 32 = **256GiB**\r\n\r\nUpdate: `MAX_BLOBS_PER_BLOCK` is now 4 so space requirements goes down to **64GiB**\r\n\r\n- we need to serve blobs:\r\n  - by block root from the last finalized blobs to the most recent (to responds with a coupled SignedBeaconBlockAndBlobsSidecar)\r\n\r\n  - by slot range for p2p (still need do be decided if coupled or decoupled from blocks)\r\n\r\nOther things to consider:\r\n- check \"Additional notes\" from here: https://github.com/ConsenSys/teku/pull/6636 \r\n\r\n\r\n### Sync\r\n- [x] #6669 \r\n- [x] #6691 \r\n\r\nHistoricalBlockSyncService\r\n- [x] Implement blob sidecar backfill. This becomes critical since we can consider our head valid only if all blobs within MIN_EPOCHS_FOR_BLOBS_SIDECARS_REQUESTS have been downloaded (verified against the corresponding block)\r\n\r\nWe have to bare in mind that we have to run `validate_blobs_sidecar` against the alleged coupled block to make sure that they actually couple.\r\n\r\n### Networking\r\n\r\n- gossip\r\n  - [x] #6460\r\n  - [x] #6473\r\n- request\\response\r\n  - [x] Implement BeaconBlocksByRange v2\r\n  - [x] #6571\r\n  - [x] #6584 \r\n  - [x] #6585\r\n  - [x] #6602 \r\n  - [x] #6609\r\n  - [x] `BeaconBlocksByRootV2` is replaced by `BeaconBlockAndBlobsSidecarByRootV1` when 4844 activates. We have to continue using `BeaconBlocksByRootV2` until 4844 fork finalizes, to cover the case in which we want to lookup blocks from previous fork. (https://github.com/ethereum/consensus-specs/pull/3089) (covered in #6691)\r\n  - [x] #6638 \r\n  \r\ninteresting point from Lion: https://github.com/ethereum/consensus-specs/issues/3113\r\n\r\n\r\n### Beacon API\r\n\r\n- [x] #6710\r\n\r\n### Engine API\r\n\r\n - [x] #6387\r\n\r\n### KZG Crypto library\r\n- [x] #6389\r\n- [x] #6470\r\n\r\n\r\n### backlog\r\n\r\n- [x] #6422\r\n- [x] Follow https://github.com/ethereum/consensus-specs/pull/3145 preset changes when merged\r\n- [x] #6634 \r\n- [x] Enable 4844 reference tests\r\n- [x] Enable Capella operations when it will hit EIP-4844 reference test (should be `v1.3.0`). It was disabled in our code and it's [enabled finally in spec](https://github.com/ethereum/consensus-specs/pull/3181). \r\n- [x] change tx type from `0x05` to `0x03` https://github.com/ethereum/consensus-specs/pull/3317",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/Consensys/teku/issues/5681/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/Consensys/teku/issues/5681/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1263792174",
    "html_url": "https://github.com/Consensys/teku/issues/5681#issuecomment-1263792174",
    "issue_url": "https://api.github.com/repos/Consensys/teku/issues/5681",
    "id": 1263792174,
    "node_id": "IC_kwDOCM9I9M5LU_Au",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T16:42:01Z",
    "updated_at": "2022-09-30T16:42:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "[Implementation notes](https://hackmd.io/@terencechain/ByH4cbMfi) for consensus clients.",
    "reactions": {
      "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1263792174/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1265334634",
    "html_url": "https://github.com/Consensys/teku/issues/5681#issuecomment-1265334634",
    "issue_url": "https://api.github.com/repos/Consensys/teku/issues/5681",
    "id": 1265334634,
    "node_id": "IC_kwDOCM9I9M5La3lq",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T11:58:05Z",
    "updated_at": "2022-10-03T11:58:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "[4844 Readiness Checklist](https://github.com/ethereum/pm/blob/master/Breakout-Room/4844-readiness-checklist.md)",
    "reactions": {
      "url": "https://api.github.com/repos/Consensys/teku/issues/comments/1265334634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
