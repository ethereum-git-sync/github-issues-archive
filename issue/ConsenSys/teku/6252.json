{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6252",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6252",
  "id": 1387125494,
  "node_id": "I_kwDOCM9I9M5Srdr2",
  "number": 6252,
  "title": "Block produced with incorrect Fee Recipient 0x0000000000000000000000000000000000000001",
  "user": {
    "login": "PacoBits",
    "id": 38920606,
    "node_id": "MDQ6VXNlcjM4OTIwNjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/38920606?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PacoBits",
    "html_url": "https://github.com/PacoBits",
    "followers_url": "https://api.github.com/users/PacoBits/followers",
    "following_url": "https://api.github.com/users/PacoBits/following{/other_user}",
    "gists_url": "https://api.github.com/users/PacoBits/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PacoBits/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PacoBits/subscriptions",
    "organizations_url": "https://api.github.com/users/PacoBits/orgs",
    "repos_url": "https://api.github.com/users/PacoBits/repos",
    "events_url": "https://api.github.com/users/PacoBits/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PacoBits/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-09-27T05:35:26Z",
  "updated_at": "2022-09-28T08:25:44Z",
  "closed_at": "2022-09-28T08:25:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Our setup has produced a block with an incorrect fee recipient: https://etherscan.io/block/15616137\r\nWe have been producing blocks correctly and after that incident it is still producing blocks with the fee recipient correctly.\r\nWe have a 3-layer configuration with the validator client, the Beacon node and the execution client running separately.\r\n\r\nThis issue is not related to teku restart. Its RARE and not replicable at this moment. \r\n\r\nThese are our versions and  fee recipent setup:\r\n\r\nValidator set up - _version: Lighthouse/v3.1.0-aa022f4_\r\n_--graffiti \"Block by Stakely Lido09\"\r\n--suggested-fee-recipient 0x388C818CA8B9251b393131C08a736A67ccB19297_\r\n\r\nBeacon set up - _teku/v22.9.1/linux-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17\r\n\"--validators-graffiti='Block by Stakely.io - btk01'\",\r\n\"--validators-proposer-default-fee-recipient=0x7188D41ea11aBf3e95040ba1823E861A62644AC2\"_\r\n\r\nExecution Client - _Erigon/v2022.09.3-stable-32bd69e5/linux-amd64/go1.18.3_\r\n\r\nI attached logs from the time the block produced. The most complete log is the Erigon log, since it is running in debug mode.\r\n\r\n[Valc09_26092022.log](https://github.com/ConsenSys/teku/files/9656870/Valc09_26092022.log)\r\n[erigon_26092022.log](https://github.com/ConsenSys/teku/files/9656871/erigon_26092022.log)\r\n[Lighthouse_Beacon_26092022.log](https://github.com/ConsenSys/teku/files/9656872/Lighthouse_Beacon_26092022.log)\r\n[teku_26092022.log](https://github.com/ConsenSys/teku/files/9656873/teku_26092022.log)\r\n",
  "closed_by": {
    "login": "PacoBits",
    "id": 38920606,
    "node_id": "MDQ6VXNlcjM4OTIwNjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/38920606?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PacoBits",
    "html_url": "https://github.com/PacoBits",
    "followers_url": "https://api.github.com/users/PacoBits/followers",
    "following_url": "https://api.github.com/users/PacoBits/following{/other_user}",
    "gists_url": "https://api.github.com/users/PacoBits/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PacoBits/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PacoBits/subscriptions",
    "organizations_url": "https://api.github.com/users/PacoBits/orgs",
    "repos_url": "https://api.github.com/users/PacoBits/repos",
    "events_url": "https://api.github.com/users/PacoBits/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PacoBits/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6252/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259082309",
    "html_url": "https://github.com/ConsenSys/teku/issues/6252#issuecomment-1259082309",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252",
    "id": 1259082309,
    "node_id": "IC_kwDOCM9I9M5LDBJF",
    "user": {
      "login": "tbenr",
      "id": 15999009,
      "node_id": "MDQ6VXNlcjE1OTk5MDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tbenr",
      "html_url": "https://github.com/tbenr",
      "followers_url": "https://api.github.com/users/tbenr/followers",
      "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
      "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
      "organizations_url": "https://api.github.com/users/tbenr/orgs",
      "repos_url": "https://api.github.com/users/tbenr/repos",
      "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tbenr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T07:13:30Z",
    "updated_at": "2022-09-27T07:13:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hello,\r\nthe logs arrive around `Sep 26 02:50:53` (UTC) but the block production you are referring to is at around `Sep 26 07:44:00` (UTC)\r\n\r\nCan you provide the corresponding logs?\r\n\r\nAre you using `--log-destination=CONSOLE` in your docker\\docker-compose file for teku?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259082309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259126283",
    "html_url": "https://github.com/ConsenSys/teku/issues/6252#issuecomment-1259126283",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252",
    "id": 1259126283,
    "node_id": "IC_kwDOCM9I9M5LDL4L",
    "user": {
      "login": "tbenr",
      "id": 15999009,
      "node_id": "MDQ6VXNlcjE1OTk5MDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tbenr",
      "html_url": "https://github.com/tbenr",
      "followers_url": "https://api.github.com/users/tbenr/followers",
      "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
      "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
      "organizations_url": "https://api.github.com/users/tbenr/orgs",
      "repos_url": "https://api.github.com/users/tbenr/repos",
      "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tbenr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T07:55:39Z",
    "updated_at": "2022-09-27T07:55:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "I noticed the feeRecipient address ends with `1`. In teku, when something goes wrong and we cannot determine the fee recipient we use the all zeros burn address. So that feeRecipient must come from Lighthouse or Erigon ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259126283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259601059",
    "html_url": "https://github.com/ConsenSys/teku/issues/6252#issuecomment-1259601059",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252",
    "id": 1259601059,
    "node_id": "IC_kwDOCM9I9M5LE_yj",
    "user": {
      "login": "PacoBits",
      "id": 38920606,
      "node_id": "MDQ6VXNlcjM4OTIwNjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/38920606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PacoBits",
      "html_url": "https://github.com/PacoBits",
      "followers_url": "https://api.github.com/users/PacoBits/followers",
      "following_url": "https://api.github.com/users/PacoBits/following{/other_user}",
      "gists_url": "https://api.github.com/users/PacoBits/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PacoBits/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PacoBits/subscriptions",
      "organizations_url": "https://api.github.com/users/PacoBits/orgs",
      "repos_url": "https://api.github.com/users/PacoBits/repos",
      "events_url": "https://api.github.com/users/PacoBits/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PacoBits/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T14:35:06Z",
    "updated_at": "2022-09-27T14:35:06Z",
    "author_association": "NONE",
    "body": "Sorry, I have updated the logs. We have identified the problem.\r\n\r\nThe block was generated by erigon-teku correctly and sent to the validator, but at that moment there was a disconnection of teku and the validator:\r\nValidator client log - disconected beacon:\r\n`node09         | Sep 26 07:44:29.001 INFO Connected to beacon node(s)             synced: 2, available: 2, total: 3, service: notifier\r\n`\r\n\r\nSo the validator client continues the publication in the fallback beacon (Lighthouse beacon). This beacon does not have a default fee recipient set due to a problem. \r\n\r\nValidator client log - publised block and reconnected to teku: \r\n```\r\nnode09         | Sep 26 07:44:29.001 INFO All validators active                   slot: 4779520, epoch: 149360, total_validators: 500, active_validators: 500, current_epoch_proposers: 1, service: notifier\r\nnode09         | Sep 26 07:44:30.208 INFO Successfully published block            slot: 4779520, graffiti: Some(\"Block by Stakely Lido09\"), attestations: 128, deposits: 0, block_type: Full, service: block\r\nnode09         | Sep 26 07:44:34.023 INFO Connected to beacon node                endpoint: httpxxx://x.x.x.x:xxxx/, version: teku/v22.9.1/linux-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17\r\n```\r\nWe can see Lighthouse beacon log the problem: \r\n\r\n`lighthouse_beacon_node_1  | Sep 26 07:44:27.178 CRIT Fee recipient unknown                   proposer_index: 366592, msg: the suggested_fee_recipient was unknown during block production. a junk address was used, rewards were lost! check the --suggested-fee-recipient flag and VC configuration., service: exec\r\n`\r\n\r\nSo we need to solve the problems with fee-recipient on lighthouse and redirect the issue to them. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1259601059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1260561180",
    "html_url": "https://github.com/ConsenSys/teku/issues/6252#issuecomment-1260561180",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6252",
    "id": 1260561180,
    "node_id": "IC_kwDOCM9I9M5LIqMc",
    "user": {
      "login": "PacoBits",
      "id": 38920606,
      "node_id": "MDQ6VXNlcjM4OTIwNjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/38920606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PacoBits",
      "html_url": "https://github.com/PacoBits",
      "followers_url": "https://api.github.com/users/PacoBits/followers",
      "following_url": "https://api.github.com/users/PacoBits/following{/other_user}",
      "gists_url": "https://api.github.com/users/PacoBits/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PacoBits/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PacoBits/subscriptions",
      "organizations_url": "https://api.github.com/users/PacoBits/orgs",
      "repos_url": "https://api.github.com/users/PacoBits/repos",
      "events_url": "https://api.github.com/users/PacoBits/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PacoBits/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-28T08:25:44Z",
    "updated_at": "2022-09-28T08:25:44Z",
    "author_association": "NONE",
    "body": "The problem was because the Lighthouse validator client does not send the proposer preparation information to the fallback beacon node, so if an interruption occurs while preparing the block, this problem happens.  \r\nLighthouse team is working on it. \r\nThanks for support.\r\nClose the issue",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1260561180/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
