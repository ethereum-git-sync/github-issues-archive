{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6594",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6594/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6594/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6594/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6594",
  "id": 1494532703,
  "node_id": "I_kwDOCM9I9M5ZFMJf",
  "number": 6594,
  "title": "Improve checkpoint sync process and logging",
  "user": {
    "login": "remyroy",
    "id": 303593,
    "node_id": "MDQ6VXNlcjMwMzU5Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/303593?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/remyroy",
    "html_url": "https://github.com/remyroy",
    "followers_url": "https://api.github.com/users/remyroy/followers",
    "following_url": "https://api.github.com/users/remyroy/following{/other_user}",
    "gists_url": "https://api.github.com/users/remyroy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/remyroy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/remyroy/subscriptions",
    "organizations_url": "https://api.github.com/users/remyroy/orgs",
    "repos_url": "https://api.github.com/users/remyroy/repos",
    "events_url": "https://api.github.com/users/remyroy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/remyroy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-12-13T15:46:07Z",
  "updated_at": "2022-12-14T00:03:15Z",
  "closed_at": "2022-12-14T00:03:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nTeku hangs during initial state loading with a checkpoint sync.\r\n\r\n### Steps to Reproduce (Bug)\r\nLaunch Teku on Goerli with `--initial-state=https://prater.checkpoint.sigp.io/eth/v2/debug/beacon/states/finalized` option.\r\n\r\n### Output logs\r\n\r\n```\r\n2022-12-13 10:16:55,341 main INFO Configuring logging for destination: console and file\r\n2022-12-13 10:16:55,419 main INFO Logging file location: c:\\ethereum\\var\\lib\\teku\\logs\\teku.log\r\n2022-12-13 10:16:55,419 main INFO Logging includes events: true\r\n2022-12-13 10:16:55,419 main INFO Logging includes validator duties: true\r\n2022-12-13 10:16:55,434 main INFO Logging includes color: false\r\n2022-12-13 10:16:55,872 main INFO Include P2P warnings set to: false\r\n10:16:57.466 INFO  - Teku version: teku/v22.12.0/windows-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17\r\n10:16:57.466 INFO  - This software is licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this software except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n10:16:58.388 INFO  - Using portable BLST library.\r\n10:16:58.887 INFO  - Loading 1 validator keys...\r\n10:17:00.154 INFO  - Loaded 1 Validators: a830c39\r\n10:17:00.169 INFO  - Storing beacon chain data in: c:\\ethereum\\var\\lib\\teku\\beacon\r\n10:17:00.169 INFO  - Loading 0 validator keys...\r\n10:17:00.169 INFO  - Loaded 0 Validators: \r\n10:17:01.768 INFO  - Initializing storage\r\n10:17:01.768 INFO  - Storage initialization complete\r\n10:17:01.768 INFO  - Loading initial state from https://prater.checkpoint.sigp.io/eth/v2/debug/beacon/states/finalized\r\n```\r\n\r\n**Expected behavior:** More information being logged if the download takes a long time, some form of retry if there is an HTTP request issue or some sort of timeout if the checkpoint sync endpoint does not reply in time or does not behave as expected.\r\n\r\n**Actual behavior:** Teku just hangs in there for more than 15 minutes.\r\n\r\n**Frequency:** Sometimes when the checkpoint sync endpoint is misbehaving. This does not happen with all the checkpoint sync endpoints from https://eth-clients.github.io/checkpoint-sync-endpoints/ . Some are behaving better than others.\r\n\r\n### Versions\r\n* Software version: teku/v22.12.0/windows-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17\r\n* Java version: eclipseadoptium-openjdk64bitservervm-java-17 (Adoptium 17.0.5_8)\r\n* OS Name & Version: Windows 10 Version 10.0.19045.2251",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6594/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6594/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1349608955",
    "html_url": "https://github.com/ConsenSys/teku/issues/6594#issuecomment-1349608955",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6594",
    "id": 1349608955,
    "node_id": "IC_kwDOCM9I9M5QcWX7",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-13T19:56:53Z",
    "updated_at": "2022-12-13T19:56:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah we should check we have a reasonable timeout applied.  It's working for me now so likely was an issue with the server at the time.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1349608955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
