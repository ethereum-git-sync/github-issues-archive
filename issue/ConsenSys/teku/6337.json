{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6337",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6337/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6337/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6337/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6337",
  "id": 1421593280,
  "node_id": "I_kwDOCM9I9M5Uu8rA",
  "number": 6337,
  "title": "Missing validators API filters: active, pending, exited, withdrawal",
  "user": {
    "login": "austonst",
    "id": 1329703,
    "node_id": "MDQ6VXNlcjEzMjk3MDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1329703?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/austonst",
    "html_url": "https://github.com/austonst",
    "followers_url": "https://api.github.com/users/austonst/followers",
    "following_url": "https://api.github.com/users/austonst/following{/other_user}",
    "gists_url": "https://api.github.com/users/austonst/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/austonst/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/austonst/subscriptions",
    "organizations_url": "https://api.github.com/users/austonst/orgs",
    "repos_url": "https://api.github.com/users/austonst/repos",
    "events_url": "https://api.github.com/users/austonst/events{/privacy}",
    "received_events_url": "https://api.github.com/users/austonst/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "StefanBratanov",
    "id": 14827647,
    "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/StefanBratanov",
    "html_url": "https://github.com/StefanBratanov",
    "followers_url": "https://api.github.com/users/StefanBratanov/followers",
    "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
    "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
    "repos_url": "https://api.github.com/users/StefanBratanov/repos",
    "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "StefanBratanov",
      "id": 14827647,
      "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/StefanBratanov",
      "html_url": "https://github.com/StefanBratanov",
      "followers_url": "https://api.github.com/users/StefanBratanov/followers",
      "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
      "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
      "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
      "repos_url": "https://api.github.com/users/StefanBratanov/repos",
      "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-10-24T23:10:30Z",
  "updated_at": "2022-11-01T11:55:00Z",
  "closed_at": "2022-11-01T11:55:00Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\nThe official [beacon API specs](https://ethereum.github.io/beacon-APIs/?urls.primaryName=v2.3.0#/Beacon/getStateValidators) describe that the `/eth/v1/beacon/states/{state_id}/validators` call should be filterable by status. The full list of statuses is available on the API page and described in detail [here](https://hackmd.io/ofFJ5gOmQpu1jjHilHbdQQ). Teku has implemented all of the listed *sub-statuses*, but none of the main/meta statuses. These consist of: `active`, `pending`, `exited`, and `withdrawal`.\r\n\r\nThe [Teku beacon API documentation](https://consensys.github.io/teku/#tag/Beacon/operation/getEthV1BeaconStatesWithState_idValidators) excludes these from the list of available filters and the API does not appear to provide them in practice.\r\n\r\nThis is an issue when using software that relies on these filters. One such example is the [current flashbots/mev-boost-relay](https://github.com/flashbots/mev-boost-relay/blob/e4bdcbe0ab2f46c7f4ae68424e0334643ccfb9a4/beaconclient/prod_beacon_instance.go#L89), which filters by `pending,active` in order to retrieve the list of all validators who may register with the relay in the near future.\r\n\r\n### Steps to Reproduce (Bug)\r\nWith a running Teku client, fully synced:\r\n> `curl http://{node}:{port}/eth/v1/beacon/states/head/validators?status=active`\r\n\r\nReplace `active` with `pending`, `exited`, or `withdrawal`.\r\n\r\n**Expected behavior:** The node returns a json array of ValidatorResponses, filtered according to the given filter names.\r\n\r\n**Actual behavior:** The node returns an HTTP 400 error:\r\n> {\"code\":400,\"message\":\"No enum constant tech.pegasys.teku.api.response.v1.beacon.ValidatorStatus.active\"}\r\n\r\n**Frequency:** Always\r\n\r\n### Versions (Add all that apply)\r\n* Docker image: consensys/teku:latest (image pushed Oct 11, 2022 at 2:14 am)\r\n* Software version: teku/v22.10.1/linux-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17\r\n* Java version [in docker container]: openjdk 17.0.4.1 2022-08-12\r\n* Docker Version: 20.10.19",
  "closed_by": {
    "login": "StefanBratanov",
    "id": 14827647,
    "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/StefanBratanov",
    "html_url": "https://github.com/StefanBratanov",
    "followers_url": "https://api.github.com/users/StefanBratanov/followers",
    "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
    "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
    "repos_url": "https://api.github.com/users/StefanBratanov/repos",
    "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6337/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6337/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
