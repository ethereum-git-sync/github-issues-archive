{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/1481",
  "id": 588127165,
  "node_id": "MDU6SXNzdWU1ODgxMjcxNjU=",
  "number": 1481,
  "title": "Logging config overriding custom config file",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2020-03-26T03:25:28Z",
  "updated_at": "2020-04-03T05:10:45Z",
  "closed_at": "2020-04-03T05:10:44Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\nWhen running Teku with a custom Log4J config file, the internal logging configuration is still running and causing additional log output.\r\n\r\nSpecifically I wind up with:\r\n```\r\n2020-03-26 13:22:49.468+10:00 | TimeTickChannel-1 | INFO  | teku-event-log | ******* Slot Event *******\r\n13:22:49.468 [INFO ] - Node slot:                             97\r\n2020-03-26 13:22:49.468+10:00 | TimeTickChannel-1 | INFO  | teku-event-log | Node slot:                             97\r\n13:22:49.469 [INFO ] - Head block slot:                       97\r\n2020-03-26 13:22:49.469+10:00 | TimeTickChannel-1 | INFO  | teku-event-log | Head block slot:                       97\r\n13:22:49.469 [INFO ] - Justified epoch:                       11\r\n2020-03-26 13:22:49.469+10:00 | TimeTickChannel-1 | INFO  | teku-event-log | Justified epoch:                       11\r\n13:22:49.469 [INFO ] - Finalized epoch:                       10\r\n2020-03-26 13:22:49.469+10:00 | TimeTickChannel-1 | INFO  | teku-event-log | Finalized epoch:                       10\r\n```\r\n\r\nwhen using the logging config:\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<Configuration status=\"DEBUG\" monitorInterval=\"5\">\r\n    <Appenders>\r\n        <Console name=\"console\" target=\"SYSTEM_OUT\">\r\n            <PatternLayout pattern=\"%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n\" />\r\n        </Console>\r\n    </Appenders>\r\n    <Loggers>\r\n        <Root level=\"INFO\">\r\n            <AppenderRef ref=\"console\"/>\r\n        </Root>\r\n    </Loggers>\r\n</Configuration>\r\n```\r\n\r\nThere are no logging options specified in the config file so Teku should not be adjusting the logging config.",
  "closed_by": {
    "login": "CjHare",
    "id": 13285122,
    "node_id": "MDQ6VXNlcjEzMjg1MTIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CjHare",
    "html_url": "https://github.com/CjHare",
    "followers_url": "https://api.github.com/users/CjHare/followers",
    "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
    "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
    "organizations_url": "https://api.github.com/users/CjHare/orgs",
    "repos_url": "https://api.github.com/users/CjHare/repos",
    "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CjHare/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/1481/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604209069",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-604209069",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 604209069,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDIwOTA2OQ==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-26T03:33:25Z",
    "updated_at": "2020-03-26T03:33:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "The default value for logging is actually `both`, meaning console output and log file output for the `STATUS_LOG` and `EVENT_LOG` but only log file output for everything else.\r\n\r\nThe configuration is added to programmatically during the Teku startup.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604209069/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604211617",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-604211617",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 604211617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDIxMTYxNw==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-26T03:43:36Z",
    "updated_at": "2020-03-26T03:43:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "We ultimately need it to be like Besu - if you don't specifically set any logging options, it won't override your custom logging.  If you also don't have a custom logging setup the defaulting to the \"both\" mode makes sense.  That's pretty simple to achieve with the XML-based config since it gets replaced by any custom logging config, but programmatically augmenting the config makes it more challenging.  Not really sure what can be done - the simplest option would be that if the `log4j.configurationFile` system property is set, don't change any logging properties.  Hopefully there's a better way of doing it though as Log4J has a few places it looks for custom logging configs and we'd ideally want to pick up them all (or at least the most common ones).",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604211617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604213793",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-604213793",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 604213793,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNDIxMzc5Mw==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-26T03:52:47Z",
    "updated_at": "2020-03-26T03:52:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "> if you don't specifically set any logging options, it won't override your custom logging.\r\n\r\nSounds like decent requirements.\r\n\r\nAlright, I'll take a look at the various System/Environment config options Log4j allows users to set custom logging and figure out whether there is custom logging and not apply the default programmatic logging when there is custom logging.\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/604213793/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/605766602",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-605766602",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 605766602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNTc2NjYwMg==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-30T03:44:11Z",
    "updated_at": "2020-03-30T03:44:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fun fact about Log4j custom config files, it supports two different variables (one legacy, one newish) , which can be either System or Environment variables, meaning to tell if a custom config was used the code looks like this:\r\n```\r\n  private static final String LOG4J_ENVIRONMENTAL_CONFIG_FILE_KEY = \"LOG4J_CONFIGURATION_FILE\";\r\n  private static final String LOG4J_ENVIRONMENTAL_LEGACY_CONFIG_FILE_KEY = \"log4j.configurationFile\";\r\n\r\n  private static boolean isProgrammaticLoggingNeeded() {\r\n    return System.getenv(LOG4J_ENVIRONMENTAL_LEGACY_CONFIG_FILE_KEY) == null\r\n        && System.getenv(LOG4J_ENVIRONMENTAL_CONFIG_FILE_KEY) == null\r\n        && System.getProperty(LOG4J_ENVIRONMENTAL_LEGACY_CONFIG_FILE_KEY) == null\r\n        && System.getProperty(LOG4J_ENVIRONMENTAL_CONFIG_FILE_KEY) == null\r\n  }\r\n```\r\n\r\nThink I'm going to embrace having the destination as an optional in the Teku config and use that as a semaphore for whether the user wants the programmatic logging.\r\n ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/605766602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/605786479",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-605786479",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 605786479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNTc4NjQ3OQ==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-30T05:13:59Z",
    "updated_at": "2020-03-30T05:13:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Issue addressed by https://github.com/PegaSysEng/teku/pull/1502",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/605786479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608220812",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-608220812",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 608220812,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwODIyMDgxMg==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-03T04:21:49Z",
    "updated_at": "2020-04-03T04:21:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ajsutton do you still experience this issue with the head of the master branch or have the various commits resolved the issue?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608220812/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608221737",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-608221737",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 608221737,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwODIyMTczNw==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-03T04:25:34Z",
    "updated_at": "2020-04-03T04:25:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes this is working for me now.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608221737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608233073",
    "html_url": "https://github.com/ConsenSys/teku/issues/1481#issuecomment-608233073",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/1481",
    "id": 608233073,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwODIzMzA3Mw==",
    "user": {
      "login": "CjHare",
      "id": 13285122,
      "node_id": "MDQ6VXNlcjEzMjg1MTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/13285122?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CjHare",
      "html_url": "https://github.com/CjHare",
      "followers_url": "https://api.github.com/users/CjHare/followers",
      "following_url": "https://api.github.com/users/CjHare/following{/other_user}",
      "gists_url": "https://api.github.com/users/CjHare/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CjHare/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CjHare/subscriptions",
      "organizations_url": "https://api.github.com/users/CjHare/orgs",
      "repos_url": "https://api.github.com/users/CjHare/repos",
      "events_url": "https://api.github.com/users/CjHare/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CjHare/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-03T05:10:44Z",
    "updated_at": "2020-04-03T05:10:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Awesome, in that case I'll close off this issue ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/608233073/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
