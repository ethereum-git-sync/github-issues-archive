{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/4213",
  "id": 960763665,
  "node_id": "MDU6SXNzdWU5NjA3NjM2NjU=",
  "number": 4213,
  "title": "Suppress performance output when not relevant",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1048919131,
      "node_id": "MDU6TGFiZWwxMDQ4OTE5MTMx",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/enhancement%20%F0%9F%95%B5%EF%B8%8F%E2%80%8D%E2%99%80%EF%B8%8F",
      "name": "enhancement 🕵️‍♀️",
      "color": "a2eeef",
      "default": false,
      "description": "New feature or request"
    },
    {
      "id": 1170684912,
      "node_id": "MDU6TGFiZWwxMTcwNjg0OTEy",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/good%20first%20issue%20:raising_hand:",
      "name": "good first issue :raising_hand:",
      "color": "006b75",
      "default": false,
      "description": "This is a good first issue for a new contributor to work on"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-08-04T17:19:51Z",
  "updated_at": "2021-09-05T21:48:36Z",
  "closed_at": "2021-09-05T21:48:36Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "```\r\n18:07:24.132 INFO  - Sync Event  *** Current slot: 1772735, Head slot: 1540800, Connected peers: 29\r\n18:07:35.503 INFO  - Sync Event  *** Current slot: 1772736, Head slot: 1540929, Connected peers: 29\r\n18:07:35.504 INFO  - Attestation performance: expected 0, produced 0, included 0 (0%), distance 0 / 0.00 / 0, correct target 0 (0%), correct head 0 (0%)\r\n18:07:47.423 INFO  - Sync Event  *** Current slot: 1772737, Head slot: 1541056, Connected peers: 28\r\n18:08:00.280 INFO  - Sync Event  *** Current slot: 1772738, Head slot: 1541163, Connected peers: 27\r\n```\r\n\r\nThere are a couple of things not great about the above:\r\n1. performance info is irrelevant while syncing; and\r\n2. I am not running any validators on this instance so it is irrelevant, full stop.\r\n\r\nNote that `--validators-performance-tracking-mode` defaults to `ALL`. I guess I could suppress this by setting it to something else (but what?? `--help` doesn't tell me what the other options are), but it should probably be always suppressed if either 1 or 2 above is true.\r\n\r\nThe simplest approach is probably to omit the performance info whenever \"expected\" is \"0\"; that ought to resolve both cases.",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/4213/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912223412",
    "html_url": "https://github.com/ConsenSys/teku/issues/4213#issuecomment-912223412",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
    "id": 912223412,
    "node_id": "IC_kwDOCM9I9M42X2y0",
    "user": {
      "login": "ermyas",
      "id": 3389851,
      "node_id": "MDQ6VXNlcjMzODk4NTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3389851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ermyas",
      "html_url": "https://github.com/ermyas",
      "followers_url": "https://api.github.com/users/ermyas/followers",
      "following_url": "https://api.github.com/users/ermyas/following{/other_user}",
      "gists_url": "https://api.github.com/users/ermyas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ermyas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ermyas/subscriptions",
      "organizations_url": "https://api.github.com/users/ermyas/orgs",
      "repos_url": "https://api.github.com/users/ermyas/repos",
      "events_url": "https://api.github.com/users/ermyas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ermyas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T03:17:15Z",
    "updated_at": "2021-09-03T03:17:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi,\r\n\r\nI can take this up. From what I gather, there are three related issues being raised here\r\n\r\n1. `—validators-performance-tracking-mode` usage help message should list the set of options that can be specified.\r\n\r\n2. The relationship between the `—validators-performance-tracking-enabled` and `—validators-performance-tracking-mode`, should perhaps be described in the help message. It appears the former overrides the latter if specified.\r\n\r\n3. Performance metrics output, when not relevant, should be suppressed regardless.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912223412/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912229435",
    "html_url": "https://github.com/ConsenSys/teku/issues/4213#issuecomment-912229435",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
    "id": 912229435,
    "node_id": "IC_kwDOCM9I9M42X4Q7",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T03:37:18Z",
    "updated_at": "2021-09-03T03:37:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "> 1. `—validators-performance-tracking-mode` usage help message should list the set of options that can be specified.\r\n\r\nYep, note that you use something like ` (Valid values: ${COMPLETION-CANDIDATES})` and PicoCLI will automatically fill in the available options.\r\n\r\n> 2. The relationship between the `—validators-performance-tracking-enabled` and `—validators-performance-tracking-mode`, should perhaps be described in the help message. It appears the former overrides the latter if specified.\r\n\r\nYes, probably worth a note in the help for `--validators-performance-tracking-mode` that it's ignored if `--validators-performance-tracking-enabled=false`\r\n\r\n> 3. Performance metrics output, when not relevant, should be suppressed regardless.\r\n\r\nYep. That's probably the key change here. I'd suggest that if we didn't expect to produce any attestations in the epoch then we shouldn't log the message.  That may happen while the node is syncing, when there are no validators running locally or when the local validators aren't currently active.  All those cases will just boil down to omitting the message when \"expected\" is \"0\" as Ben says.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912229435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912241484",
    "html_url": "https://github.com/ConsenSys/teku/issues/4213#issuecomment-912241484",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
    "id": 912241484,
    "node_id": "IC_kwDOCM9I9M42X7NM",
    "user": {
      "login": "ermyas",
      "id": 3389851,
      "node_id": "MDQ6VXNlcjMzODk4NTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3389851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ermyas",
      "html_url": "https://github.com/ermyas",
      "followers_url": "https://api.github.com/users/ermyas/followers",
      "following_url": "https://api.github.com/users/ermyas/following{/other_user}",
      "gists_url": "https://api.github.com/users/ermyas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ermyas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ermyas/subscriptions",
      "organizations_url": "https://api.github.com/users/ermyas/orgs",
      "repos_url": "https://api.github.com/users/ermyas/repos",
      "events_url": "https://api.github.com/users/ermyas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ermyas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T04:13:51Z",
    "updated_at": "2021-09-03T04:13:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Yes, probably worth a note in the help for `--validators-performance-tracking-mode` that it's ignored if `--validators-performance-tracking-enabled=false`\r\n\r\nyea, I think it is ignored even if `--validators-performance-tracking-enabled` is set to true though. [Basically, if that option is true, the mode is overridden to be `ALL` and if false the mode it is set to `NONE`](https://github.com/ConsenSys/teku/blob/master/teku/src/main/java/tech/pegasys/teku/cli/options/ValidatorOptions.java#L115-L121). ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912241484/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912243021",
    "html_url": "https://github.com/ConsenSys/teku/issues/4213#issuecomment-912243021",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
    "id": 912243021,
    "node_id": "IC_kwDOCM9I9M42X7lN",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T04:18:07Z",
    "updated_at": "2021-09-03T04:18:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "> yea, I think it is ignored even if `--validators-performance-tracking-enabled` is set to true though. [Basically, if that option is true, the mode is overridden to be `ALL` and if false the mode it is set to `NONE`](https://github.com/ConsenSys/teku/blob/master/teku/src/main/java/tech/pegasys/teku/cli/options/ValidatorOptions.java#L115-L121).\r\n\r\nOh yes you're right.  I remember the history here now.  Originally it was just the `-enabled` flag and then we wound up with three modes so the `-tracking-mode` option was introduced as a replacement for the `-enabled` one. `validators-performance-tracking-enabled` has been hidden for quite some time so we don't actually need to mention it in help since it doesn't appear there (the `hidden = true` attribute`.  We should add it as an upcoming breaking change in the changelog and then in a couple of releases we can just remove it.  It's pretty unlikely anyone is still using it now but always good to actually follow the deprecation process and give warning in the release notes.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912243021/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912245194",
    "html_url": "https://github.com/ConsenSys/teku/issues/4213#issuecomment-912245194",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4213",
    "id": 912245194,
    "node_id": "IC_kwDOCM9I9M42X8HK",
    "user": {
      "login": "ermyas",
      "id": 3389851,
      "node_id": "MDQ6VXNlcjMzODk4NTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3389851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ermyas",
      "html_url": "https://github.com/ermyas",
      "followers_url": "https://api.github.com/users/ermyas/followers",
      "following_url": "https://api.github.com/users/ermyas/following{/other_user}",
      "gists_url": "https://api.github.com/users/ermyas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ermyas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ermyas/subscriptions",
      "organizations_url": "https://api.github.com/users/ermyas/orgs",
      "repos_url": "https://api.github.com/users/ermyas/repos",
      "events_url": "https://api.github.com/users/ermyas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ermyas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T04:24:19Z",
    "updated_at": "2021-09-03T04:24:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "got it thanks. I hadn't noticed that the tracking-enabled option was hidden.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/912245194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
