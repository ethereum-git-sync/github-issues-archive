{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5312",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5312",
  "id": 1196689506,
  "node_id": "I_kwDOCM9I9M5HVAhi",
  "number": 5312,
  "title": "[Merge] Store blocks and execution payloads separately",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-04-08T00:24:53Z",
  "updated_at": "2023-03-14T08:59:06Z",
  "closed_at": "2023-03-14T08:59:06Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\nPost-merge the `ExecutionPayload` inside a block can be quite large and isn't needed for a lot of operations (only the payload header). In particular it's not required when replaying blocks to generate state.\n\nCurrently in the in-memory and on-disk stores, teku is storing the whole block with execution payload but we could likely reduce memory requirements without loss of performance by splitting the two so that normally we work with blinded blocks (containing only the payload header) and then load the execution payload separately when it's required.",
  "closed_by": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5312/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1092324158",
    "html_url": "https://github.com/ConsenSys/teku/issues/5312#issuecomment-1092324158",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312",
    "id": 1092324158,
    "node_id": "IC_kwDOCM9I9M5BG4s-",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-08T00:25:50Z",
    "updated_at": "2022-04-08T00:25:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "This would also potentially set things up well to not store the execution payload in Teku's database but retrieve it from the EL when required. Probably not the initial goal but should be considered when adjusting the APIs involved with retrieving blocks.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1092324158/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1223516959",
    "html_url": "https://github.com/ConsenSys/teku/issues/5312#issuecomment-1223516959",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5312",
    "id": 1223516959,
    "node_id": "IC_kwDOCM9I9M5I7WMf",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T04:20:03Z",
    "updated_at": "2022-08-23T04:20:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "3 benchmark tests:\n - storing hotblocks vs. storing blinded hotblocks and payloads saw a 12% slowdown\n - storing hotblocks vs. blinded blocks and no payload was faster but not significantly\n- epoch transition with blinded blocks vs. unblinded blocks - blinded blocks see approx a 5% improvement in times.\n\nAt this stage it's a bit of a mixed bag, and we're not able to easily fetch payload from EE currently. We might park this change for now and re-visit once async transactions are complete, and we can fetch payloads from EE...",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1223516959/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
