{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5151",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5151/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5151/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5151/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5151",
  "id": 1164927235,
  "node_id": "I_kwDOCM9I9M5Fb2ED",
  "number": 5151,
  "title": "Single node Bellatrix AT",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-03-10T08:47:06Z",
  "updated_at": "2022-03-29T10:10:57Z",
  "closed_at": "2022-03-29T10:10:57Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\nAdd an acceptance test to confirm that a single node with Teku and an EL can start pre-merge, produce the transition block and progress the chain post-merge.",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5151/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5151/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1066302108",
    "html_url": "https://github.com/ConsenSys/teku/issues/5151#issuecomment-1066302108",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5151",
    "id": 1066302108,
    "node_id": "IC_kwDOCM9I9M4_jnqc",
    "user": {
      "login": "jimmygchen",
      "id": 742762,
      "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimmygchen",
      "html_url": "https://github.com/jimmygchen",
      "followers_url": "https://api.github.com/users/jimmygchen/followers",
      "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
      "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
      "repos_url": "https://api.github.com/users/jimmygchen/repos",
      "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-14T03:25:02Z",
    "updated_at": "2022-03-14T03:25:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've made some progress with the merge acceptance tests - have both EL & CL running, and able to reach TTD. However I'm having issue with Besu's terminal block check. I will do a bit more digging on Besu repo tomorrow .. but would be amazing if you could take a look to see if there's anything obvious to you, and whether I'm going in the right direction. \r\n\r\nhttps://github.com/ConsenSys/teku/compare/master...jchen86:master\r\n\r\nI've pulled latest Teku master branch, and running besu develop image for this test.\r\n\r\nTwo issues I've noticed in logs:\r\n\r\n1. Unable to create valid blocks after POW reach TTD (Besu)\r\n\r\n```\r\n2022-03-14 01:59:29.325+00:00 | docker-java-stream--1387523461 | DEBUG | BesuNode | 2022-03-14 01:59:29.352+00:00 | vert.x-worker-thread-0 | WARN  | MergeCoordinator | checking ancestor 199 (0x0c3dd4048aac142e7dadf6537b077e6b755b5e09636b124c41958a724d802f16) is valid terminal PoW for 200 (0x1000474634a40f5fb2143ece15be240522b7dfeafd44d02789dbfa029ece51be)\r\n2022-03-14 01:59:29.325+00:00 | docker-java-stream--1387523461 | DEBUG | BesuNode | false\r\n2022-03-14 01:59:29.325+00:00 | docker-java-stream--1387523461 | DEBUG | BesuNode | 2022-03-14 01:59:29.352+00:00 | vert.x-worker-thread-0 | WARN  | MergeCoordinator | Couldn't find terminal block, no blocks will be valid\r\n```\r\n\r\n2. After merge transition, Teku is unable to obtain a payloadId. I suspect this is related to the above.\r\n\r\n```\r\n2022-03-14 02:54:14.999+00:00 | docker-java-stream--949041815 | DEBUG | TekuNode | 2022-03-14 02:54:15.014 ERROR - Validator   *** Failed to produce block  Slot: 11 Validator: 893c934\r\n2022-03-14 02:54:14.999+00:00 | docker-java-stream--949041815 | DEBUG | TekuNode | java.lang.IllegalStateException: Unable to obtain a payloadId\r\n2022-03-14 02:54:14.999+00:00 | docker-java-stream--949041815 | DEBUG | TekuNode | at tech.pegasys.teku.statetransition.forkchoice.ForkChoiceNotifierImpl.lambda$internalGetPayloadId$7(ForkChoiceNotifierImpl.java:181) ~[teku-ethereum-statetransition-develop.jar:22.3.0+63-g984a9de]\r\n2022-03-14 02:54:14.999+00:00 | docker-java-stream--949041815 | DEBUG | TekuNode | at \r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1066302108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
