{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/2833",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/2833",
  "id": 706557863,
  "node_id": "MDU6SXNzdWU3MDY1NTc4NjM=",
  "number": 2833,
  "title": "Head slot > Current slot after a reorg",
  "user": {
    "login": "JaimeGomezGarcia",
    "id": 35458562,
    "node_id": "MDQ6VXNlcjM1NDU4NTYy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35458562?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JaimeGomezGarcia",
    "html_url": "https://github.com/JaimeGomezGarcia",
    "followers_url": "https://api.github.com/users/JaimeGomezGarcia/followers",
    "following_url": "https://api.github.com/users/JaimeGomezGarcia/following{/other_user}",
    "gists_url": "https://api.github.com/users/JaimeGomezGarcia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JaimeGomezGarcia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JaimeGomezGarcia/subscriptions",
    "organizations_url": "https://api.github.com/users/JaimeGomezGarcia/orgs",
    "repos_url": "https://api.github.com/users/JaimeGomezGarcia/repos",
    "events_url": "https://api.github.com/users/JaimeGomezGarcia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JaimeGomezGarcia/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-09-22T17:16:13Z",
  "updated_at": "2020-10-02T10:45:42Z",
  "closed_at": "2020-10-02T10:45:42Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nOpening this issue as per Benjaminion suggestion on Discord.\r\nMy Teku client became permanently out of sync with Sync events where Head slot was greater than Current slot.\r\n\r\n### Environment\r\nTeku version: teku/v0.12.7-dev-90d58455/linux-x86_64/oracle_openjdk-java-14\r\nDocker version 18.09.8, build bfed4f5\r\nOn a Synology NAS 2018+ with 6GB RAM.\r\nValidator: 0x96d44f1dd620605b3937494ba9ce04114166524d649a1490750918229bae4ab9ec21af4f654cfc70889034298787ec96\r\nKernel version: Linux biblioteca3 4.4.59+ #25426 SMP PREEMPT Wed Jul 8 03:21:29 CST 2020 x86_64 GNU/Linux synology_apollolake_218+\r\n\r\ndocker stop / docker start did not solve the issue\r\n\r\n### Sample error logs\r\n```\r\n2020-09-22 13:28:27.367+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 349689, Head slot: 352666, Connected peers: 49\r\n2020-09-22 13:28:42.173+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 349690, Head slot: 352668, Connected peers: 49\r\n2020-09-22 13:29:22.040+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 349691, Head slot: 352671, Connected peers: 52\r\n2020-09-22 13:32:45.357+00:00 | beaconchain-async-157 | INFO  | StateGenerator | Regenerate state for block 0xf54fba232f3fdeeaf152f28f50b082a0ec118bd50879be1b13c19fdec84c24bb by replaying 1 blocks\r\n2020-09-22 13:32:45.364+00:00 | beaconchain-async-157 | INFO  | StateGenerator | Completed regeneration of block 0xf54fba232f3fdeeaf152f28f50b082a0ec118bd50879be1b13c19fdec84c24bb at slot 352608 by replaying 1 blocks. Took 5ms\r\n2020-09-22 13:34:55.260+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 11019 (0xf54fba232f3fdeeaf152f28f50b082a0ec118bd50879be1b13c19fdec84c24bb) but now 11020 (0x78ecd9c90352fc6ee7ccaf9755c10ced4337271c056af5f49774d96b0542f999)\r\n2020-09-22 13:34:55.261+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 349692, Head slot: 352671, Connected peers: 73\r\n```\r\n\r\n### When the error happened\r\nThe last block validated my node and accpeted by the network was slot 346684\r\nLooking at that the next logs I found the head vs current mismatch starting after slot 346830. The logfiles are:\r\n\r\n\r\n```\r\n2020-09-21 17:10:49.957+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 346830, Head slot: 346815, Connected peers: 74\r\n2020-09-21 17:13:48.130+00:00 | beaconchain-async-272 | INFO  | RecentChainData | Chain reorg from ad4774..f423 (346830) to 786d9f..00b3 (346830). Common ancestor at slot 346815\r\n2020-09-21 17:13:48.143+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 10836 (0x2200129f4fca71b449009274489b11d8356930300a041ca668e3ceb236c0c510) but now 10837 (0x4aea9602e72a2f0f5f123ba3da3ecd292fefa7e8aa9676fe40064c0734623088)\r\n2020-09-21 17:13:48.144+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 346831, Head slot: 346816, Connected peers: 74\r\n2020-09-21 17:14:03.416+00:00 | beaconchain-async-272 | INFO  | RecentChainData | Chain reorg from 786d9f..00b3 (346830) to d7e8a7..550b (346830). Common ancestor at slot 346816\r\n2020-09-21 17:14:14.223+00:00 | beaconchain-async-275 | INFO  | RecentChainData | Chain reorg from d7e8a7..550b (346830) to 46fef6..3f81 (346830). Common ancestor at slot 346818\r\n2020-09-21 17:14:19.550+00:00 | beaconchain-async-275 | INFO  | RecentChainData | Chain reorg from 46fef6..3f81 (346830) to 3c414c..b240 (346830). Common ancestor at slot 346819\r\n2020-09-21 17:14:24.566+00:00 | beaconchain-async-275 | INFO  | RecentChainData | Chain reorg from 3c414c..b240 (346830) to 3f3b50..49ea (346830). Common ancestor at slot 346820\r\n2020-09-21 17:14:39.368+00:00 | beaconchain-async-270 | INFO  | RecentChainData | Chain reorg from 3f3b50..49ea (346830) to 65e4fe..445c (346830). Common ancestor at slot 346821\r\n2020-09-21 17:14:44.368+00:00 | beaconchain-async-276 | INFO  | RecentChainData | Chain reorg from 65e4fe..445c (346830) to 402305..9660 (346830). Common ancestor at slot 346822\r\n2020-09-21 17:14:55.692+00:00 | beaconchain-async-272 | INFO  | RecentChainData | Chain reorg from 402305..9660 (346830) to ab65ca..32ce (346830). Common ancestor at slot 346823\r\n2020-09-21 17:15:05.801+00:00 | beaconchain-async-275 | INFO  | RecentChainData | Chain reorg from ab65ca..32ce (346830) to 90f238..c814 (346830). Common ancestor at slot 346826\r\n2020-09-21 17:15:16.031+00:00 | beaconchain-async-276 | INFO  | RecentChainData | Chain reorg from 90f238..c814 (346830) to 335da1..5eb7 (346830). Common ancestor at slot 346829\r\n2020-09-21 17:15:37.386+00:00 | validator-async-1770 | INFO  | teku-validator-log | Validator   *** Published attestation  Count: 1, Slot: 346833, Root: b3dfea..2fdd\r\n2020-09-21 17:16:43.013+00:00 | beaconchain-async-272 | INFO  | StateGenerator | Regenerate state for block 0x4aea9602e72a2f0f5f123ba3da3ecd292fefa7e8aa9676fe40064c0734623088 by replaying 1 blocks\r\n2020-09-21 17:16:43.031+00:00 | beaconchain-async-272 | INFO  | StateGenerator | Completed regeneration of block 0x4aea9602e72a2f0f5f123ba3da3ecd292fefa7e8aa9676fe40064c0734623088 at slot 346784 by replaying 1 blocks. Took 18ms\r\n2020-09-21 17:17:09.064+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 346832, Head slot: 346845, Connected peers: 74\r\n2020-09-21 17:17:25.583+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 346833, Head slot: 346847, Connected peers: 74\r\n2020-09-21 17:19:04.419+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 10837 (0x4aea9602e72a2f0f5f123ba3da3ecd292fefa7e8aa9676fe40064c0734623088) but now 10838 (0x786d9f47a75b04b984ff26283f311df6740ce2a67754e7ba66b49a700f2d00b3)\r\n2020-09-21 17:19:04.421+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 346834, Head slot: 346848, Connected peers: 74\r\n```\r\n\r\n### Current behavior\r\nAfter upgrading to\r\n2020-09-22 16:42:47.905+00:00 | main | INFO  | teku-status-log | Teku version: teku/v0.12.7-dev-9b0402d7/linux-x86_64/oracle_openjdk-java-14\r\n\r\nThe node seems to be syncing with Current slot > Head slot. Hopefully it will get in sync. Latest logs right now:\r\n```\r\n2020-09-22 17:08:13.085+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354007, Head slot: 353530, Connected peers: 73\r\n2020-09-22 17:08:27.803+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354008, Head slot: 353531, Connected peers: 73\r\n2020-09-22 17:08:37.052+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354009, Head slot: 353532, Connected peers: 74\r\n2020-09-22 17:08:46.456+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354010, Head slot: 353533, Connected peers: 73\r\n2020-09-22 17:08:56.564+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354011, Head slot: 353534, Connected peers: 73\r\n2020-09-22 17:09:09.613+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354012, Head slot: 353535, Connected peers: 73\r\n2020-09-22 17:12:02.767+00:00 | beaconchain-async-4 | INFO  | StateGenerator | Regenerate state for block 0xd537cd4c9ecbb58ee8364604598e6049bf337954245727d88c3ff221517dd08d by replaying 1 blocks\r\n2020-09-22 17:12:02.783+00:00 | beaconchain-async-4 | INFO  | StateGenerator | Completed regeneration of block 0xd537cd4c9ecbb58ee8364604598e6049bf337954245727d88c3ff221517dd08d at slot 353472 by replaying 1 blocks. Took 15ms\r\n2020-09-22 17:14:32.387+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 11046 (0xd537cd4c9ecbb58ee8364604598e6049bf337954245727d88c3ff221517dd08d) but now 11047 (0x9c048b446d06923c33e9b9135ed4c25fbfcde4f0bfd4174f6690d4f42b189f40)\r\n2020-09-22 17:14:32.390+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354013, Head slot: 353535, Connected peers: 73\r\n```\r\n\r\n",
  "closed_by": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/2833/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/698465440",
    "html_url": "https://github.com/ConsenSys/teku/issues/2833#issuecomment-698465440",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833",
    "id": 698465440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODQ2NTQ0MA==",
    "user": {
      "login": "JaimeGomezGarcia",
      "id": 35458562,
      "node_id": "MDQ6VXNlcjM1NDU4NTYy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35458562?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JaimeGomezGarcia",
      "html_url": "https://github.com/JaimeGomezGarcia",
      "followers_url": "https://api.github.com/users/JaimeGomezGarcia/followers",
      "following_url": "https://api.github.com/users/JaimeGomezGarcia/following{/other_user}",
      "gists_url": "https://api.github.com/users/JaimeGomezGarcia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JaimeGomezGarcia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JaimeGomezGarcia/subscriptions",
      "organizations_url": "https://api.github.com/users/JaimeGomezGarcia/orgs",
      "repos_url": "https://api.github.com/users/JaimeGomezGarcia/repos",
      "events_url": "https://api.github.com/users/JaimeGomezGarcia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JaimeGomezGarcia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T16:54:59Z",
    "updated_at": "2020-09-24T16:54:59Z",
    "author_association": "NONE",
    "body": "Few hours after upgrading the node, the same situation ahppened again. I'll copy down here the moment when Head slot started to be greater than current slot.\r\nI guess this is probably something wrong in the DB. Will upgrade again and maybe launch a sync from scratch if it continues failing.\r\n```\r\n2020-09-22 20:09:30.113+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354354, Head slot: 354351, Connected peers: 72\r\n2020-09-22 20:09:45.159+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354355, Head slot: 354352, Connected peers: 72\r\n2020-09-22 20:09:55.623+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354356, Head slot: 354353, Connected peers: 73\r\n2020-09-22 20:10:10.505+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354357, Head slot: 354354, Connected peers: 73\r\n2020-09-22 20:10:25.836+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354358, Head slot: 354355, Connected peers: 73\r\n2020-09-22 20:10:39.926+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354359, Head slot: 354356, Connected peers: 73\r\n2020-09-22 20:10:45.330+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354360, Head slot: 354357, Connected peers: 73\r\n2020-09-22 20:10:50.716+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354361, Head slot: 354359, Connected peers: 73\r\n2020-09-22 20:10:56.428+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354362, Head slot: 354360, Connected peers: 73\r\n2020-09-22 20:11:01.880+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354363, Head slot: 354362, Connected peers: 73\r\n2020-09-22 20:11:07.388+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354364, Head slot: 354363, Connected peers: 73\r\n2020-09-22 20:11:12.835+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354365, Head slot: 354364, Connected peers: 73\r\n2020-09-22 20:11:19.756+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354366, Head slot: 354365, Connected peers: 73\r\n2020-09-22 20:11:28.927+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354367, Head slot: 354366, Connected peers: 73\r\n2020-09-22 20:11:34.239+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354368, Head slot: 354367, Connected peers: 73\r\n2020-09-22 20:13:34.837+00:00 | beaconchain-async-45 | INFO  | StateGenerator | Regenerate state for block 0x4cc1e418b7f8ec6ba1d96f7bff9dc49abadd1ee3986c1f66a51e4f08f38dd9ac by replaying 1 blocks\r\n2020-09-22 20:13:34.848+00:00 | beaconchain-async-45 | INFO  | StateGenerator | Completed regeneration of block 0x4cc1e418b7f8ec6ba1d96f7bff9dc49abadd1ee3986c1f66a51e4f08f38dd9ac at slot 354304 by replaying 1\r\nblocks. Took 10ms\r\n2020-09-22 20:15:29.750+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 11072 (0x4cc1e418b7f8ec6ba1d96f7bff9dc49ab\r\nadd1ee3986c1f66a51e4f08f38dd9ac) but now 11073 (0x8da4555b1446491aa47911eca603f25d1d5c11d4e0cfb7ccc55e7607deb97c0e)\r\n2020-09-22 20:15:29.752+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354369, Head slot: 354367, Connected peers: 74\r\n2020-09-22 20:17:32.998+00:00 | p2p-async-7 | ERROR | SyncManager | Error during sync to peer Eth2Peer{id=16Uiu2HAmAimMTZZHM9m6M2DEU1R2Szs9R5FQ1toyvkRpCzTx9zcg, remoteStatus=Optional[PeerStatus{forkDigest=0xe7\r\na75d5a, finalizedRoot=0x23d1ca69553f75093351d5f5610ce17b37c337c5e13239dcf4d06bdea68f0bef, finalizedEpoch=11091, headRoot=0x9dc4c3df7822ebf37114d35cc02c251ccf6f21c7bc164f35bf4b11dded52ad92, headSlot=354979}]}\r\njava.util.concurrent.CompletionException: tech.pegasys.teku.networking.eth2.rpc.core.RpcTimeouts$RpcTimeoutException: Rpc request timed out after 5 sec: Timed out waiting for initial response\r\n        at java.util.concurrent.CompletableFuture.encodeRelay(CompletableFuture.java:367) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.completeRelay(CompletableFuture.java:376) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture$UniRelay.tryFire(CompletableFuture.java:1093) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2152) ~[?:?]\r\n        at tech.pegasys.teku.networking.eth2.rpc.core.ResponseStreamImpl.completeWithError(ResponseStreamImpl.java:79) ~[teku-networking-eth2-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.networking.eth2.rpc.core.Eth2OutgoingRequestHandler.lambda$cancelRequest$2(Eth2OutgoingRequestHandler.java:173) ~[teku-networking-eth2-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$always$14(SafeFuture.java:240) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$finish$18(SafeFuture.java:258) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at java.util.concurrent.CompletableFuture.uniHandle(CompletableFuture.java:930) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.uniHandleStage(CompletableFuture.java:946) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.handle(CompletableFuture.java:2330) ~[?:?]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.handle(SafeFuture.java:426) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.finish(SafeFuture.java:253) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.always(SafeFuture.java:240) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.networking.eth2.rpc.core.Eth2OutgoingRequestHandler.cancelRequest(Eth2OutgoingRequestHandler.java:173) ~[teku-networking-eth2-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.networking.eth2.rpc.core.Eth2OutgoingRequestHandler.cancelRequest(Eth2OutgoingRequestHandler.java:162) ~[teku-networking-eth2-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.networking.eth2.rpc.core.Eth2OutgoingRequestHandler.lambda$ensureFirstBytesArriveWithinTimeLimit$3(Eth2OutgoingRequestHandler.java:183) ~[teku-networking-eth2-0.12.7-SNAPSHOT.jar:0\r\n.12.7-dev-9b0402d7]\r\n        at java.util.concurrent.CompletableFuture$UniAccept.tryFire(CompletableFuture.java:714) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2137) ~[?:?]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$propagateResult$2(SafeFuture.java:132) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.uniWhenCompleteStage(CompletableFuture.java:883) ~[?:?]\r\n        at java.util.concurrent.CompletableFuture.whenComplete(CompletableFuture.java:2315) ~[?:?]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.whenComplete(SafeFuture.java:466) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.whenComplete(SafeFuture.java:28) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.propagateResult(SafeFuture.java:127) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.SafeFuture.propagateTo(SafeFuture.java:216) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev-9b0402d7]\r\n        at tech.pegasys.teku.infrastructure.async.ScheduledExecutorAsyncRunner.lambda$createRunnableForAction$1(ScheduledExecutorAsyncRunner.java:119) ~[teku-infrastructure-async-0.12.7-SNAPSHOT.jar:0.12.7-dev\r\n-9b0402d7]\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130) [?:?]\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630) [?:?]\r\n        at java.lang.Thread.run(Thread.java:832) [?:?]\r\nCaused by: tech.pegasys.teku.networking.eth2.rpc.core.RpcTimeouts$RpcTimeoutException: Rpc request timed out after 5 sec: Timed out waiting for initial response\r\n        ... 16 more\r\n2020-09-22 20:18:00.881+00:00 | nioEventLoopGroup-3-2 | ERROR | RpcHandler | Unhandled error while processes req/response\r\njava.lang.NullPointerException: null\r\n2020-09-22 20:18:09.743+00:00 | beaconchain-async-43 | INFO  | StateGenerator | Regenerate state for block 0x8da4555b1446491aa47911eca603f25d1d5c11d4e0cfb7ccc55e7607deb97c0e by replaying 1 blocks\r\n2020-09-22 20:18:09.751+00:00 | beaconchain-async-43 | INFO  | StateGenerator | Completed regeneration of block 0x8da4555b1446491aa47911eca603f25d1d5c11d4e0cfb7ccc55e7607deb97c0e at slot 354336 by replaying 1\r\nblocks. Took 8ms\r\n2020-09-22 20:18:14.223+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354370, Head slot: 354399, Connected peers: 74\r\n2020-09-22 20:19:15.445+00:00 | forkchoice-0 | INFO  | ForkChoice | Skipping head block update as justified checkpoint was updated while loading checkpoint state. Was 11073 (0x8da4555b1446491aa47911eca603f25d1\r\nd5c11d4e0cfb7ccc55e7607deb97c0e) but now 11074 (0x9ececc727c677a144a5e4481a1508bd193b35a7668699d216a061caaf269a357)\r\n2020-09-22 20:19:15.445+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354371, Head slot: 354399, Connected peers: 73\r\n2020-09-22 20:19:20.485+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354372, Head slot: 354400, Connected peers: 73\r\n2020-09-22 20:19:22.442+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354373, Head slot: 354402, Connected peers: 73\r\n2020-09-22 20:19:24.151+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354374, Head slot: 354403, Connected peers: 73\r\n2020-09-22 20:19:25.882+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354375, Head slot: 354405, Connected peers: 73\r\n2020-09-22 20:19:27.468+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354376, Head slot: 354406, Connected peers: 73\r\n2020-09-22 20:19:29.460+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354377, Head slot: 354407, Connected peers: 73\r\n2020-09-22 20:19:31.592+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354378, Head slot: 354408, Connected peers: 73\r\n2020-09-22 20:19:33.173+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354379, Head slot: 354409, Connected peers: 73\r\n2020-09-22 20:19:35.069+00:00 | TimeTickChannel-0 | INFO  | teku-event-log | Sync Event  *** Current slot: 354380, Head slot: 354410, Connected peers: 73\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/698465440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/698513959",
    "html_url": "https://github.com/ConsenSys/teku/issues/2833#issuecomment-698513959",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833",
    "id": 698513959,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODUxMzk1OQ==",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T18:31:26Z",
    "updated_at": "2020-09-24T18:32:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Transposing this here from Discord, pending review from a proper dev ðŸ˜ƒ\r\n\r\n> What I suspect is that your Synology box is struggling to keep up. The sync is very slow (~1 block/s) and the processing required seems to have corrupted the time synchronisation: It looks like your timezone is GMT+2, right? My clock is GMT, and I see this `18:19:36.622 INFO  - Slot Event  *** Slot: 354397`, whereas your reported current slot is at 354380 at your 20:19:35: That is, 17 slots adrift from mine (~200 seconds). The CPUs in these NAS boxes are pretty low power and it may not be sufficient for the task. Do you know the actual processor spec?\r\n\r\nAlso upping the severity to P3 since this is repeatable.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/698513959/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/702661499",
    "html_url": "https://github.com/ConsenSys/teku/issues/2833#issuecomment-702661499",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/2833",
    "id": 702661499,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjY2MTQ5OQ==",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T10:45:41Z",
    "updated_at": "2020-10-02T10:45:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Adding my comments from Discord, and closing as I think we can't do much about this. In summary, it seems that the processor is not powerful enough to keep up while running Teku. It might be worth revising as we continue to make performance improvements, but it looks like there is no specific bug we can fix rigt now.\r\n\r\n> This is very crude, but comparing my CPU with yours: https://www.cpubenchmark.net/compare/Intel-Celeron-J3355-vs-Intel-i5-9500/2960vs3444 - my CPU mark is about 8x yours, and I am running at an average of about 24% of capacity (1.43 cores out of 6). On that basis you'd need about double the performance that you have in order to keep up efficiently :disappointed: As I say, it's a crude measure, and probably not quite so bad in practice, but confirms my suspicions about the cause. For running on the NAS, it might be interesting to look at Nimbus which is specifically aimed at lower power devices. We're continually improving Teku's performance, but 2x might be beyond reach for a while.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/702661499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
