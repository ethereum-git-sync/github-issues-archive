{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/3557",
  "id": 804023236,
  "node_id": "MDU6SXNzdWU4MDQwMjMyMzY=",
  "number": 3557,
  "title": "Make gossip scoring information visible to users",
  "user": {
    "login": "mbaxter",
    "id": 658601,
    "node_id": "MDQ6VXNlcjY1ODYwMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mbaxter",
    "html_url": "https://github.com/mbaxter",
    "followers_url": "https://api.github.com/users/mbaxter/followers",
    "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
    "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
    "organizations_url": "https://api.github.com/users/mbaxter/orgs",
    "repos_url": "https://api.github.com/users/mbaxter/repos",
    "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mbaxter/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2021-02-08T22:30:59Z",
  "updated_at": "2021-04-28T20:19:21Z",
  "closed_at": "2021-04-28T20:19:21Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\nFollowing up on #3457, we should make gossip scoring visible in some way.  A few ideas:\r\n* Have a REST API endpoint where we can pull peer info, where each peer has scoring information available\r\n* Look into whether or not there is any way to expose scoring over metrics:\r\n  * Maybe we could have a histogram where we periodically add peer scores?\r\n\r\nThis will make it easier to test and validate that scoring is working how we expect.\r\n",
  "closed_by": {
    "login": "mbaxter",
    "id": 658601,
    "node_id": "MDQ6VXNlcjY1ODYwMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mbaxter",
    "html_url": "https://github.com/mbaxter",
    "followers_url": "https://api.github.com/users/mbaxter/followers",
    "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
    "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
    "organizations_url": "https://api.github.com/users/mbaxter/orgs",
    "repos_url": "https://api.github.com/users/mbaxter/repos",
    "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mbaxter/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/3557/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/815616897",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-815616897",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 815616897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTYxNjg5Nw==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-08T09:42:03Z",
    "updated_at": "2021-04-08T09:49:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi!\r\n\r\nI was thinking about working on this issue. I can see that `GetPeers` class exposes a REST endpoint `/eth/v1/node/peers` for retrieving the list of peers. Perhaps I can add a new similar REST endpoint, `/eth/v1/node/peers/gossip-scoring`, returning a map peerId (String) -> gossipScore (Double).\r\n\r\nTo use libp2p in order to compute gossip scoring for a peer, I can use something similar to [this](https://github.com/Nashatyrev/jvm-libp2p-minimal/blob/0.8.0/src/test/kotlin/io/libp2p/pubsub/gossip/GossipScoreTest.kt) : \r\n\r\n```\r\n        val peer = mockPeer()\r\n\r\n        val peerScoreParams = GossipPeerScoreParams(\r\n            decayInterval = 1.seconds,\r\n            behaviourPenaltyWeight = -1.0,\r\n            behaviourPenaltyDecay = 0.9,\r\n            behaviourPenaltyThreshold = 5.0\r\n        )\r\n        val scoreParams = GossipScoreParams(peerScoreParams)\r\n        val timeController = TimeControllerImpl()\r\n        val executor = ControlledExecutorServiceImpl(timeController)\r\n\r\n        val score = GossipScore(scoreParams, executor, { timeController.time })\r\n```\r\n\r\nIs this a solid plan?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/815616897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816266274",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-816266274",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 816266274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjI2NjI3NA==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-08T22:16:41Z",
    "updated_at": "2021-04-08T22:16:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hello @BogdanStirbat! ðŸ‘‹ \r\n\r\nI think the first step in getting this implemented will involve actually exposing the [peer scores from jvm-libp2p](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/src/main/kotlin/io/libp2p/pubsub/gossip/GossipScore.kt#L135). \r\n One option would be to add a method for getting a peer score by peer id to the [Gossip class](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/src/main/kotlin/io/libp2p/pubsub/gossip/Gossip.kt#L23) (`GossipScore` being available at `router.score`).",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816266274/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816884902",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-816884902",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 816884902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjg4NDkwMg==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T18:43:12Z",
    "updated_at": "2021-04-09T18:43:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @mbaxter ,\r\n\r\nThank you for the explanation! I will add a method to get a peer score by `PeerId` in the [Gossip class](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/src/main/kotlin/io/libp2p/pubsub/gossip/Gossip.kt#L23) . To get a `PeerId` from a `peer`, can I use `new PeerId(peer.peerId.getBytes())`? \r\n\r\nAlso, I've noticed that the libp2p version used in Teku is `io.libp2p:jvm-libp2p-minimal:0.8.1-RELEASE`. I should push the changes to [jvm-libp2p](https://github.com/libp2p/jvm-libp2p/), master, so that they will part of next release, right?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816884902/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816928070",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-816928070",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 816928070,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjkyODA3MA==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T19:45:40Z",
    "updated_at": "2021-04-09T19:46:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Thank you for the explanation! I will add a method to get a peer score by `PeerId` in the [Gossip class](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/src/main/kotlin/io/libp2p/pubsub/gossip/Gossip.kt#L23) . To get a `PeerId` from a `peer`, can I use `new PeerId(peer.peerId.getBytes())`?\r\n\r\nNp!  You can just do `peer.peerId`: [example](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/src/main/kotlin/io/libp2p/pubsub/gossip/GossipScore.kt#L146)\r\n\r\n> Also, I've noticed that the libp2p version used in Teku is `io.libp2p:jvm-libp2p-minimal:0.8.1-RELEASE`. I should push the changes to [jvm-libp2p](https://github.com/libp2p/jvm-libp2p/), master, so that they will part of next release, right?\r\n \r\nYep, that's the right repo.  You'll want to fork that repo, and create a branch of off `develop`.  The changes from `develop` are periodically bundled up and merged to `master` when we do releases.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/816928070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/817141713",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-817141713",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 817141713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzE0MTcxMw==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-10T14:03:47Z",
    "updated_at": "2021-04-10T14:03:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "I understand. Thank you! I added a [pull request](https://github.com/libp2p/jvm-libp2p/pull/188) for retrieving peer score by peerId. After the changes will reach `master` and next jvm-libp2p version, I will continue working on this issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/817141713/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820506785",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-820506785",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 820506785,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDUwNjc4NQ==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T15:10:40Z",
    "updated_at": "2021-04-15T15:10:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "@BogdanStirbat - thanks for the jvm-libp2p contribution!  If you want to go ahead with the teku implementation without waiting for the jvm-libp2p release, you can run against the jvm-libp2p `develop` branch by following these steps:\r\n* From the jvm-libp2p side:\r\n  * Bump up the jvm-libp2p version [here](https://github.com/libp2p/jvm-libp2p/blob/6cac516d2ea5f75d96dcc4f0167ff0affd94fd6f/build.gradle.kts#L15)\r\n  * Run `./gradlew publishToMavenLocal` to make your local build available to teku\r\n* From teku:\r\n  * Update the jvm-libp2p version to match your local build [here](https://github.com/ConsenSys/teku/blob/9c0086ca5af0f90eddc26ca437475adfa7afc914/gradle/versions.gradle#L41)\r\n  * Rebuild teku\r\n\r\nHope that makes sense - let me know if you have any questions!",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820506785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820514036",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-820514036",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 820514036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDUxNDAzNg==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T15:20:37Z",
    "updated_at": "2021-04-15T15:20:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I was thinking about working on this issue. I can see that `GetPeers` class exposes a REST endpoint `/eth/v1/node/peers` for retrieving the list of peers. Perhaps I can add a new similar REST endpoint, `/eth/v1/node/peers/gossip-scoring`, returning a map peerId (String) -> gossipScore (Double).\r\n\r\nI'd add the new scoring endpoint as a [teku-specific handler](https://github.com/ConsenSys/teku/tree/9c0086ca5af0f90eddc26ca437475adfa7afc914/data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/handlers/tekuv1) at something like `/teku/v1/nodes/peer_scores`.  And I'd probably have it return a list of `PeerScores` where each `PeerScore` has a `peer_id` and a `gossip_score`. ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820514036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820628563",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-820628563",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 820628563,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDYyODU2Mw==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T18:08:05Z",
    "updated_at": "2021-04-15T18:08:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mbaxter - thank you for reviewing the pull request, and for the explanations, as well!\r\n\r\nYes, I understand how I can go ahead with the teku implementation without waiting for a new jvm-libp2p release.\r\n\r\nI understand, I will add a new handler. The list of peers will be retrieved from a `NetworkDataProvider network`, and `NetworkDataProvider network` will be injected via construction injection, like in [GetPeers](https://github.com/ConsenSys/teku/blob/9c0086ca5af0f90eddc26ca437475adfa7afc914/data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/handlers/v1/node/GetPeers.java) handler, right?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820628563/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820636214",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-820636214",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 820636214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDYzNjIxNA==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T18:19:55Z",
    "updated_at": "2021-04-15T18:19:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I understand, I will add a new handler. The list of peers will be retrieved from a `NetworkDataProvider network`, and `NetworkDataProvider network` will be injected via construction injection, like in [GetPeers](https://github.com/ConsenSys/teku/blob/9c0086ca5af0f90eddc26ca437475adfa7afc914/data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/handlers/v1/node/GetPeers.java) handler, right?\r\n\r\nYep, sounds right!",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820636214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820748092",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-820748092",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 820748092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDc0ODA5Mg==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T21:40:21Z",
    "updated_at": "2021-04-15T21:40:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you!\r\n\r\nI'm having difficulties injecting [Gossip](https://github.com/libp2p/jvm-libp2p/blob/develop/src/main/kotlin/io/libp2p/pubsub/gossip/Gossip.kt) into a handler (like [GetSszState](https://github.com/ConsenSys/teku/blob/9c0086ca5af0f90eddc26ca437475adfa7afc914/data/beaconrestapi/src/main/java/tech/pegasys/teku/beaconrestapi/handlers/tekuv1/beacon/GetSszState.java) for example). Should this be done through a provider?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/820748092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/821255518",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-821255518",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 821255518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTI1NTUxOA==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T15:26:42Z",
    "updated_at": "2021-04-16T15:26:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "The Gossip instance is available [here](https://github.com/ConsenSys/teku/blob/d87b37a47bacea9a72cc1106e822f343988b3304/networking/p2p/src/main/java/tech/pegasys/teku/networking/p2p/libp2p/gossip/LibP2PGossipNetwork.java#L159).  I'd suggest exposing a method `getGossipScore()` on the [Peer](https://github.com/ConsenSys/teku/blob/d87b37a47bacea9a72cc1106e822f343988b3304/networking/p2p/src/main/java/tech/pegasys/teku/networking/p2p/peer/Peer.java#L26) interface.  The lowest level peers are constructed in [`PeerManager`](https://github.com/ConsenSys/teku/blob/d87b37a47bacea9a72cc1106e822f343988b3304/networking/p2p/src/main/java/tech/pegasys/teku/networking/p2p/libp2p/PeerManager.java#L72).  You should be able to inject that `Gossip` object into `PeerManager`, which will allow you to inject the scoring functionality into `LibP2PPeer`.  Then, you can grab your peers from the `NetworkDataProvider` just like `GetPeers`, and print out the scoring values you get from `peer.getGossipScore()`.  Does that make sense?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/821255518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/821516898",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-821516898",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 821516898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTUxNjg5OA==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T19:32:20Z",
    "updated_at": "2021-04-16T19:32:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, it does, thank you! I will continue working, and I will inform you if I find other difficulties. I think that it's best to commit after the new version of libp2p is released, so that build will pass.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/821516898/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/822809619",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-822809619",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 822809619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMjgwOTYxOQ==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-19T21:50:16Z",
    "updated_at": "2021-04-19T21:50:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @BogdanStirbat - If you wouldn't mind, it would be great if you could put up a draft PR of your work before we do the jvm-libp2p release.  As a general matter of process, that tends to work better so that if we need to make any adjustments on the jvm-libp2p side we don't end up with multiple releases making small tweaks.  \r\n\r\nIt is unfortunate that CI won't pass for now, but you can just leave a note in the PR description explaining that the work depends on a jvm-libp2p release.  We were just discussing how to improve this process - hopefully we can get this streamlined soon!  ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/822809619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/823040641",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-823040641",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 823040641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzA0MDY0MQ==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T07:21:01Z",
    "updated_at": "2021-04-20T07:21:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "I understand. Sure, no problem!",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/823040641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/823624716",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-823624716",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 823624716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzYyNDcxNg==",
    "user": {
      "login": "BogdanStirbat",
      "id": 2213741,
      "node_id": "MDQ6VXNlcjIyMTM3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2213741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BogdanStirbat",
      "html_url": "https://github.com/BogdanStirbat",
      "followers_url": "https://api.github.com/users/BogdanStirbat/followers",
      "following_url": "https://api.github.com/users/BogdanStirbat/following{/other_user}",
      "gists_url": "https://api.github.com/users/BogdanStirbat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BogdanStirbat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BogdanStirbat/subscriptions",
      "organizations_url": "https://api.github.com/users/BogdanStirbat/orgs",
      "repos_url": "https://api.github.com/users/BogdanStirbat/repos",
      "events_url": "https://api.github.com/users/BogdanStirbat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BogdanStirbat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T21:54:18Z",
    "updated_at": "2021-04-20T21:54:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've added a draft PR: https://github.com/ConsenSys/teku/pull/3885 ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/823624716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/824968890",
    "html_url": "https://github.com/ConsenSys/teku/issues/3557#issuecomment-824968890",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3557",
    "id": 824968890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDk2ODg5MA==",
    "user": {
      "login": "mbaxter",
      "id": 658601,
      "node_id": "MDQ6VXNlcjY1ODYwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/658601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mbaxter",
      "html_url": "https://github.com/mbaxter",
      "followers_url": "https://api.github.com/users/mbaxter/followers",
      "following_url": "https://api.github.com/users/mbaxter/following{/other_user}",
      "gists_url": "https://api.github.com/users/mbaxter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mbaxter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mbaxter/subscriptions",
      "organizations_url": "https://api.github.com/users/mbaxter/orgs",
      "repos_url": "https://api.github.com/users/mbaxter/repos",
      "events_url": "https://api.github.com/users/mbaxter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mbaxter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-22T15:58:46Z",
    "updated_at": "2021-04-22T15:58:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @BogdanStirbat - looks great! ðŸŽ‰ I'll try to do a proper review today and get a jvm-libp2p release out!",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/824968890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
