{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5953",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5953",
  "id": 1311410253,
  "node_id": "I_kwDOCM9I9M5OKohN",
  "number": 5953,
  "title": "Receipt not available",
  "user": {
    "login": "come-maiz",
    "id": 617831,
    "node_id": "MDQ6VXNlcjYxNzgzMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/617831?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/come-maiz",
    "html_url": "https://github.com/come-maiz",
    "followers_url": "https://api.github.com/users/come-maiz/followers",
    "following_url": "https://api.github.com/users/come-maiz/following{/other_user}",
    "gists_url": "https://api.github.com/users/come-maiz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/come-maiz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/come-maiz/subscriptions",
    "organizations_url": "https://api.github.com/users/come-maiz/orgs",
    "repos_url": "https://api.github.com/users/come-maiz/repos",
    "events_url": "https://api.github.com/users/come-maiz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/come-maiz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-07-20T16:01:10Z",
  "updated_at": "2022-07-21T04:17:08Z",
  "closed_at": "2022-07-20T23:45:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\nI'm testing teku + nethermind + mev-boost in kiln following this guide:\r\nhttps://github.com/flashbots/mev-boost/wiki/Testing/517aa17d3f05bc4bd3d7985a630e9b41a510b4fd\r\n\r\nSometimes, this trace appear:\r\n\r\n```\r\n2022-07-20 14:51:36.655 INFO  - Syncing     *** Target slot: 943433, Head slot: 199743, Remaining slots: 743690, Connected peers: 21\r\n2022-07-20 14:51:50.024 INFO  - Syncing     *** Target slot: 943434, Head slot: 199799, Remaining slots: 743635, Connected peers: 23\r\n2022-07-20 14:52:00.740 INFO  - Syncing     *** Target slot: 943435, Head slot: 199845, Remaining slots: 743590, Connected peers: 22\r\n2022-07-20 14:52:09.514 WARN  - Retrying with next eth1 endpoint                                                                                                            \r\njava.util.concurrent.CompletionException: tech.pegasys.teku.beacon.pow.exception.RejectedRequestException: -32001: Receipt not available for 'From' block '215037'.\r\nat java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:314) ~[?:?]                                        \r\nat java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:319) ~[?:?]                                      \r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:645) ~[?:?]                                       \r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506) ~[?:?]                                                                                   at java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073) ~[?:?] \r\nat tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$propagateResult$3(SafeFuture.java:147) ~[teku-infrastructure-async-develop.jar:22.6.1+72-g2b6c1c1]              at java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837) ~[?:?]                                \r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2073) ~[?:?] \r\nat org.web3j.utils.Async.lambda$run$1(Async.java:38) ~[core-4.9.3.jar:?]\r\nat java.util.concurrent.CompletableFuture$AsyncRun.run(CompletableFuture.java:1736) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) ~[?:?]\r\nat java.lang.Thread.run(Thread.java:829) ~[?:?]\r\nCaused by: tech.pegasys.teku.beacon.pow.exception.RejectedRequestException: -32001: Receipt not available for 'From' block '215037'.\r\nat tech.pegasys.teku.beacon.pow.Web3jEth1Provider.lambda$sendAsync$6(Web3jEth1Provider.java:151) ~[teku-beacon-pow-develop.jar:22.6.1+72-g2b6c1c1]\r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:642) ~[?:?]\r\n... 12 more\r\n2022-07-20 14:52:09.536 WARN  - Request for eth1 deposit logs from 10000 blocks failed. Retrying with a smaller block range.\r\n2022-07-20 14:52:12.456 INFO  - Syncing     *** Target slot: 943436, Head slot: 199901, Remaining slots: 743535, Connected peers: 22\r\n2022-07-20 14:52:24.606 INFO  - Syncing     *** Target slot: 943437, Head slot: 199967, Remaining slots: 743470, Connected peers: 22\r\n2022-07-20 14:52:36.807 INFO  - Syncing     *** Target slot: 943438, Head slot: 200013, Remaining slots: 743425, Connected peers: 23\r\n2022-07-20 14:52:48.863 INFO  - Syncing     *** Target slot: 943439, Head slot: 200069, Remaining slots: 743370, Connected peers: 25\r\n```\r\n\r\nIt doesn't seem to stop syncing or to affect anything so far.\r\n\r\n### Steps to Reproduce (Bug)\r\n\r\nFollow the steps in https://github.com/flashbots/mev-boost/wiki/Testing/517aa17d3f05bc4bd3d7985a630e9b41a510b4fd\r\n\r\n**Expected behavior:**\r\n\r\nTeku starts proposing blocks served by mev-boost.\r\n\r\n**Actual behavior:** \r\n\r\nAn error trace appears in the logs. Sync is still ongoing, so things seem to be going well.\r\n\r\n**Frequency:**\r\n\r\nIt happens for some blocks. I see 146527, 148124, 148328, 148747, 149424, 149795, 149960, 150476, 150723, 151226, 152151, 152923, 152996, 153125, 153526, 153670, 154242, 155002, 155089, 155896...\r\n\r\n### Versions (Add all that apply)\r\n* Software version: teku/v22.6.1+72-g2b6c1c1/linux-x86_64/-privatebuild-openjdk64bitservervm-java-11\r\n$ java --version\r\nopenjdk 11.0.15 2022-04-19\r\nOpenJDK Runtime Environment (build 11.0.15+10-Ubuntu-0ubuntu0.22.04.1)\r\nOpenJDK 64-Bit Server VM (build 11.0.15+10-Ubuntu-0ubuntu0.22.04.1, mixed mode, sharing)\r\n```\r\n\r\n* OS Name & Version: \r\n```\r\n$ cat /etc/*release\r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=22.04\r\nDISTRIB_CODENAME=jammy\r\nDISTRIB_DESCRIPTION=\"Ubuntu 22.04 LTS\"\r\nPRETTY_NAME=\"Ubuntu 22.04 LTS\"\r\nNAME=\"Ubuntu\"\r\nVERSION_ID=\"22.04\"\r\nVERSION=\"22.04 LTS (Jammy Jellyfish)\"\r\nVERSION_CODENAME=jammy\r\nID=ubuntu\r\nID_LIKE=debian\r\nHOME_URL=\"https://www.ubuntu.com/\"\r\nSUPPORT_URL=\"https://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\nUBUNTU_CODENAME=jammy\r\n```\r\n\r\n* Cloud VM, type, size: digital ocean",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5953/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1190878810",
    "html_url": "https://github.com/ConsenSys/teku/issues/5953#issuecomment-1190878810",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953",
    "id": 1190878810,
    "node_id": "IC_kwDOCM9I9M5G-15a",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-20T23:45:09Z",
    "updated_at": "2022-07-20T23:45:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is an error coming from Nethermind. It doesn't appear to have receipts for the requested block range and so returned an error.  Teku requires the receipts for all deposit events on the execution chain so that it can build up the Deposit Merkle tree (which is used when proposing blocks).\r\n\r\nIn this case it seems to have had a secondary eth1-endpoint specified which it fell back to using and that endpoint was able to supply the logs for those blocks so it's most likely resolved itself.  If you're continuing to see errors about these requests failing or having missing deposits, then you'll likely need to fix the Nethermind configuration to ensure it downloads all historic receipts (for kiln it would be simplest to go all the way back to genesis since the chain was new).\r\n\r\nWill close this issue for now but feel free to reach out if you have further questions etc either on our Discord or posting a response here.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1190878810/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1191019159",
    "html_url": "https://github.com/ConsenSys/teku/issues/5953#issuecomment-1191019159",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5953",
    "id": 1191019159,
    "node_id": "IC_kwDOCM9I9M5G_YKX",
    "user": {
      "login": "come-maiz",
      "id": 617831,
      "node_id": "MDQ6VXNlcjYxNzgzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/617831?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/come-maiz",
      "html_url": "https://github.com/come-maiz",
      "followers_url": "https://api.github.com/users/come-maiz/followers",
      "following_url": "https://api.github.com/users/come-maiz/following{/other_user}",
      "gists_url": "https://api.github.com/users/come-maiz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/come-maiz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/come-maiz/subscriptions",
      "organizations_url": "https://api.github.com/users/come-maiz/orgs",
      "repos_url": "https://api.github.com/users/come-maiz/repos",
      "events_url": "https://api.github.com/users/come-maiz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/come-maiz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T04:17:07Z",
    "updated_at": "2022-07-21T04:17:07Z",
    "author_association": "NONE",
    "body": "Thanks for the info. I'll check nethermind.\r\n\r\nJust, my suggestion is not to show the exception traceback but to give some pointers to check at the execution client for the missing information.\r\n\r\nI have only nethermind running, so I don't understand where that secondary endpoint came from, but I agree it seems it healed itself, or at least continued trying to sync.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1191019159/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
