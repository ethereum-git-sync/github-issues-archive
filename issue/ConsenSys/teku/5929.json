{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/5929",
  "id": 1304373867,
  "node_id": "I_kwDOCM9I9M5Nvypr",
  "number": 5929,
  "title": "Add sentry node capability",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "lucassaldanha",
    "id": 1766440,
    "node_id": "MDQ6VXNlcjE3NjY0NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lucassaldanha",
    "html_url": "https://github.com/lucassaldanha",
    "followers_url": "https://api.github.com/users/lucassaldanha/followers",
    "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
    "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
    "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
    "repos_url": "https://api.github.com/users/lucassaldanha/repos",
    "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-07-14T07:25:09Z",
  "updated_at": "2022-10-09T23:52:50Z",
  "closed_at": "2022-10-09T23:52:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Background is [here](https://hackmd.io/2KXAIkIBR9Ki_yrfRbUH4g?view#Sentry-node-approach-short-term)\n\nIn short, the IP addresses of beacon nodes can be deduced from the their attestation activity. This would allow an attacker to DDoS a node that was due to make a block proposal, in order to gain MEV or otherwise disrupt the network. Sentry nodes (Cosmos terminology [afaics](https://forum.cosmos.network/t/sentry-node-architecture-overview/454)) would only publish blocks (from a different IP) and so remain anonymous.\n\nEven shorter: the validator sends attestations via one BN, and block proposals via a different BN.\n\nI have no idea how this interacts with MEV-Boost.\n\n---\n**Changes required:**\n- [x] Read sentry node configuration file (based on format defined [here](https://hackmd.io/0jhD6wEzQLWnE3huXLkjgg#%E2%80%9CRole-centric%E2%80%9D-config))\n- [x] Support reading config from local file or URL\n- [x] Implement a new `SentryValidatorApiChannel` (name not final) that extends the `ValidatorApiChannel` and encapsulates the logic of choosing the right endpoint for each method. Possibly need a new implementation of `BeaconNodeApi`.\n- [x] Update `ValidatorClientService` to consume sentry config (when enabled) and instantiate the correct `ValidatorApiChannel` instance.\n- [x] Update cli options with new option for sentry config file\n- [x] Refactor config deserializer to use a builder\n\n**Out of scope (for now):**\n- Live reload of sentry config file\n- Minimise subnet subscriptions #6112",
  "closed_by": {
    "login": "lucassaldanha",
    "id": 1766440,
    "node_id": "MDQ6VXNlcjE3NjY0NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lucassaldanha",
    "html_url": "https://github.com/lucassaldanha",
    "followers_url": "https://api.github.com/users/lucassaldanha/followers",
    "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
    "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
    "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
    "repos_url": "https://api.github.com/users/lucassaldanha/repos",
    "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/5929/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1200708852",
    "html_url": "https://github.com/ConsenSys/teku/issues/5929#issuecomment-1200708852",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
    "id": 1200708852,
    "node_id": "IC_kwDOCM9I9M5HkVz0",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-01T05:02:20Z",
    "updated_at": "2022-08-01T05:02:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "There are quite a few options we may want to control when selecting which beacon node to use for specific activities. I've written up some thoughts at https://hackmd.io/0jhD6wEzQLWnE3huXLkjgg including a first stab at a config file that could support the required variations of configuring sentry nodes to avoid DoS attacks as well as potentially allowing us to support allocating specific beacon nodes to specific attestation subnets to avoid all nodes having to subscribe to all subnets.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1200708852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1204613191",
    "html_url": "https://github.com/ConsenSys/teku/issues/5929#issuecomment-1204613191",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
    "id": 1204613191,
    "node_id": "IC_kwDOCM9I9M5HzPBH",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-04T00:14:18Z",
    "updated_at": "2022-08-04T00:14:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "We should also consider how vouch can be configured to separate duties: https://github.com/attestantio/vouch/blob/master/docs/configuration.md\n\nAt first glance it looks roughly similar but I'm not sure of the impacts of the hierarchical nature and whether that's worth considering.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1204613191/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1223435702",
    "html_url": "https://github.com/ConsenSys/teku/issues/5929#issuecomment-1223435702",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
    "id": 1223435702,
    "node_id": "IC_kwDOCM9I9M5I7CW2",
    "user": {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T02:12:06Z",
    "updated_at": "2022-08-23T02:12:06Z",
    "author_association": "MEMBER",
    "body": "After consideration, we have agreed to proceed with what we called \"role-centric\" config. More info [here](https://hackmd.io/0jhD6wEzQLWnE3huXLkjgg#%E2%80%9CRole-centric%E2%80%9D-config).\n\nI have updated the description with a brief description of the changes required to implement this functionality.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1223435702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1226654890",
    "html_url": "https://github.com/ConsenSys/teku/issues/5929#issuecomment-1226654890",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
    "id": 1226654890,
    "node_id": "IC_kwDOCM9I9M5JHUSq",
    "user": {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T01:03:25Z",
    "updated_at": "2022-08-25T01:03:25Z",
    "author_association": "MEMBER",
    "body": "A limitation when using blinded block means that we will need to ensure that we use the same beacon node for creating and publishing blocks. \r\n\r\nSome consequences are:\r\n- Slightly less shielded as malicious actors can try to trace your node IP based on your the blocks you gossip. However, given this happens less frequent than attestations, it should be less of an issue. (and we will support having a pull of block creator/publisher nodes what should make it even harder)\r\n- When using MEV-boost, it will need to be paired with the block creator/publisher node.\r\n- Maybe people will end-up using the 2-node deployment approach, which is fully supported in our model.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1226654890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1272656586",
    "html_url": "https://github.com/ConsenSys/teku/issues/5929#issuecomment-1272656586",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/5929",
    "id": 1272656586,
    "node_id": "IC_kwDOCM9I9M5L2zLK",
    "user": {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-09T23:52:49Z",
    "updated_at": "2022-10-09T23:52:49Z",
    "author_association": "MEMBER",
    "body": "This feature has been released as experimental. Preliminary documentation on how to use it can be found here: https://github.com/ConsenSys/doc.teku/pull/397",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1272656586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
