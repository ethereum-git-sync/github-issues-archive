{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/3791",
  "id": 842182070,
  "node_id": "MDU6SXNzdWU4NDIxODIwNzA=",
  "number": 3791,
  "title": "REST API fails with process_block_header: Verify that the parent matches",
  "user": {
    "login": "astudnev",
    "id": 1385046,
    "node_id": "MDQ6VXNlcjEzODUwNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1385046?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/astudnev",
    "html_url": "https://github.com/astudnev",
    "followers_url": "https://api.github.com/users/astudnev/followers",
    "following_url": "https://api.github.com/users/astudnev/following{/other_user}",
    "gists_url": "https://api.github.com/users/astudnev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/astudnev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/astudnev/subscriptions",
    "organizations_url": "https://api.github.com/users/astudnev/orgs",
    "repos_url": "https://api.github.com/users/astudnev/repos",
    "events_url": "https://api.github.com/users/astudnev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/astudnev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2021-03-26T17:50:15Z",
  "updated_at": "2021-03-31T22:25:21Z",
  "closed_at": "2021-03-31T22:25:21Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I have the teku node running for a long time. Now it on the latest master from git. Running with options:\r\n\r\n```\r\n/home/studnev/teku/build/install/teku/bin/teku --metrics-enabled --rest-api-enabled --rest-api-docs-enabled --rest-api-interface=0.0.0.0 --rest-api-host-allowlist=* --data-storage-mode=archive\r\n```\r\n\r\n\r\nAfter accidental re-start on server power off, it seems to loose some data\r\n\r\nBecause after i make REST request:\r\n\r\n```\r\nstates/828949/committees?epoch=25904\r\n```\r\n\r\ni get the following error:\r\n\r\n```\r\n2021-03-26 17:40:18.691+00:00 | StorageQueryChannel-7 | WARN  | AbstractBlockProcessor | process_block_header: Verify that the parent matches\r\n2021-03-26 17:40:18.692+00:00 | StorageQueryChannel-7 | WARN  | StateTransition | State Transition error\r\ntech.pegasys.teku.spec.logic.common.statetransition.exceptions.BlockProcessingException: java.lang.IllegalArgumentException: process_block_header: Verify that the parent matches\r\n\tat tech.pegasys.teku.spec.logic.common.block.AbstractBlockProcessor.processBlockHeader(AbstractBlockProcessor.java:149) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:155) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.lambda$processBlock$0(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.datastructures.state.beaconstate.common.AbstractBeaconState.updated(AbstractBeaconState.java:59) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processAndValidateBlock(StateTransition.java:125) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:107) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:91) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.Spec.initiateStateTransition(Spec.java:326) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.processBlock(StreamingStateRegenerator.java:39) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) ~[?:?]\r\n\tat java.util.Iterator.forEachRemaining(Iterator.java:133) ~[?:?]\r\n\tat java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497) ~[?:?]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.regenerate(StreamingStateRegenerator.java:48) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:113) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.lambda$regenerateState$1(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.map(Optional.java:265) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:91) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:87) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.getLatestFinalizedStateAtSlotSync(ChainStorage.java:215) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.flatMap(Optional.java:294) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.lambda$getFinalizedStateByBlockRoot$16(ChainStorage.java:206) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.async.SafeFuture.of(SafeFuture.java:78) ~[teku-infrastructure-async-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.getFinalizedStateByBlockRoot(ChainStorage.java:202) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]\r\n\tat jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\r\n\tat java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]\r\n\tat tech.pegasys.teku.infrastructure.events.DirectEventDeliverer.executeMethod(DirectEventDeliverer.java:74) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.DirectEventDeliverer.deliverToWithResponse(DirectEventDeliverer.java:67) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer.lambda$deliverToWithResponse$1(AsyncEventDeliverer.java:75) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer$QueueReader.deliverNextEvent(AsyncEventDeliverer.java:117) [teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer$QueueReader.run(AsyncEventDeliverer.java:109) [teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: java.lang.IllegalArgumentException: process_block_header: Verify that the parent matches\r\n\tat com.google.common.base.Preconditions.checkArgument(Preconditions.java:142) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.spec.logic.common.block.AbstractBlockProcessor.processBlockHeader(AbstractBlockProcessor.java:126) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 52 more\r\n2021-03-26 17:40:18.703+00:00 | beaconchain-async-10 | ERROR | BeaconRestApi | Failed to process request to URL http://node1-10.ph44.leadsale.com:5051/eth/v1/beacon/states/828949/committees\r\njava.lang.RuntimeException: Error while regenerating state\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:79) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.getLatestFinalizedStateAtSlotSync(ChainStorage.java:215) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.flatMap(Optional.java:294) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.lambda$getFinalizedStateByBlockRoot$16(ChainStorage.java:206) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.async.SafeFuture.of(SafeFuture.java:78) ~[teku-infrastructure-async-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.ChainStorage.getFinalizedStateByBlockRoot(ChainStorage.java:202) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:?]\r\n\tat jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:?]\r\n\tat jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:?]\r\n\tat java.lang.reflect.Method.invoke(Method.java:566) ~[?:?]\r\n\tat tech.pegasys.teku.infrastructure.events.DirectEventDeliverer.executeMethod(DirectEventDeliverer.java:74) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.DirectEventDeliverer.deliverToWithResponse(DirectEventDeliverer.java:67) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer.lambda$deliverToWithResponse$1(AsyncEventDeliverer.java:75) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer$QueueReader.deliverNextEvent(AsyncEventDeliverer.java:117) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.infrastructure.events.AsyncEventDeliverer$QueueReader.run(AsyncEventDeliverer.java:109) ~[teku-infrastructure-events-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) [?:?]\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) [?:?]\r\n\tat java.lang.Thread.run(Thread.java:834) [?:?]\r\nCaused by: com.google.common.util.concurrent.UncheckedExecutionException: java.lang.IllegalStateException: Regenerating state failed\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2051) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 17 more\r\nCaused by: java.lang.IllegalStateException: Regenerating state failed\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.processBlock(StreamingStateRegenerator.java:41) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) ~[?:?]\r\n\tat java.util.Iterator.forEachRemaining(Iterator.java:133) ~[?:?]\r\n\tat java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497) ~[?:?]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.regenerate(StreamingStateRegenerator.java:48) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:113) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.lambda$regenerateState$1(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.map(Optional.java:265) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:91) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:87) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 17 more\r\nCaused by: tech.pegasys.teku.spec.logic.common.statetransition.exceptions.StateTransitionException: tech.pegasys.teku.spec.logic.common.statetransition.exceptions.BlockProcessingException: java.lang.IllegalArgumentException: process_block_header: Verify that the parent matches\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processAndValidateBlock(StateTransition.java:137) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:107) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:91) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.Spec.initiateStateTransition(Spec.java:326) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.processBlock(StreamingStateRegenerator.java:39) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) ~[?:?]\r\n\tat java.util.Iterator.forEachRemaining(Iterator.java:133) ~[?:?]\r\n\tat java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497) ~[?:?]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.regenerate(StreamingStateRegenerator.java:48) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:113) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.lambda$regenerateState$1(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.map(Optional.java:265) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:91) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:87) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 17 more\r\nCaused by: tech.pegasys.teku.spec.logic.common.statetransition.exceptions.BlockProcessingException: java.lang.IllegalArgumentException: process_block_header: Verify that the parent matches\r\n\tat tech.pegasys.teku.spec.logic.common.block.AbstractBlockProcessor.processBlockHeader(AbstractBlockProcessor.java:149) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:155) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.lambda$processBlock$0(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.datastructures.state.beaconstate.common.AbstractBeaconState.updated(AbstractBeaconState.java:59) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processAndValidateBlock(StateTransition.java:125) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:107) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:91) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.Spec.initiateStateTransition(Spec.java:326) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.processBlock(StreamingStateRegenerator.java:39) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) ~[?:?]\r\n\tat java.util.Iterator.forEachRemaining(Iterator.java:133) ~[?:?]\r\n\tat java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497) ~[?:?]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.regenerate(StreamingStateRegenerator.java:48) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:113) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.lambda$regenerateState$1(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.map(Optional.java:265) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:91) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:87) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 17 more\r\nCaused by: java.lang.IllegalArgumentException: process_block_header: Verify that the parent matches\r\n\tat com.google.common.base.Preconditions.checkArgument(Preconditions.java:142) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.spec.logic.common.block.AbstractBlockProcessor.processBlockHeader(AbstractBlockProcessor.java:126) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:155) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.lambda$processBlock$0(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.datastructures.state.beaconstate.common.AbstractBeaconState.updated(AbstractBeaconState.java:59) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processBlock(StateTransition.java:150) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.processAndValidateBlock(StateTransition.java:125) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:107) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.logic.common.statetransition.StateTransition.initiate(StateTransition.java:91) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.spec.Spec.initiateStateTransition(Spec.java:326) ~[teku-ethereum-spec-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.processBlock(StreamingStateRegenerator.java:39) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:195) ~[?:?]\r\n\tat java.util.Iterator.forEachRemaining(Iterator.java:133) ~[?:?]\r\n\tat java.util.Spliterators$IteratorSpliterator.forEachRemaining(Spliterators.java:1801) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:484) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:474) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp.evaluateSequential(ForEachOps.java:150) ~[?:?]\r\n\tat java.util.stream.ForEachOps$ForEachOp$OfRef.evaluateSequential(ForEachOps.java:173) ~[?:?]\r\n\tat java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234) ~[?:?]\r\n\tat java.util.stream.ReferencePipeline.forEach(ReferencePipeline.java:497) ~[?:?]\r\n\tat tech.pegasys.teku.dataproviders.generators.StreamingStateRegenerator.regenerate(StreamingStateRegenerator.java:48) ~[teku-ethereum-dataproviders-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:113) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.lambda$regenerateState$1(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat java.util.Optional.map(Optional.java:265) ~[?:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.regenerateState(FinalizedStateCache.java:97) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:91) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache$StateCacheLoader.load(FinalizedStateCache.java:87) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\tat com.google.common.cache.LocalCache$LoadingValueReference.loadFuture(LocalCache.java:3529) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.loadSync(LocalCache.java:2278) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.lockedGetOrLoad(LocalCache.java:2155) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$Segment.get(LocalCache.java:2045) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.get(LocalCache.java:3951) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3974) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4958) ~[guava-29.0-jre.jar:?]\r\n\tat com.google.common.cache.LocalCache$LocalLoadingCache.getUnchecked(LocalCache.java:4964) ~[guava-29.0-jre.jar:?]\r\n\tat tech.pegasys.teku.storage.server.state.FinalizedStateCache.getFinalizedState(FinalizedStateCache.java:74) ~[teku-storage-develop.jar:21.3.2+10-g2e4ceb5]\r\n\t... 17 more\r\n```\r\n\r\nIs there any way to fix this error on node?\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/3791/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/808414887",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-808414887",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 808414887,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwODQxNDg4Nw==",
    "user": {
      "login": "astudnev",
      "id": 1385046,
      "node_id": "MDQ6VXNlcjEzODUwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1385046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/astudnev",
      "html_url": "https://github.com/astudnev",
      "followers_url": "https://api.github.com/users/astudnev/followers",
      "following_url": "https://api.github.com/users/astudnev/following{/other_user}",
      "gists_url": "https://api.github.com/users/astudnev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/astudnev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/astudnev/subscriptions",
      "organizations_url": "https://api.github.com/users/astudnev/orgs",
      "repos_url": "https://api.github.com/users/astudnev/repos",
      "events_url": "https://api.github.com/users/astudnev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/astudnev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-26T18:01:09Z",
    "updated_at": "2021-03-26T18:26:09Z",
    "author_association": "NONE",
    "body": "Note, that later data can be read OK, .e.g\r\n\r\n```\r\n/eth/v1/beacon/states/829632/committees?epoch=25926\r\n```\r\n\r\nAs a temporary solution, any public teku REST archive node would help to cover missing data, but i have not found any... please help",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/808414887/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/808995284",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-808995284",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 808995284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwODk5NTI4NA==",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T00:44:58Z",
    "updated_at": "2021-03-29T00:44:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "is it only that you can't fetch old committees?  Are blocks still getting received and any duties being performed?\n\nfor example, is `/eth/v1/beacon/states/head/committees` able to be read?\n\nIs the request timing out or getting a 404?\n\nAre you running in archive mode or prune mode?\n\nIs there anything in the log file?\n\nCommittees aren't really needed long term, so its not a huge issue if old committees can't be retrieved, I'm just trying to determine if you're getting data that is being stored still...\n\nAs an aside, if you're offline for a long time, you may have a large gap in data, so it might need to generate a lot of states to get up to a specific point.  Generally speaking the gaps are 'expected'. We actually archive every 2048 states by default, which means to get most of the states, teku will need to generate the state from where ever it got to before the state you requested. Otherwise the storage requirements go through the roof.\n\nif you try a request like: `eth/v1/beacon/states/829632/root`, that will access the specific state, then get the root from that state. If the retrieval fails, then you're likely to get a 400 of 404 error.  In prune mode, any 'finalized' block will not be available, because finalized states are not stored in prune mode (829632 is finalized).\n\nIf you can still access `/eth/v1/beacon/states/head/root` and you're in sync, then it's most likely that you're not archiving data, and you just won't be able to access finalized states.  If the archive frequency is really high, you might be timing out, and you could consider storing more frequent states to regenerate from...\n\nDiscord may be a good place to problem shoot this further if you're continuing to experience issues, someone might be able to assist in real time.\n\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/808995284/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809033948",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-809033948",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 809033948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTAzMzk0OA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T03:08:36Z",
    "updated_at": "2021-03-29T03:08:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Given the exception and the mention of a sudden power off, I suspect this is another case of https://github.com/ConsenSys/teku/issues/3605 and the missing block happened to be required to regenerate the data.\r\n\r\nWhat version of Teku were you running when the power failure happened?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809033948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809117042",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-809117042",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 809117042,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTExNzA0Mg==",
    "user": {
      "login": "astudnev",
      "id": 1385046,
      "node_id": "MDQ6VXNlcjEzODUwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1385046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/astudnev",
      "html_url": "https://github.com/astudnev",
      "followers_url": "https://api.github.com/users/astudnev/followers",
      "following_url": "https://api.github.com/users/astudnev/following{/other_user}",
      "gists_url": "https://api.github.com/users/astudnev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/astudnev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/astudnev/subscriptions",
      "organizations_url": "https://api.github.com/users/astudnev/orgs",
      "repos_url": "https://api.github.com/users/astudnev/repos",
      "events_url": "https://api.github.com/users/astudnev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/astudnev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T06:47:33Z",
    "updated_at": "2021-03-29T07:00:44Z",
    "author_association": "NONE",
    "body": "It was running head version from somewhere end of December, not sure the revision. Power outage was not very long, may be several hours.\r\n\r\nYes, i am running --data-storage-mode=archive\r\n\r\n/eth/v1/beacon/states/head/committees ( and for later blocks ) works\r\n\r\nCalling states/828949/committees?epoch=25904\r\n\r\nreturns status HTTP code 500 with the text\r\n\r\n{\"status\":500,\"message\":\"An unexpected error occurred\"}\r\n\r\nLog attached above in the issue\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809117042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809288396",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-809288396",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 809288396,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTI4ODM5Ng==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T11:02:20Z",
    "updated_at": "2021-03-29T11:02:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry I hadn't seen the attached log but this sounds very much like the missing block issue. Historic states are only stored periodically so most slots need to be regenerated by replaying the blocks from the last available state. Of one of those blocks is missing you get this error for everything between the missing block and the next stored state. \n\nIn terms of fixing it unfortunately you'd have to resync which is definitely a pain sorry. But it does only affect that range and everything else will be accurate. \n\nIn terms of being able to query image problematic range, Infura does provide an eth2 endpoint now which is powered by teku so should give the same results. I think it's generally available now just by signing up for a free Infura account. ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809288396/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809514861",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-809514861",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 809514861,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTUxNDg2MQ==",
    "user": {
      "login": "astudnev",
      "id": 1385046,
      "node_id": "MDQ6VXNlcjEzODUwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1385046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/astudnev",
      "html_url": "https://github.com/astudnev",
      "followers_url": "https://api.github.com/users/astudnev/followers",
      "following_url": "https://api.github.com/users/astudnev/following{/other_user}",
      "gists_url": "https://api.github.com/users/astudnev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/astudnev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/astudnev/subscriptions",
      "organizations_url": "https://api.github.com/users/astudnev/orgs",
      "repos_url": "https://api.github.com/users/astudnev/repos",
      "events_url": "https://api.github.com/users/astudnev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/astudnev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T16:14:44Z",
    "updated_at": "2021-03-29T17:21:48Z",
    "author_association": "NONE",
    "body": "Infura responds with 504\r\n\r\nhttps://XXX:YYY@eth2-beacon-mainnet.infura.io/eth/v1/beacon/states/828946/committees?epoch=25904\r\n\r\nhttps://community.infura.io/t/504-error-on-eth2-requests/2688\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809514861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809620520",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-809620520",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 809620520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTYyMDUyMA==",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T18:42:52Z",
    "updated_at": "2021-03-29T18:42:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "The lookup on Infura may just be taking too long - API queries can be intensive to process. I've optimised my own archive node for lookups rather than disk size, so the following works fine:\r\n```\r\ncurl -X GET \"http://127.0.0.1:5051/eth/v1/beacon/states/828946/committees?epoch=25904\" -H  \"accept: application/json\"\r\n```\r\n\r\nI've made [a gist](https://gist.github.com/benjaminion/dc021ffca7b83704248baefff29e94ca) of the output in case it's useful.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/809620520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810122924",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-810122924",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 810122924,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDEyMjkyNA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T10:52:09Z",
    "updated_at": "2021-03-30T10:52:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think we'll probably have to work with Infura to work out why the timeout is happening - the response from my archive node is just a few seconds locally so I'm not sure why Infura is taking so long.\r\n\r\nSo a few options to get things going again for you:\r\n\r\n1. Do a full resync - this will fix the missing block and let you query everything again. Downside is it does take a fair bit of time. If you do this I'd recommend setting `--Xdata-storage-create-db-version leveldb2` to use the combined LevelDB database. This will likely become the default in the future - it uses a fair bit less RAM than the existing RocksDB implementation and stores finalised and non-finalised data in the one database so you can't wind up with the missing block problem you have now.\r\n2. I'm happy to walk through a bunch of epochs to grab all the committees if that's all you need and can put them in a gist somewhere. Ben's provided the output for the one epoch you've mentioned above already but I'm happy to grab more if needed.\r\n3. I can provide a tarball of a fairly up to date archive node you could download to get you resync'd faster. Downside is it's going to be 7-8Gb.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810122924/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810124076",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-810124076",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 810124076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDEyNDA3Ng==",
    "user": {
      "login": "astudnev",
      "id": 1385046,
      "node_id": "MDQ6VXNlcjEzODUwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1385046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/astudnev",
      "html_url": "https://github.com/astudnev",
      "followers_url": "https://api.github.com/users/astudnev/followers",
      "following_url": "https://api.github.com/users/astudnev/following{/other_user}",
      "gists_url": "https://api.github.com/users/astudnev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/astudnev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/astudnev/subscriptions",
      "organizations_url": "https://api.github.com/users/astudnev/orgs",
      "repos_url": "https://api.github.com/users/astudnev/repos",
      "events_url": "https://api.github.com/users/astudnev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/astudnev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T10:54:12Z",
    "updated_at": "2021-03-30T10:54:12Z",
    "author_association": "NONE",
    "body": "Option #3 would be perfect. Can you give it?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810124076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810135185",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-810135185",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 810135185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDEzNTE4NQ==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T11:12:43Z",
    "updated_at": "2021-03-30T11:12:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Option #3 would be perfect. Can you give it?\r\n\r\nBundling it up now.  I'm not sure how long its going to take or how much longer I can stay up waiting for it. Hopefully I can get it to you tonight but if not I'll get it sorted for you tomorrow. ",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810135185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810140148",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-810140148",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 810140148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDE0MDE0OA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T11:20:53Z",
    "updated_at": "2021-03-30T11:20:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "@astudnev Try https://teku-data-mainnet.s3.us-east-2.amazonaws.com/teku-archive-mainnet-2021-03-30.tar.bz2\r\n\r\nIt's the `beacon` subdirectory of what `--data-path` would point to.  So if you're using default paths, create `~/.local/share/teku` and expand this tarball so it becomes `~/.local/share/teku/beacon`.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/810140148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/811506022",
    "html_url": "https://github.com/ConsenSys/teku/issues/3791#issuecomment-811506022",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3791",
    "id": 811506022,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMTUwNjAyMg==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-31T22:25:21Z",
    "updated_at": "2021-03-31T22:25:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "Going to close this one as we do have #3605 tracking the same problem.  But please do yell if there's any trouble with that db or if we can help further.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/811506022/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
