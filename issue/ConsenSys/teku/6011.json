{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6011",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6011/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6011/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6011/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6011",
  "id": 1325675246,
  "node_id": "I_kwDOCM9I9M5PBDLu",
  "number": 6011,
  "title": "Flag to define headers in engine API requests",
  "user": {
    "login": "pablomendezroyo",
    "id": 41727368,
    "node_id": "MDQ6VXNlcjQxNzI3MzY4",
    "avatar_url": "https://avatars.githubusercontent.com/u/41727368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pablomendezroyo",
    "html_url": "https://github.com/pablomendezroyo",
    "followers_url": "https://api.github.com/users/pablomendezroyo/followers",
    "following_url": "https://api.github.com/users/pablomendezroyo/following{/other_user}",
    "gists_url": "https://api.github.com/users/pablomendezroyo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pablomendezroyo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pablomendezroyo/subscriptions",
    "organizations_url": "https://api.github.com/users/pablomendezroyo/orgs",
    "repos_url": "https://api.github.com/users/pablomendezroyo/repos",
    "events_url": "https://api.github.com/users/pablomendezroyo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pablomendezroyo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-08-02T10:56:52Z",
  "updated_at": "2022-08-04T01:08:30Z",
  "closed_at": "2022-08-04T01:08:30Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- \r\nBy filing an Issue, you are expected to comply with the Code of Conduct, \r\nincluding treating everyone with respect:\r\nhttps://github.com/ConsenSys/teku/blob/master/CODE-OF-CONDUCT.md\r\n\r\nNot all sections will apply to all issue types.\r\n-->\r\n\r\n### Description\r\n[Detailed description of the problem and the impact it has]\r\n\r\nWith the upcoming merge, 1 EL node cannot receive the head chain from multiple CL nodes due to subjectivity. For this reason, makes sense to look for ways to restrict the use of the engine API in the EL, so it is used by one CL at a time.\r\n\r\n### Describe the solution you'd like\r\n\r\nIn addition to the `auth-token` would be nice to add headers to the EL endpoint (`--ee-endpoint`) requests, to indicate the Host who is requesting. This could be used in conjunction with the host whitelist in Geth `--authrpc.vhosts value`, see [geth docs](https://geth.ethereum.org/docs/interface/command-line-options).\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6011/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6011/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1203375874",
    "html_url": "https://github.com/ConsenSys/teku/issues/6011#issuecomment-1203375874",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6011",
    "id": 1203375874,
    "node_id": "IC_kwDOCM9I9M5Hug8C",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-03T01:19:28Z",
    "updated_at": "2022-08-03T01:19:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm not entirely sure I see the need for this given that `auth-token` is a full authentication method which is significantly stronger than a custom header.  The Geth `--authrpc.vhosts` setting controls what domains Geth will accept requests on, not a list of suitable sources of requests.  For example if you accessed Geth via `http://geth-node.com/` you would need to add `geth-node.com` to the vhosts list or Geth would reject the request. It doesn't matter where the request comes from.\n\nThe way to ensure that only a single CL is able to update the EL is to ensure that the auth token is only known by that CL - in the same way that you'd make sure the CL is configured with the correct custom header in the proposed scheme.\n\nIf you really wanted source based permissioning, that's a feature the EL would need to support and it can determine the source of a request without custom headers by looking at the source of the TCP connection (or possibly a `X-Forwarded-For` header if there's a trusted reverse proxy being used).",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1203375874/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
