{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/772",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/772/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/772/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/772/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/772",
  "id": 466421482,
  "node_id": "MDU6SXNzdWU0NjY0MjE0ODI=",
  "number": 772,
  "title": "v0.8.0 Deposit Contract Updates",
  "user": {
    "login": "dangerousfood",
    "id": 4099038,
    "node_id": "MDQ6VXNlcjQwOTkwMzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dangerousfood",
    "html_url": "https://github.com/dangerousfood",
    "followers_url": "https://api.github.com/users/dangerousfood/followers",
    "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
    "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
    "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
    "repos_url": "https://api.github.com/users/dangerousfood/repos",
    "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "dangerousfood",
    "id": 4099038,
    "node_id": "MDQ6VXNlcjQwOTkwMzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dangerousfood",
    "html_url": "https://github.com/dangerousfood",
    "followers_url": "https://api.github.com/users/dangerousfood/followers",
    "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
    "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
    "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
    "repos_url": "https://api.github.com/users/dangerousfood/repos",
    "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "dangerousfood",
      "id": 4099038,
      "node_id": "MDQ6VXNlcjQwOTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dangerousfood",
      "html_url": "https://github.com/dangerousfood",
      "followers_url": "https://api.github.com/users/dangerousfood/followers",
      "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
      "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
      "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
      "repos_url": "https://api.github.com/users/dangerousfood/repos",
      "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-07-10T17:05:32Z",
  "updated_at": "2019-07-31T19:56:54Z",
  "closed_at": "2019-07-31T19:56:54Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "- [x] Update contract ABI\r\n\r\n- [x] Generate new DepositContract class\r\n\r\n- [x] Fix dependencies\r\n\r\nhttps://github.com/ethereum/eth2.0-specs/blob/v0.8.0/deposit_contract/contracts/validator_registration.v.py",
  "closed_by": {
    "login": "dangerousfood",
    "id": 4099038,
    "node_id": "MDQ6VXNlcjQwOTkwMzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dangerousfood",
    "html_url": "https://github.com/dangerousfood",
    "followers_url": "https://api.github.com/users/dangerousfood/followers",
    "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
    "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
    "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
    "repos_url": "https://api.github.com/users/dangerousfood/repos",
    "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/772/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/772/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/510147844",
    "html_url": "https://github.com/ConsenSys/teku/issues/772#issuecomment-510147844",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/772",
    "id": 510147844,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMDE0Nzg0NA==",
    "user": {
      "login": "dangerousfood",
      "id": 4099038,
      "node_id": "MDQ6VXNlcjQwOTkwMzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4099038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dangerousfood",
      "html_url": "https://github.com/dangerousfood",
      "followers_url": "https://api.github.com/users/dangerousfood/followers",
      "following_url": "https://api.github.com/users/dangerousfood/following{/other_user}",
      "gists_url": "https://api.github.com/users/dangerousfood/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dangerousfood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dangerousfood/subscriptions",
      "organizations_url": "https://api.github.com/users/dangerousfood/orgs",
      "repos_url": "https://api.github.com/users/dangerousfood/repos",
      "events_url": "https://api.github.com/users/dangerousfood/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dangerousfood/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-10T17:07:48Z",
    "updated_at": "2019-07-10T17:07:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "# Ethereum 2.0 Phase 0 -- Deposit Contract\r\n\r\n**Notice**: This document is a work-in-progress for researchers and implementers.\r\n\r\n## Table of contents\r\n<!-- TOC -->\r\n\r\n- [Ethereum 2.0 Phase 0 -- Deposit Contract](#ethereum-20-phase-0----deposit-contract)\r\n    - [Table of contents](#table-of-contents)\r\n    - [Introduction](#introduction)\r\n    - [Constants](#constants)\r\n        - [Contract](#contract)\r\n    - [Ethereum 1.0 deposit contract](#ethereum-10-deposit-contract)\r\n        - [`deposit` function](#deposit-function)\r\n            - [Deposit amount](#deposit-amount)\r\n            - [Withdrawal credentials](#withdrawal-credentials)\r\n            - [`DepositEvent` log](#depositevent-log)\r\n    - [Vyper code](#vyper-code)\r\n\r\n<!-- /TOC -->\r\n\r\n## Introduction\r\n\r\nThis document represents the specification for the beacon chain deposit contract, part of Ethereum 2.0 Phase 0.\r\n\r\n## Constants\r\n\r\n### Contract\r\n\r\n| Name | Value |\r\n| - | - |\r\n| `DEPOSIT_CONTRACT_ADDRESS` | **TBD** |\r\n| `DEPOSIT_CONTRACT_TREE_DEPTH` | `2**5` (= 32) |\r\n\r\n## Ethereum 1.0 deposit contract\r\n\r\nThe initial deployment phases of Ethereum 2.0 are implemented without consensus changes to Ethereum 1.0. A deposit contract at address `DEPOSIT_CONTRACT_ADDRESS` is added to Ethereum 1.0 for deposits of ETH to the beacon chain. Validator balances will be withdrawable to the shards in Phase 2 (i.e. when the EVM 2.0 is deployed and the shards have state).\r\n\r\n### `deposit` function\r\n\r\nThe deposit contract has a public `deposit` function to make deposits. It takes as arguments `pubkey: bytes[48], withdrawal_credentials: bytes[32], signature: bytes[96]` corresponding to a `DepositData` object.\r\n\r\n#### Deposit amount\r\n\r\nThe amount of ETH (rounded down to the closest Gwei) sent to the deposit contract is the deposit amount, which must be of size at least `MIN_DEPOSIT_AMOUNT` Gwei. Note that ETH consumed by the deposit contract is no longer usable on Ethereum 1.0.\r\n\r\n#### Withdrawal credentials\r\n\r\nOne of the `DepositData` fields is `withdrawal_credentials`. It is a commitment to credentials for withdrawing validator balance (e.g. to another validator, or to shards). The first byte of `withdrawal_credentials` is a version number. As of now, the only expected format is as follows:\r\n\r\n* `withdrawal_credentials[:1] == BLS_WITHDRAWAL_PREFIX`\r\n* `withdrawal_credentials[1:] == hash(withdrawal_pubkey)[1:]` where `withdrawal_pubkey` is a BLS pubkey\r\n\r\nThe private key corresponding to `withdrawal_pubkey` will be required to initiate a withdrawal. It can be stored separately until a withdrawal is required, e.g. in cold storage.\r\n\r\n#### `DepositEvent` log\r\n\r\nEvery Ethereum 1.0 deposit emits a `DepositEvent` log for consumption by the beacon chain. The deposit contract does little validation, pushing most of the validator onboarding logic to the beacon chain. In particular, the proof of possession (a BLS12-381 signature) is not verified by the deposit contract.\r\n\r\n## Vyper code\r\n\r\nThe deposit contract source code, written in Vyper, is available [here](../../deposit_contract/contracts/validator_registration.v.py).\r\n\r\n*Note*: To save on gas, the deposit contract uses a progressive Merkle root calculation algorithm that requires only O(log(n)) storage. See [here](https://github.com/ethereum/research/blob/master/beacon_chain_impl/progressive_merkle_tree.py) for a Python implementation, and [here](https://github.com/runtimeverification/verified-smart-contracts/blob/master/deposit/formal-incremental-merkle-tree-algorithm.pdf) for a formal correctness proof.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/510147844/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
