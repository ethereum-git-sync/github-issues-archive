{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6249",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6249/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6249/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6249/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6249",
  "id": 1385167581,
  "node_id": "I_kwDOCM9I9M5Sj_rd",
  "number": 6249,
  "title": "Execution Client is offline - timeout check",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "StefanBratanov",
    "id": 14827647,
    "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/StefanBratanov",
    "html_url": "https://github.com/StefanBratanov",
    "followers_url": "https://api.github.com/users/StefanBratanov/followers",
    "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
    "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
    "repos_url": "https://api.github.com/users/StefanBratanov/repos",
    "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "StefanBratanov",
      "id": 14827647,
      "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/StefanBratanov",
      "html_url": "https://github.com/StefanBratanov",
      "followers_url": "https://api.github.com/users/StefanBratanov/followers",
      "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
      "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
      "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
      "repos_url": "https://api.github.com/users/StefanBratanov/repos",
      "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-09-25T21:15:46Z",
  "updated_at": "2022-10-13T19:48:04Z",
  "closed_at": "2022-10-13T19:48:04Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Teku 22.9.1 (plus Besu 22.7.3).\r\n\r\nI am occasionally getting `Execution Client is offline` errors, very swiftly followed by `Execution Client is online`, within a few tens of milliseconds.\r\n\r\nTwo questions:\r\n\r\n1.  Do we need the stack trace here, or can we simplify?\r\n2.  Is the timeout too aggressive? My execution client is not offline, and not struggling afaik. If the timeout were, say, 0.5s longer I would never see these. What are the factors used to set the timeout?\r\n\r\n```\r\n2022-09-25 12:56:27.397 ERROR - Execution Client is offline\r\njava.util.concurrent.TimeoutException: null\r\nat java.util.concurrent.CompletableFuture$Timeout.run(CompletableFuture.java:2874) ~[?:?]\r\nat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]\r\nat java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]\r\nat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]\r\nat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\n2022-09-25 12:56:27.398 ERROR - An error occurred while querying remote transition configuration\r\njava.util.concurrent.CompletionException: java.lang.IllegalArgumentException: Invalid remote response: TimeoutException\r\nat java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:649) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]\r\nat tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$propagateResult$3(SafeFuture.java:147) ~[teku-infrastructure-async-22.9.1.jar:22.9.1]\r\nat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$Timeout.run(CompletableFuture.java:2874) ~[?:?]\r\nat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]\r\nat java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]\r\nat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]\r\nat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\nCaused by: java.lang.IllegalArgumentException: Invalid remote response: TimeoutException\r\nat com.google.common.base.Preconditions.checkArgument(Preconditions.java:220) ~[guava-31.1-jre.jar:?]\r\nat tech.pegasys.teku.ethereum.executionlayer.ExecutionLayerManagerImpl.unwrapResponseOrThrow(ExecutionLayerManagerImpl.java:504) ~[teku-ethereum-executionlayer-22.9.1.jar:22.9.1]\r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[?:?]\r\n... 14 more\r\n2022-09-25 12:56:27.426 INFO  - Execution Client is online\r\n\r\n...\r\n\r\n2022-09-25 14:42:27.499 ERROR - Execution Client is offline\r\njava.util.concurrent.TimeoutException: null\r\n...\r\n2022-09-25 14:42:27.636 INFO  - Execution Client is online\r\n\r\n...\r\n\r\n2022-09-25 19:39:27.570 ERROR - Execution Client is offline\r\njava.util.concurrent.TimeoutException: null\r\n...\r\n2022-09-25 19:39:27.987 INFO  - Execution Client is online\r\n\r\n...\r\n\r\n2022-09-25 20:52:27.583 ERROR - Execution Client is offline\r\njava.util.concurrent.TimeoutException: null\r\n...\r\n2022-09-25 20:52:28.012 INFO  - Execution Client is online\r\n```",
  "closed_by": {
    "login": "StefanBratanov",
    "id": 14827647,
    "node_id": "MDQ6VXNlcjE0ODI3NjQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827647?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/StefanBratanov",
    "html_url": "https://github.com/StefanBratanov",
    "followers_url": "https://api.github.com/users/StefanBratanov/followers",
    "following_url": "https://api.github.com/users/StefanBratanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/StefanBratanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/StefanBratanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/StefanBratanov/subscriptions",
    "organizations_url": "https://api.github.com/users/StefanBratanov/orgs",
    "repos_url": "https://api.github.com/users/StefanBratanov/repos",
    "events_url": "https://api.github.com/users/StefanBratanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/StefanBratanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6249/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6249/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1275140629",
    "html_url": "https://github.com/ConsenSys/teku/issues/6249#issuecomment-1275140629",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6249",
    "id": 1275140629,
    "node_id": "IC_kwDOCM9I9M5MARoV",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-11T18:58:45Z",
    "updated_at": "2022-10-11T18:58:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "I thought we were killing the stack trace on this one per #6253.\r\n\r\nI'm getting this with v22.10.1\r\n\r\n```\r\n2022-10-11 18:31:13.002 WARN  - Execution Client request timed out. Make sure the Execution Client is online and in sync.\r\n2022-10-11 18:31:13.002 ERROR - An error occurred while querying remote transition configuration\r\njava.util.concurrent.CompletionException: tech.pegasys.teku.ethereum.executionlayer.InvalidRemoteResponseException: Invalid remote response from the execution client: TimeoutException\r\nat java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:649) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.complete(CompletableFuture.java:2147) ~[?:?]\r\nat tech.pegasys.teku.infrastructure.async.SafeFuture.lambda$propagateResult$3(SafeFuture.java:148) ~[teku-infrastructure-async-22.10.1.jar:22.10.1]\r\nat java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:863) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:841) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:510) ~[?:?]\r\nat java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2162) ~[?:?]\r\nat java.util.concurrent.CompletableFuture$Timeout.run(CompletableFuture.java:2874) ~[?:?]\r\nat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539) ~[?:?]\r\nat java.util.concurrent.FutureTask.run(FutureTask.java:264) ~[?:?]\r\nat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136) ~[?:?]\r\nat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635) ~[?:?]\r\nat java.lang.Thread.run(Thread.java:833) ~[?:?]\r\nCaused by: tech.pegasys.teku.ethereum.executionlayer.InvalidRemoteResponseException: Invalid remote response from the execution client: TimeoutException\r\nat tech.pegasys.teku.ethereum.executionlayer.ExecutionLayerManagerImpl.unwrapResponseOrThrow(ExecutionLayerManagerImpl.java:518) ~[teku-ethereum-executionlayer-22.10.1.jar:22.10.1]\r\nat tech.pegasys.teku.ethereum.executionlayer.ExecutionLayerManagerImpl.unwrapExecutionClientResponseOrThrow(ExecutionLayerManagerImpl.java:504) ~[teku-ethereum-executionlayer-22.10.1.jar:22.10.1]\r\nat java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:646) ~[?:?]\r\n... 14 more\r\n2022-10-11 18:31:13.099 INFO  - Execution Client request succeeded after a previous failure\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1275140629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
