{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/3481",
  "id": 792849791,
  "node_id": "MDU6SXNzdWU3OTI4NDk3OTE=",
  "number": 3481,
  "title": "Teku silently crashes when adding a second validator",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-01-24T17:30:30Z",
  "updated_at": "2021-01-27T03:48:48Z",
  "closed_at": "2021-01-27T03:48:48Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Reported by Discord user `@BorisL.` Teku version `teku/v21.1.0/linux-x86_64/-privatebuild-openjdk64bitservervm-java-14`\r\n\r\nTeku has been running fine with one validator. When adding a second validator file, Teku enters a restart loop and does not output any useful crash information, even with DEBUG logging:\r\n\r\n```\r\n2021-01-24 16:03:26.547+00:00 | main | INFO  | teku-status-log | Teku version: teku/v21.1.0/linux-x86_64/-privatebuild-openjdk64bitservervm-java-14\r\n2021-01-24 16:03:26.549+00:00 | main | INFO  | teku-status-log | This software is licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this software except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n2021-01-24 16:03:26.789+00:00 | validator-async-0 | INFO  | teku-status-log | Loading 2 validator keys...\r\n2021-01-24 16:03:26.793+00:00 | main | INFO  | StdSchedulerFactory | Using default implementation for ThreadExecutor\r\n2021-01-24 16:03:26.796+00:00 | main | INFO  | SimpleThreadPool | Job execution threads will use class loader of thread: main\r\n2021-01-24 16:03:26.899+00:00 | main | INFO  | SchedulerSignalerImpl | Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\n2021-01-24 16:03:26.899+00:00 | main | INFO  | QuartzScheduler | Quartz Scheduler v.2.3.2 created.\r\n2021-01-24 16:03:26.900+00:00 | main | INFO  | RAMJobStore | RAMJobStore initialized.\r\n2021-01-24 16:03:26.901+00:00 | main | INFO  | QuartzScheduler | Scheduler meta-data: Quartz Scheduler (v2.3.2) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'\r\n  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.\r\n  NOT STARTED.\r\n  Currently in standby mode.\r\n  Number of jobs executed: 0\r\n  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.\r\n  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.\r\n\r\n2021-01-24 16:03:26.901+00:00 | main | INFO  | StdSchedulerFactory | Quartz scheduler 'DefaultQuartzScheduler' initialized from default resource file in Quartz package: 'quartz.properties'\r\n2021-01-24 16:03:26.902+00:00 | main | INFO  | StdSchedulerFactory | Quartz scheduler version: 2.3.2\r\n2021-01-24 16:03:27.858+00:00 | main | INFO  | teku-status-log | Storing beacon chain data in: /data/teku/data/beacon\r\n2021-01-24 16:03:27.864+00:00 | main | INFO  | VersionedDatabaseFactory | Beacon data directory set to: /data/teku/data/beacon\r\n2021-01-24 16:03:31.514+00:00 | main | INFO  | VersionedDatabaseFactory | Created V5 Hot database (5) at /data/teku/data/beacon/db\r\n2021-01-24 16:03:31.514+00:00 | main | INFO  | VersionedDatabaseFactory | Created V5 Finalized database (5) at /data/teku/data/beacon/archive\r\n2021-01-24 16:03:31.572+00:00 | main | DEBUG | BeaconChainController | Starting BeaconChainController\r\n2021-01-24 16:03:31.578+00:00 | main | INFO  | teku-status-log | Loading initial state from jar:file:/data/teku/lib/teku-ethereum-networks-21.1.0.jar!/tech/pegasys/teku/networks/mainnet-genesis.ssz\r\n2021-01-24 16:03:33.045+00:00 | main | INFO  | teku-status-log | Loaded initial state at epoch 0 (state root = 0x7e76880eb67bbdc86250aa578958e9d0675e64e714337855204fb5abaaf82c2b, block root = 0x4d611d5b93fdab69013a7f0a2f961caca0c853f87cfe9595fe50038163079360, block slot = 0).\r\n2021-01-24 16:03:33.064+00:00 | beaconchain-async-0 | INFO  | teku-status-log | Initializing storage\r\n2021-01-24 16:03:36.343+00:00 | beaconchain-async-1 | INFO  | teku-status-log | Storage initialization complete\r\n2021-01-24 16:03:36.350+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initStateTransition()\r\n2021-01-24 16:03:36.352+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initForkChoice()\r\n2021-01-24 16:03:36.395+00:00 | beaconchain-async-4 | INFO  | StateGenerator | Regenerate state for block 0x7bd5db03e782a54dc7f3ff3da5bb405d69f97161a036f4b65c253767262cded2 by replaying 32 blocks\r\n2021-01-24 16:03:36.399+00:00 | beaconchain-async-4 | DEBUG | AsyncChainStateGenerator | Regenerate state at 0x7bd5db03e782a54dc7f3ff3da5bb405d69f97161a036f4b65c253767262cded2, processing 32 blocks on top of slot 389920 (root: 0xa82030a707ed9d6a72ae8baa70b71db197b7713b5b12906f3ff86c3e06847ca1)\r\n2021-01-24 16:03:36.401+00:00 | beaconchain-async-4 | DEBUG | AsyncChainStateGenerator | Retrieve and process 32 blocks\r\n2021-01-24 16:03:38.758+00:00 | beaconchain-async-0 | INFO  | StateGenerator | Completed regeneration of block 0x7bd5db03e782a54dc7f3ff3da5bb405d69f97161a036f4b65c253767262cded2 at slot 389952 by replaying 32 blocks. Took 2362ms\r\n2021-01-24 16:03:38.967+00:00 | beaconchain-async-4 | INFO  | StateGenerator | Regenerate state for block 0x3e7bff9efc306561efcb9fcf2384609c0e3aa224c9a36a67fe75cd345a820340 by replaying 59 blocks\r\n2021-01-24 16:03:38.968+00:00 | beaconchain-async-4 | DEBUG | AsyncChainStateGenerator | Regenerate state at 0x3e7bff9efc306561efcb9fcf2384609c0e3aa224c9a36a67fe75cd345a820340, processing 59 blocks on top of slot 389952 (root: 0x983072c8b30b0f97ee696931be13343a748ef762ccf03e39a97eeb9a8fceef8e)\r\n2021-01-24 16:03:38.968+00:00 | beaconchain-async-4 | DEBUG | AsyncChainStateGenerator | Retrieve and process 59 blocks\r\n2021-01-24 16:03:39.642+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initBlockImporter()\r\n2021-01-24 16:03:39.643+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initCombinedChainDataClient()\r\n2021-01-24 16:03:39.645+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initAttestationPool()\r\n2021-01-24 16:03:39.648+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initAttesterSlashingPool()\r\n2021-01-24 16:03:39.650+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initProposerSlashingPool()\r\n2021-01-24 16:03:39.652+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initVoluntaryExitPool()\r\n2021-01-24 16:03:39.653+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initEth1DataCache\r\n2021-01-24 16:03:39.655+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initDepositProvider()\r\n2021-01-24 16:03:39.686+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initPendingBlocks()\r\n2021-01-24 16:03:39.687+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initBlockManager()\r\n2021-01-24 16:03:39.694+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initP2PNetwork()\r\n2021-01-24 16:03:39.696+00:00 | beaconchain-async-2 | INFO  | teku-status-log | Loading generated p2p private key from: generated-node-key\r\n2021-01-24 16:03:40.003+00:00 | beaconchain-async-2 | DEBUG | AbstractByteBuf | -Dio.netty.buffer.checkAccessible: true\r\n2021-01-24 16:03:40.003+00:00 | beaconchain-async-2 | DEBUG | AbstractByteBuf | -Dio.netty.buffer.checkBounds: true\r\n2021-01-24 16:03:40.005+00:00 | beaconchain-async-2 | DEBUG | ResourceLeakDetectorFactory | Loaded default ResourceLeakDetector: io.netty.util.ResourceLeakDetector@356ed89a\r\n2021-01-24 16:03:40.460+00:00 | beaconchain-async-2 | DEBUG | Loggers$LoggerFactory | Using Slf4j logging framework\r\n2021-01-24 16:03:40.655+00:00 | beaconchain-async-2 | INFO  | teku-status-log | PreGenesis Local ENR: <REDACTED>\r\n2021-01-24 16:03:40.657+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initSyncService()\r\n2021-01-24 16:03:40.679+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initMetrics()\r\n2021-01-24 16:03:40.682+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initAttestationTopicSubscriber\r\n2021-01-24 16:03:40.684+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initActiveValidatorTracker\r\n2021-01-24 16:03:40.687+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initPerformanceTracker()\r\n2021-01-24 16:03:40.702+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initValidatorApiHandler()\r\n2021-01-24 16:03:40.737+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initRestAPI()\r\n2021-01-24 16:03:40.874+00:00 | beaconchain-async-2 | DEBUG | log | Logging to org.apache.logging.slf4j.Log4jLogger@2c3f977 via org.eclipse.jetty.util.log.Slf4jLog\r\n2021-01-24 16:03:40.877+00:00 | beaconchain-async-2 | INFO  | log | Logging initialized @17977ms to org.eclipse.jetty.util.log.Slf4jLog\r\n2021-01-24 16:03:41.132+00:00 | beaconchain-async-1 | INFO  | StateGenerator | Completed regeneration of block 0x3e7bff9efc306561efcb9fcf2384609c0e3aa224c9a36a67fe75cd345a820340 at slot 390012 by replaying 59 blocks. Took 2164ms\r\n2021-01-24 16:03:41.149+00:00 | beaconchain-async-2 | DEBUG | BeaconChainController | BeaconChainController.initOperationsReOrgManager()\r\n2021-01-24 16:03:41.166+00:00 | SlotEventsChannel-6 | DEBUG | ActiveValidatorTracker | 0 active validators counted for epoch 12188\r\n2021-01-24 16:03:41.197+00:00 | beaconchain-async-2 | INFO  | LibP2PNetwork | Starting libp2p network...\r\n2021-01-24 16:03:41.239+00:00 | beaconchain-async-2 | DEBUG | DefaultChannelId | -Dio.netty.processId: 339923 (auto-detected)\r\n2021-01-24 16:03:41.246+00:00 | beaconchain-async-2 | DEBUG | DefaultChannelId | -Dio.netty.machineId: <REDACTED> (auto-detected)\r\n2021-01-24 16:03:41.301+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.numHeapArenas: 8\r\n2021-01-24 16:03:41.301+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.numDirectArenas: 0\r\n2021-01-24 16:03:41.303+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.pageSize: 8192\r\n2021-01-24 16:03:41.304+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.maxOrder: 11\r\n2021-01-24 16:03:41.304+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.chunkSize: 16777216\r\n2021-01-24 16:03:41.304+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.tinyCacheSize: 512\r\n2021-01-24 16:03:41.304+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.smallCacheSize: 256\r\n2021-01-24 16:03:41.305+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.normalCacheSize: 64\r\n2021-01-24 16:03:41.305+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.maxCachedBufferCapacity: 32768\r\n2021-01-24 16:03:41.305+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.cacheTrimInterval: 8192\r\n2021-01-24 16:03:41.305+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.cacheTrimIntervalMillis: 0\r\n2021-01-24 16:03:41.305+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.useCacheForAllThreads: true\r\n2021-01-24 16:03:41.307+00:00 | beaconchain-async-2 | DEBUG | PooledByteBufAllocator | -Dio.netty.allocator.maxCachedByteBuffersPerChunk: 1023\r\n2021-01-24 16:03:41.315+00:00 | beaconchain-async-2 | DEBUG | ByteBufUtil | -Dio.netty.allocator.type: pooled\r\n2021-01-24 16:03:41.315+00:00 | beaconchain-async-2 | DEBUG | ByteBufUtil | -Dio.netty.threadLocalDirectBufferSize: 0\r\n2021-01-24 16:03:41.315+00:00 | beaconchain-async-2 | DEBUG | ByteBufUtil | -Dio.netty.maxThreadLocalCharBufferSize: 16384\r\n2021-01-24 16:03:41.370+00:00 | beaconchain-async-2 | INFO  | NettyDiscoveryServerImpl | Starting discovery server on UDP port 9000\r\n2021-01-24 16:03:41.378+00:00 | nioEventLoopGroup-2-1 | INFO  | teku-status-log | Listening for connections on: /ip4/10.0.0.30/tcp/9000/p2p/<REDACTED>\r\n2021-01-24 16:03:41.693+00:00 | beaconchain-async-2 | DEBUG | SyncStateTracker | Starting sync state tracker with initial state: START_UP, target peer count: 5, startup timeout: PT2M\r\n2021-01-24 16:03:41.695+00:00 | beaconchain-async-2 | DEBUG | HistoricalBlockSyncService | Start HistoricalBlockSyncService\r\n2021-01-24 16:03:41.697+00:00 | beaconchain-async-2 | INFO  | Javalin | Starting Javalin ...\r\n2021-01-24 16:03:41.705+00:00 | beaconchain-async-1 | DEBUG | HistoricalBlockSyncService | Stop HistoricalBlockSyncService\r\n2021-01-24 16:03:41.708+00:00 | nioEventLoopGroup-4-1 | INFO  | NettyDiscoveryClientImpl | UDP discovery client started\r\n2021-01-24 16:03:41.745+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xf92b82f11af5ed0959135cde8e64b626cac4f16d05e43087224deed25d1dbd72 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.747+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xf7fa00ba76b8e33caae49ba504b81a2389a963a7c990ec722c085ec663ac2492 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.751+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xef4cf7caa876063f4b8a8d1dad0f58fe9cd0ce945abba6b85dbf31c5fac98269 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.753+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xe6e8bf5a8226432f492ae7484a2a324392dcac3b4eeaa219384708d8653ba36b from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.755+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xd9648955f9cf5313b26b049b6243a690e4afbd609339216d5199b33669a9704f from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.778+00:00 | nioEventLoopGroup-4-1 | DEBUG | Recycler | -Dio.netty.recycler.maxCapacityPerThread: 4096\r\n2021-01-24 16:03:41.778+00:00 | nioEventLoopGroup-4-1 | DEBUG | Recycler | -Dio.netty.recycler.maxSharedCapacityFactor: 2\r\n2021-01-24 16:03:41.778+00:00 | nioEventLoopGroup-4-1 | DEBUG | Recycler | -Dio.netty.recycler.linkCapacity: 16\r\n2021-01-24 16:03:41.778+00:00 | nioEventLoopGroup-4-1 | DEBUG | Recycler | -Dio.netty.recycler.ratio: 8\r\n2021-01-24 16:03:41.779+00:00 | nioEventLoopGroup-4-1 | DEBUG | Recycler | -Dio.netty.recycler.delayedQueue.ratio: 8\r\n2021-01-24 16:03:41.783+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x851bf2176004d9755b096bd56e5a1575683e0d0644d92671f06128033bd59f6f from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.785+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x191bbf49632da5393590a33d54421e79e8e5c96ade72f0ba69e1803095de6b04 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.786+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x33be033e4c249643e61970998edacab44a65fcd256aa5aefdff39662cfd21a49 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.788+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xaa87ab6db5f5a1e3cbd9d882fc2fee0524785dc97373899ab360c9944b6866bd from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.790+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x04fb09f0c1fea6f28e299ca6bf6ece102544f066839731f450fe14c98169cc2d from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.795+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x73b3df542a85283fb4633bc1239077ef31326a528d9be476b961bc9dc84ba90f from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.797+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0xd88acbbe4acf89aaef0ecb004e59f53732b3dcdc17f57a091056dfcc51954b5e from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.798+00:00 | nioEventLoopGroup-4-1 | DEBUG | NodeSession | Switching status of node 0x56b7de799cc67a8434246c4cbb1bc9b9b00999ef487b6c8534b2a3301ec43610 from INITIAL to RANDOM_PACKET_SENT\r\n2021-01-24 16:03:41.864+00:00 | nioEventLoopGroup-4-1 | DEBUG | PeerManager | Connecting to 16Uiu2HAkyxVJHd9NfNVUS2nyLvPCctBL3EpXVsPYC91Xs7d671dX\r\n2021-01-24 16:03:41.901+00:00 | nioEventLoopGroup-4-1 | DEBUG | PeerManager | Connecting to 16Uiu2HAm4ZwMrv6BsoYxXWMueGHwqtdkhDDjukd6t7Rx5zGgFUTd\r\n2021-01-24 16:03:41.907+00:00 | nioEventLoopGroup-4-1 | INFO  | teku-status-log | Local ENR: <REDACTED>\r\n2021-01-24 16:03:41.930+00:00 | beaconchain-async-2 | INFO  | Javalin | Listening on http://localhost:5051/\r\n2021-01-24 16:03:41.931+00:00 | beaconchain-async-2 | INFO  | Javalin | Javalin started in 234ms \\o/\r\n2021-01-24 16:03:51.684+00:00 | main | INFO  | teku-status-log | Teku version: teku/v21.1.0/linux-x86_64/-privatebuild-openjdk64bitservervm-java-14\r\n2021-01-24 16:03:51.686+00:00 | main | INFO  | teku-status-log | This software is licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this software except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\r\n2021-01-24 16:03:51.939+00:00 | validator-async-0 | INFO  | teku-status-log | Loading 2 validator keys...\r\n2021-01-24 16:03:52.023+00:00 | main | INFO  | StdSchedulerFactory | Using default implementation for ThreadExecutor\r\n2021-01-24 16:03:52.031+00:00 | main | INFO  | SimpleThreadPool | Job execution threads will use class loader of thread: main\r\n2021-01-24 16:03:52.132+00:00 | main | INFO  | SchedulerSignalerImpl | Initialized Scheduler Signaller of type: class org.quartz.core.SchedulerSignalerImpl\r\n2021-01-24 16:03:52.133+00:00 | main | INFO  | QuartzScheduler | Quartz Scheduler v.2.3.2 created.\r\n2021-01-24 16:03:52.134+00:00 | main | INFO  | RAMJobStore | RAMJobStore initialized.\r\n2021-01-24 16:03:52.141+00:00 | main | INFO  | QuartzScheduler | Scheduler meta-data: Quartz Scheduler (v2.3.2) 'DefaultQuartzScheduler' with instanceId 'NON_CLUSTERED'\r\n  Scheduler class: 'org.quartz.core.QuartzScheduler' - running locally.\r\n  NOT STARTED.\r\n  Currently in standby mode.\r\n  Number of jobs executed: 0\r\n  Using thread pool 'org.quartz.simpl.SimpleThreadPool' - with 10 threads.\r\n  Using job-store 'org.quartz.simpl.RAMJobStore' - which does not support persistence. and is not clustered.\r\n\r\n<etc>\r\n```\r\n\r\nThe restart looks to be at `2021-01-24 16:03:51.684+00:00`, and the same output is repeated continuously. The restart is managed by `systemd`.\r\n\r\nObservations:\r\n  - No error message is apparent when Teku restarts, even in Debug mode. Teku restarts before the keys are reported as loaded.\r\n  - The issue is related to the second key only: startup succeeds when only the first key is supplied, but fails if either both keys or only the second key are supplied.\r\n  - User has tried regenerating the second keystore using the deposit CLI and is confident that the keys and password files are correct. File permissions also appear correct.\r\n  - The deposit for the second key was made today.\r\n \r\n\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/3481/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766434621",
    "html_url": "https://github.com/ConsenSys/teku/issues/3481#issuecomment-766434621",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
    "id": 766434621,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQzNDYyMQ==",
    "user": {
      "login": "b-liberman",
      "id": 22765155,
      "node_id": "MDQ6VXNlcjIyNzY1MTU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/22765155?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/b-liberman",
      "html_url": "https://github.com/b-liberman",
      "followers_url": "https://api.github.com/users/b-liberman/followers",
      "following_url": "https://api.github.com/users/b-liberman/following{/other_user}",
      "gists_url": "https://api.github.com/users/b-liberman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/b-liberman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/b-liberman/subscriptions",
      "organizations_url": "https://api.github.com/users/b-liberman/orgs",
      "repos_url": "https://api.github.com/users/b-liberman/repos",
      "events_url": "https://api.github.com/users/b-liberman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/b-liberman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-24T21:23:46Z",
    "updated_at": "2021-01-24T21:23:46Z",
    "author_association": "NONE",
    "body": "it was my fault - the directory where I put the key/password for the second validator did not have the \"executable\" permission. I cannot understand why it failed when I put all keys/passwords into the same directory, though. Maybe I made a mistake then...\r\n\r\nBut anyway, this issue can be closed. \r\nThanks a lot!",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766434621/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766435670",
    "html_url": "https://github.com/ConsenSys/teku/issues/3481#issuecomment-766435670",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
    "id": 766435670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQzNTY3MA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-24T21:30:40Z",
    "updated_at": "2021-01-24T21:30:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Great that you've found the problem. Teku definitely should have logged an error in that case so I'm a little surprised it didn't.  We'll see if we can reproduce so that we can ensure we get a nice clear error in this case.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766435670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766474248",
    "html_url": "https://github.com/ConsenSys/teku/issues/3481#issuecomment-766474248",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
    "id": 766474248,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjQ3NDI0OA==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-25T00:51:00Z",
    "updated_at": "2021-01-25T00:51:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've confirmed with the latest version that when the directory is missing executable permissions Teku exits with a very clear error message as expected.  I've played with quite a few variants of permissions and can't find any setup where Teku exits silently like this.\r\n\r\nI suspect what's happening is that these logs are capturing stdout but when teku exits like this the error is (correctly) sent to stderr.  My guess is that the stderr output isn't being captured.  Systemd should capture both if you let it do its thing, but if you're using redirects to capture the output to a file you'd need `2>&1` to redirect stderr to stdout so it gets captured as well.\r\n\r\ne.g. `/opt/teku/current/bin/teku -c /etc/teku/teku.yml  >> /var/log/teku/teku.log 2>&1`\r\n\r\nWithout the `2>&1` you'd get pretty much exactly the above output.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766474248/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766729943",
    "html_url": "https://github.com/ConsenSys/teku/issues/3481#issuecomment-766729943",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
    "id": 766729943,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NjcyOTk0Mw==",
    "user": {
      "login": "b-liberman",
      "id": 22765155,
      "node_id": "MDQ6VXNlcjIyNzY1MTU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/22765155?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/b-liberman",
      "html_url": "https://github.com/b-liberman",
      "followers_url": "https://api.github.com/users/b-liberman/followers",
      "following_url": "https://api.github.com/users/b-liberman/following{/other_user}",
      "gists_url": "https://api.github.com/users/b-liberman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/b-liberman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/b-liberman/subscriptions",
      "organizations_url": "https://api.github.com/users/b-liberman/orgs",
      "repos_url": "https://api.github.com/users/b-liberman/repos",
      "events_url": "https://api.github.com/users/b-liberman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/b-liberman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-25T10:52:00Z",
    "updated_at": "2021-01-25T10:52:19Z",
    "author_association": "NONE",
    "body": "I started the teku process with the setting \r\n--log-destination=FILE --log-file=/data/teku/logs/teku.log \r\nI thought that errors would be logged in that file as well. Is there a separate setting to re-direct errors into a log file?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/766729943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/767917687",
    "html_url": "https://github.com/ConsenSys/teku/issues/3481#issuecomment-767917687",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3481",
    "id": 767917687,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NzkxNzY4Nw==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T00:21:20Z",
    "updated_at": "2021-01-27T00:21:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "ah, that's an interesting case... Because the error message is being written directly to system err it won't wind up in the log file in that case.  Part of the trouble here is that one of the reasons teku can exit is because the CLI options or config file are invalid and in that case we won't be able to respect the log destination options you're trying to set.  So as is typical for unix programs, fatal errors are sent to system error which is usually seen by users even if command output is redirected. It's a bit of a catch when running with systems though I suspect the error message will actually have turned up in the default system logs and not been lost completed.\r\n\r\nLooks like we can quite reasonable print the error to both the log and system err though which should cover all cases.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/767917687/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
