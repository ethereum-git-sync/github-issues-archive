{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6146",
  "id": 1357436364,
  "node_id": "I_kwDOCM9I9M5Q6NXM",
  "number": 6146,
  "title": "Conflicting `--validators-keystore-locking-enabled=false` has Teku complain about `--ee-endpoint`",
  "user": {
    "login": "yorickdowne",
    "id": 71337066,
    "node_id": "MDQ6VXNlcjcxMzM3MDY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yorickdowne",
    "html_url": "https://github.com/yorickdowne",
    "followers_url": "https://api.github.com/users/yorickdowne/followers",
    "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
    "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
    "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
    "repos_url": "https://api.github.com/users/yorickdowne/repos",
    "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-08-31T14:37:47Z",
  "updated_at": "2022-12-06T04:35:11Z",
  "closed_at": "2022-12-06T04:35:11Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nWhen adding `--validators-keystore-locking-enabled=false` to Teku startup parameters, while mistakenly not removing `--validators-keystore-locking-enabled=true`, it complains that `FATAL - Invalid configuration. --ee-endpoint parameter is mandatory when Bellatrix milestone is enabled`\r\n\r\nWhich is unexpected to say the least. A more fitting error message about conflicting parameters would be helpful.\r\n\r\nCommand line as shown by `ps -aux | grep teku`:\r\n\r\n```\r\ntech.pegasys.teku.Teku --data-path=/var/lib/teku --log-destination=CONSOLE --network=goerli --ee-endpoint=http://execution:8551 --ee-jwt-secret-file /var/lib/teku/ee-secret/jwtsecret --p2p-port=9020 --p2p-peer-upper-bound=100 --p2p-peer-lower-bound=64 --validators-keystore-locking-enabled=true --validator-keys=/var/lib/teku/validator-keys:/var/lib/teku/validator-passwords --validators-graffiti=üêºeth-dockerüêº --logging=info --rest-api-host-allowlist=* --rest-api-enabled=true --rest-api-interface=0.0.0.0 --rest-api-port=5052 --metrics-enabled=true --metrics-port=8008 --metrics-interface=0.0.0.0 --metrics-host-allowlist=* --validator-api-enabled=true --validator-api-interface=0.0.0.0 --validator-api-port=7500 --validator-api-host-allowlist=* --validator-api-cors-origins=* --validator-api-keystore-file=/var/lib/teku/teku-keyapi.keystore --validator-api-keystore-password-file=/var/lib/teku/teku-keyapi.password --validators-proposer-default-fee-recipient=0x9a1431df76aBF98cbAe0865927a5Ca23d46C3F04 --validators-keystore-locking-enabled=false --validators-builder-registration-default-enabled --builder-endpoint=http://mev-boost:18550 --metrics-publish-endpoint=https://beaconcha.in/api/v1/client/metrics?apikey=SOSECRET&machine=fnurble\r\n```\r\n\r\n### Versions (Add all that apply)\r\n* Software version: `teku/v22.8.2/linux-x86_64/-eclipseadoptium-openjdk64bitservervm-java-17`\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6146/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233625120",
    "html_url": "https://github.com/ConsenSys/teku/issues/6146#issuecomment-1233625120",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
    "id": 1233625120,
    "node_id": "IC_kwDOCM9I9M5Jh6Ag",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T01:24:17Z",
    "updated_at": "2022-09-01T01:24:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "hmm, that definitely is unexpected.  It doesn't happen with a simpler command line (eg `teku --network goerli --ee-endpoint http://localhost:8551 --validators-keystore-locking-enabled=false` is totally fine), but I can reproduce it with that full command line.\r\n\r\nI think something is going wrong because both `--validators-keystore-locking-enabled=true` and `--validators-keystore-locking-enabled=false` is being specified. I'm not entirely sure how that's causing the issue but it gets passed the original error if I remove it.  It still fails to start for me because I obviously don't have all the same files and validator keys etc, but I suspect not having the value duplicated will get you running again.\r\n\r\nWe'll need to dig further to work out exactly why we're getting such an odd error because of that - the last version of the option should just take precedence.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233625120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233630271",
    "html_url": "https://github.com/ConsenSys/teku/issues/6146#issuecomment-1233630271",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
    "id": 1233630271,
    "node_id": "IC_kwDOCM9I9M5Jh7Q_",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T01:34:28Z",
    "updated_at": "2022-09-01T01:34:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Simplest version I can find that reproduces this is:\r\n```\r\nteku \\\r\n  --ee-endpoint=http://execution:8551 \\\r\n  --validators-keystore-locking-enabled=true \\\r\n  --validators-keystore-locking-enabled=false \\\r\n  --builder-endpoint=http://mev-boost:18550\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233630271/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233634951",
    "html_url": "https://github.com/ConsenSys/teku/issues/6146#issuecomment-1233634951",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
    "id": 1233634951,
    "node_id": "IC_kwDOCM9I9M5Jh8aH",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T01:44:12Z",
    "updated_at": "2022-09-01T01:44:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think it's somehow related to the fact that `--ee-endpoint` and `--builder-endpoint` come from the same arg group and the two `--validators-keystore-locking-enabled` options are in between them. I'm not sure why arg groups are doing this, but this is the second unexpected problem we've had because of arg groups and all they're really buying us is the separate sections in the help text output so we may just want to ditch them.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1233634951/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1234516061",
    "html_url": "https://github.com/ConsenSys/teku/issues/6146#issuecomment-1234516061",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
    "id": 1234516061,
    "node_id": "IC_kwDOCM9I9M5JlThd",
    "user": {
      "login": "tbenr",
      "id": 15999009,
      "node_id": "MDQ6VXNlcjE1OTk5MDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tbenr",
      "html_url": "https://github.com/tbenr",
      "followers_url": "https://api.github.com/users/tbenr/followers",
      "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
      "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
      "organizations_url": "https://api.github.com/users/tbenr/orgs",
      "repos_url": "https://api.github.com/users/tbenr/repos",
      "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tbenr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T16:31:20Z",
    "updated_at": "2022-09-01T16:31:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "I tried approaching it by adding another pass which sorts the provided params by matched group, but it's not that straight forward...",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1234516061/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1294203077",
    "html_url": "https://github.com/ConsenSys/teku/issues/6146#issuecomment-1294203077",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6146",
    "id": 1294203077,
    "node_id": "IC_kwDOCM9I9M5NI_jF",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-27T22:43:18Z",
    "updated_at": "2022-10-27T22:43:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Basically we need to stop using arggroups, and still get help text out in a nice format.\nWe could create a custom help printer potentially, also potentially could change picocli to allow us to specify headings on mixins or something. The test code in the picocli ticket shows pretty well the problem.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1294203077/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
