{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/3079",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/3079",
  "id": 729437018,
  "node_id": "MDU6SXNzdWU3Mjk0MzcwMTg=",
  "number": 3079,
  "title": "SIGSEGV (0xb) at pc=0x00007f30112d2c90, pid=941293, tid=941649",
  "user": {
    "login": "dankrad",
    "id": 6130607,
    "node_id": "MDQ6VXNlcjYxMzA2MDc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6130607?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dankrad",
    "html_url": "https://github.com/dankrad",
    "followers_url": "https://api.github.com/users/dankrad/followers",
    "following_url": "https://api.github.com/users/dankrad/following{/other_user}",
    "gists_url": "https://api.github.com/users/dankrad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dankrad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dankrad/subscriptions",
    "organizations_url": "https://api.github.com/users/dankrad/orgs",
    "repos_url": "https://api.github.com/users/dankrad/repos",
    "events_url": "https://api.github.com/users/dankrad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dankrad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1048919129,
      "node_id": "MDU6TGFiZWwxMDQ4OTE5MTI5",
      "url": "https://api.github.com/repos/ConsenSys/teku/labels/bug%20%F0%9F%90%9E",
      "name": "bug üêû",
      "color": "dd6c94",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-10-26T10:21:35Z",
  "updated_at": "2020-11-06T03:56:46Z",
  "closed_at": "2020-11-06T03:56:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "This segmentation fault happened running teku:\r\n\r\n```\r\n#\r\n# A fatal error has been detected by the Java Runtime Environment:\r\n#\r\n#  SIGSEGV (0xb) at pc=0x00007f30112d2c90, pid=941293, tid=941649\r\n#\r\n# JRE version: OpenJDK Runtime Environment (11.0.8+10) (build 11.0.8+10-post-Ubuntu-0ubuntu120.04)\r\n# Java VM: OpenJDK 64-Bit Server VM (11.0.8+10-post-Ubuntu-0ubuntu120.04, mixed mode, sharing, tiered, compressed oops, g1 gc, linux-amd64)\r\n# Problematic frame:\r\n# J 17579 c2 java.lang.ThreadLocal.remove()V java.base@11.0.8 (18 bytes) @ 0x00007f30112d2c90 [0x00007f30112d2c60+0x0000000000000030]\r\n#\r\n# Core dump will be written. Default location: Core dumps may be processed with \"/usr/share/apport/apport %p %s %c %d %P %E\" (or dumping to /home/df/test/teku/build/install/teku/core.941293)\r\n#\r\n# An error report file with more information is saved as:\r\n# /home/df/test/teku/build/install/teku/hs_err_pid941293.log\r\nCompiled method (c2) 310127352 14597   !   4       tech.pegasys.teku.protoarray.ProtoArrayForkChoiceStrategy::blockParentRoot (61 bytes)\r\n total in heap  [0x00007f3010763190,0x00007f3010765710] = 9600\r\n relocation     [0x00007f3010763308,0x00007f3010763498] = 400\r\n main code      [0x00007f30107634a0,0x00007f3010764800] = 4960\r\n stub code      [0x00007f3010764800,0x00007f30107648c0] = 192\r\n oops           [0x00007f30107648c0,0x00007f30107648d8] = 24\r\n metadata       [0x00007f30107648d8,0x00007f3010764a48] = 368\r\n scopes data    [0x00007f3010764a48,0x00007f3010765070] = 1576\r\n scopes pcs     [0x00007f3010765070,0x00007f30107654b0] = 1088\r\n dependencies   [0x00007f30107654b0,0x00007f30107654d8] = 40\r\n handler table  [0x00007f30107654d8,0x00007f30107656a0] = 456\r\n nul chk table  [0x00007f30107656a0,0x00007f3010765710] = 112\r\nCould not load hsdis-amd64.so; library not loadable; PrintAssembly is disabled\r\n#\r\n# If you would like to submit a bug report, please visit:\r\n#   https://bugs.launchpad.net/ubuntu/+source/openjdk-lts\r\n#\r\nAborted (core dumped)\r\n```\r\n[tekulog6.zip](https://github.com/ConsenSys/teku/files/5438179/tekulog6.zip)\r\n[hs_err_pid941293.log.zip](https://github.com/ConsenSys/teku/files/5438181/hs_err_pid941293.log.zip)\r\n",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/3079/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/716955547",
    "html_url": "https://github.com/ConsenSys/teku/issues/3079#issuecomment-716955547",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079",
    "id": 716955547,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjk1NTU0Nw==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-27T03:29:31Z",
    "updated_at": "2020-10-27T03:29:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is an interesting one - it looks like a JVM bug given that `tech.pegasys.teku.protoarray.ProtoArrayForkChoiceStrategy::blockParentRoot` is a plain Java method and it's ultimately crashing in `ThreadLocal.remove` which is part of the JDK's `ReentrantReadWriteLock` implementation. \n\nhttps://bugs.java.com/bugdatabase/view_bug.do?bug_id=8249871 looks extremely similar - the `ThreadLocal.getMap` method is called by `ThreadLocal.remove` and is also small enough to have likely been inlined.  Unfortunately its still unresolved.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/716955547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/722797302",
    "html_url": "https://github.com/ConsenSys/teku/issues/3079#issuecomment-722797302",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/3079",
    "id": 722797302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjc5NzMwMg==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-06T03:56:46Z",
    "updated_at": "2020-11-06T03:56:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Going to merge this one with #3125 as it has a few other reports. All of them centre around accessing thread info in native methods so looks like some form of stack corruption in the JDK.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/722797302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
