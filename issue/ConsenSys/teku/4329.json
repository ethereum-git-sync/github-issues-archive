{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/4329",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/4329",
  "id": 990976566,
  "node_id": "MDU6SXNzdWU5OTA5NzY1NjY=",
  "number": 4329,
  "title": "Improve logging of invalid blocks",
  "user": {
    "login": "benjaminion",
    "id": 20796281,
    "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/benjaminion",
    "html_url": "https://github.com/benjaminion",
    "followers_url": "https://api.github.com/users/benjaminion/followers",
    "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
    "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
    "organizations_url": "https://api.github.com/users/benjaminion/orgs",
    "repos_url": "https://api.github.com/users/benjaminion/repos",
    "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/benjaminion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rolfyone",
    "id": 2967240,
    "node_id": "MDQ6VXNlcjI5NjcyNDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rolfyone",
    "html_url": "https://github.com/rolfyone",
    "followers_url": "https://api.github.com/users/rolfyone/followers",
    "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
    "organizations_url": "https://api.github.com/users/rolfyone/orgs",
    "repos_url": "https://api.github.com/users/rolfyone/repos",
    "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rolfyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-09-08T10:20:18Z",
  "updated_at": "2021-09-13T05:26:15Z",
  "closed_at": "2021-09-13T05:26:15Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Teku v21.7.0 on mainnet.\r\n\r\nI occasionally get a console warning as follows:\r\n\r\n```\r\nSep 08 02:55:11 metalalbert teku[2327]: 02:55:11.488 WARN  - Rejecting invalid block at slot 2020474 with root 0xcbdc592b5b4c49783a9487c05107bfd372968dff65ee0c083943adc09f7c36fd because FAILED_STATE_TRANSITION. Full block data: 0x64000000a2....\r\n```\r\n\r\nQuestions:\r\n1. Does this need to be at `WARN` level? If this is just junk from another client that I can't do anything about then it's a good way to DOS my logs and should probably be moved to `DEBUG`. Otoh, if this is a useful message indicating that my node might be on a wrong fork or something, then it's probably worth keeping at `WARN`.\r\n2. Notwithstanding the above, I don't need to see the full block data (which is enormous) in my console. If it is a useful message, maybe log a one-liner up to the full stop at `WARN` level, then output the full block data at `DEBUG` level.",
  "closed_by": {
    "login": "rolfyone",
    "id": 2967240,
    "node_id": "MDQ6VXNlcjI5NjcyNDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rolfyone",
    "html_url": "https://github.com/rolfyone",
    "followers_url": "https://api.github.com/users/rolfyone/followers",
    "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
    "organizations_url": "https://api.github.com/users/rolfyone/orgs",
    "repos_url": "https://api.github.com/users/rolfyone/repos",
    "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rolfyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/4329/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916594359",
    "html_url": "https://github.com/ConsenSys/teku/issues/4329#issuecomment-916594359",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329",
    "id": 916594359,
    "node_id": "IC_kwDOCM9I9M42oh63",
    "user": {
      "login": "rolfyone",
      "id": 2967240,
      "node_id": "MDQ6VXNlcjI5NjcyNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rolfyone",
      "html_url": "https://github.com/rolfyone",
      "followers_url": "https://api.github.com/users/rolfyone/followers",
      "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
      "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
      "organizations_url": "https://api.github.com/users/rolfyone/orgs",
      "repos_url": "https://api.github.com/users/rolfyone/repos",
      "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rolfyone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T03:04:50Z",
    "updated_at": "2021-09-10T03:08:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "this logging should be disabled unless either the option: `--Xlog-include-p2p-warnings-enabled` is used, or some kind of custom logging configuration is used.\nI manually tested and it appears that this CLI is functioning correctly (the invalid block warning is hidden unless this option is selected).\nit could alternatively be a custom log4j config, will wait to hear if you've done either of these things..\n\nCan you confirm whether you're using this option either in config or on your CLI @benjaminion ?",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916594359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916674219",
    "html_url": "https://github.com/ConsenSys/teku/issues/4329#issuecomment-916674219",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329",
    "id": 916674219,
    "node_id": "IC_kwDOCM9I9M42o1ar",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T06:52:39Z",
    "updated_at": "2021-09-10T06:52:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Can you confirm whether you're using this option either in config or on your CLI\r\n\r\nThis is my entire config file. The only relevant option I'm using is `log-destination: \"CONSOLE\"`. I don't have any CLI options. And no `-X` options or custom logging.\r\n\r\n```\r\nnetwork: \"mainnet\"\r\ndata-path: \"/data/teku/data\"\r\ndata-storage-mode: \"ARCHIVE\"\r\np2p-advertised-ip: \"<redacted>\"\r\nmetrics-enabled: true\r\nmetrics-interface: \"0.0.0.0\"\r\nmetrics-host-allowlist: [\"127.0.0.1\",\"192.168.1.203\",\"localhost\",\"albert\"]\r\nrest-api-enabled: true\r\nrest-api-interface: \"0.0.0.0\"\r\nrest-api-docs-enabled: true\r\nrest-api-host-allowlist: [\"127.0.0.1\",\"192.168.1.203\",\"localhost\",\"albert\"]\r\nrest-api-cors-origins: \"*\"\r\np2p-peer-upper-bound: 100\r\np2p-peer-lower-bound: 80\r\nvalidator-keys: \"/var/lib/teku/keys:/var/lib/teku/keys\"\r\neth1-endpoint: \"https://mainnet.infura.io/v3/<redacted>\"\r\nlog-destination: \"CONSOLE\"\r\nvalidators-keystore-locking-enabled: false\r\nvalidators-performance-tracking-enabled: true\r\n```\r\n\r\nI haven't had any of these `Rejecting invalid block` messages since updating to 21.8.2 a couple of days ago, having had a dozen in the previous month with the older version. I am happy to put this on hold for a week or so and I'll update if I see this again, and we can close it if not.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916674219/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916699262",
    "html_url": "https://github.com/ConsenSys/teku/issues/4329#issuecomment-916699262",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/4329",
    "id": 916699262,
    "node_id": "IC_kwDOCM9I9M42o7h-",
    "user": {
      "login": "benjaminion",
      "id": 20796281,
      "node_id": "MDQ6VXNlcjIwNzk2Mjgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/20796281?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benjaminion",
      "html_url": "https://github.com/benjaminion",
      "followers_url": "https://api.github.com/users/benjaminion/followers",
      "following_url": "https://api.github.com/users/benjaminion/following{/other_user}",
      "gists_url": "https://api.github.com/users/benjaminion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benjaminion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benjaminion/subscriptions",
      "organizations_url": "https://api.github.com/users/benjaminion/orgs",
      "repos_url": "https://api.github.com/users/benjaminion/repos",
      "events_url": "https://api.github.com/users/benjaminion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benjaminion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T07:38:54Z",
    "updated_at": "2021-09-10T07:38:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "However, I _am_ now seeing console logs as follows:\r\n\r\n```\r\nSep 10 06:05:31 metalalbert teku[2436]: 06:05:31.109 WARN  - Rejecting gossip message on topic /eth2/b5303f2a/beacon_aggregate_and_proof/ssz_snappy, reason: Rejecting aggregate because attester is not in committee. Should have been one of [113103, 179860,... <lots of stuff>\r\n```\r\n\r\nA couple of these today, version `teku/v21.8.2+30-gbb0c2f3/linux-x86_64/-privatebuild-openjdk64bitservervm-java-13`.\r\n\r\nThe same remarks apply to these as to the `Rejecting invalid block` messages.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/916699262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
