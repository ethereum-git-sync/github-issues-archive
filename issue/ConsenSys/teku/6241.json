{
  "url": "https://api.github.com/repos/ConsenSys/teku/issues/6241",
  "repository_url": "https://api.github.com/repos/ConsenSys/teku",
  "labels_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241/labels{/name}",
  "comments_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241/comments",
  "events_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241/events",
  "html_url": "https://github.com/ConsenSys/teku/issues/6241",
  "id": 1382237738,
  "node_id": "I_kwDOCM9I9M5SY0Yq",
  "number": 6241,
  "title": "Persist ProposerData (prepared\\registered proposerd) on BN to survive upon restart",
  "user": {
    "login": "tbenr",
    "id": 15999009,
    "node_id": "MDQ6VXNlcjE1OTk5MDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15999009?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tbenr",
    "html_url": "https://github.com/tbenr",
    "followers_url": "https://api.github.com/users/tbenr/followers",
    "following_url": "https://api.github.com/users/tbenr/following{/other_user}",
    "gists_url": "https://api.github.com/users/tbenr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tbenr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tbenr/subscriptions",
    "organizations_url": "https://api.github.com/users/tbenr/orgs",
    "repos_url": "https://api.github.com/users/tbenr/repos",
    "events_url": "https://api.github.com/users/tbenr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tbenr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-09-22T10:46:49Z",
  "updated_at": "2022-12-01T23:57:52Z",
  "closed_at": "2022-12-01T23:57:52Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "There is a well known condition in which our BN will use default fee recipient. Since we do not persist prepared\\registered proposer anywhere, when BN restarts it loses the information and will get it back on next VC poll, which suppose to happen on each epoch (for teku VC is at beginning of third slot). During this time window, if a validator have a block proposal duty, BN will use default fee recipient and will also give less time to EL to produce a payload (we will send FcU with attributes and getPayload in sequence)\r\n\r\nAn improvement would be to persist prepared\\registered proposerd (the data managed by `ProposerDataManager`) on disk and reload it upon restart.\r\n\r\nAnother option is to make VC resend info if loses connection with BN (on event stream reconnection?) but this will improve our VC and not make BN by itself more resilient to restarts and so less dependant by VC behaviour.",
  "closed_by": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/6241/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1255611195",
    "html_url": "https://github.com/ConsenSys/teku/issues/6241#issuecomment-1255611195",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241",
    "id": 1255611195,
    "node_id": "IC_kwDOCM9I9M5K1xs7",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-22T22:15:31Z",
    "updated_at": "2022-09-22T22:15:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'd probably go with the VC change as we can't assume the beacon node will persist the data to disk either (the api doesn't require it and I think even mentions it may be forgotten when the beacon node restarts).",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1255611195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1334593943",
    "html_url": "https://github.com/ConsenSys/teku/issues/6241#issuecomment-1334593943",
    "issue_url": "https://api.github.com/repos/ConsenSys/teku/issues/6241",
    "id": 1334593943,
    "node_id": "IC_kwDOCM9I9M5PjEmX",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-01T23:57:52Z",
    "updated_at": "2022-12-01T23:57:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Going to close this one. We seem to be handling this fine in the real world and other BN implementations don't persist the data either so we can't depend on that anyway.",
    "reactions": {
      "url": "https://api.github.com/repos/ConsenSys/teku/issues/comments/1334593943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
