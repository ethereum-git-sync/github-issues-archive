{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/1597",
  "id": 710242491,
  "node_id": "MDU6SXNzdWU3MTAyNDI0OTE=",
  "number": 1597,
  "title": "libp2p 0.29: Handle dialProtocol timeout",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1420822243,
      "node_id": "MDU6TGFiZWwxNDIwODIyMjQz",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-stale",
      "name": "meta-stale",
      "color": "d0d1e6",
      "default": false,
      "description": "Label for stale issues applied by the stale bot."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 18,
  "created_at": "2020-09-28T12:58:12Z",
  "updated_at": "2020-12-20T13:32:19Z",
  "closed_at": "2020-12-20T13:32:19Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\nSync stalled due to a request timeout does not throw Error.\r\nThis happens to me a couple of times with libp2p 0.29: during initial sync/regular sync, peers get disconnected after we called dialProtocol but it did not trigger an error when timeout\r\n```\r\n2020-09-28 19:37:35  [SYNC]             warn: Failed to obtain chunk {\"start\":395488,\"end\":395551} from peer 16Uiu2HAmEPBjHgMH4YZeNMFsMC6wrGWKcJR6uFL5j8oahyG2NKzz\r\n2020-09-28 19:37:35  [NETWORK]       verbose: sending beacon_blocks_by_range request to 16Uiu2HAmEPBjHgMH4YZeNMFsMC6wrGWKcJR6uFL5j8oahyG2NKzz requestId=5c42cd4fd33136f3, encoding=ssz_snappy\r\n2020-09-28 19:37:35  [NETWORK]       verbose: peer disconnected 16Uiu2HAmEPBjHgMH4YZeNMFsMC6wrGWKcJR6uFL5j8oahyG2NKzz\r\n```\r\n\r\n**Expected behavior**\r\nNetwork req/resp should throw error for sync to handle\r\n\r\nOne candidate to fix is #1277\r\n",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701205586",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701205586",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701205586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTIwNTU4Ng==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T07:12:36Z",
    "updated_at": "2020-09-30T07:12:36Z",
    "author_association": "MEMBER",
    "body": "Quote from Vasco\r\n> The issue might be: you add the peer's addresses to the AddressBook, which will result in autoDial to kick in and dial your peer. In parallel, you do a manual dial and it will wait for the previous one without using the abort signal: ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701205586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701240030",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701240030",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701240030,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI0MDAzMA==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T08:19:51Z",
    "updated_at": "2020-09-30T08:19:51Z",
    "author_association": "MEMBER",
    "body": "@tuyennhv Could this be it?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701240030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701248963",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701248963",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701248963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI0ODk2Mw==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T08:37:38Z",
    "updated_at": "2020-09-30T08:37:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "it's not the case for us, I notice the same peer was used a couple of times (in earlier log which I did not catch) before the issue happen.\r\n\r\n> The issue might be: you add the peer's addresses to the AddressBook\r\n\r\nI think libp2p handles that part, lodestar doesn't do that",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701248963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701249815",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701249815",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701249815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI0OTgxNQ==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T08:39:13Z",
    "updated_at": "2020-09-30T08:39:44Z",
    "author_association": "MEMBER",
    "body": "> it's not the case for us, I notice the same peer was used a couple of times (in earlier log which I did not catch) before the issue happen.\r\n> \r\nDEfault timeout is 60s so within 60s of adding peer all dialProtocol signals won't work. Are you saying we got some response from peer before?\r\n\r\n> \r\n> I think libp2p handles that part, lodestar doesn't do that\r\n\r\nIt gets added there from discv5 for example.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701249815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701254354",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701254354",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701254354,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI1NDM1NA==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T08:47:56Z",
    "updated_at": "2020-09-30T08:47:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Are you saying we got some response from peer before?\r\n\r\nyes\r\n\r\n> It gets added there from discv5 for example.\r\n\r\njust check that discv5 doesn't use libp2p addressBook, this is how discv5 send a \"peer\" event to libp2p https://github.com/ChainSafe/discv5/blob/master/src/libp2p/discv5.ts#L91\r\nthen libp2p has to add multiaddr to its addressBook himself.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701254354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701282209",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701282209",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701282209,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI4MjIwOQ==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T09:41:08Z",
    "updated_at": "2020-09-30T09:42:44Z",
    "author_association": "MEMBER",
    "body": "> just check that discv5 doesn't use libp2p addressBook, this is how discv5 send a \"peer\" event to libp2p https://github.com/ChainSafe/discv5/blob/master/src/libp2p/discv5.ts#L91\r\n> then libp2p has to add multiaddr to its addressBook himself.\r\n\r\nhttps://github.com/libp2p/js-libp2p/blob/bb59b518f142065d9f40852aa9089d73ac7a7cdc/src/index.js#L502",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701282209/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701289266",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701289266",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701289266,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI4OTI2Ng==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T09:55:28Z",
    "updated_at": "2020-09-30T09:55:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeah libp2p add addresses to addressBook there, lodestar and discv5 don't use that.\r\n\r\n> In parallel, you do a manual dial and it will wait for the previous one without using the abort signal:\r\n\r\nwe don't do a manual dial and the peer were used to query beacon blocks by range/root successfully a couple of times until it disconnected and the last request failed without throwing timeout error in `dialProtocol` then it cause sync stalled.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701289266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701292410",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701292410",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701292410,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTI5MjQxMA==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T10:02:00Z",
    "updated_at": "2020-09-30T10:02:00Z",
    "author_association": "MEMBER",
    "body": "> yeah libp2p add addresses to addressBook there, lodestar and discv5 don't use that.\r\n> \r\nYes we do, this method gets called once you emit peer event from discv5.\r\nhttps://github.com/libp2p/js-libp2p/blob/bb59b518f142065d9f40852aa9089d73ac7a7cdc/src/index.js#L565\r\n\r\n> > In parallel, you do a manual dial and it will wait for the previous one without using the abort signal:\r\n> \r\n> we don't do a manual dial and the peer were used to query beacon blocks by range/root successfully a couple of times until it disconnected and the last request failed without throwing timeout error in `dialProtocol` then it cause sync stalled.\r\n\r\nEvery dialProtocol is manual dial to peer. Automatic dial happens when discovery service (discv5 in our case) find peer, we dial to get peer libp2p metadata (supported protocols for example)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701292410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701300112",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701300112",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701300112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTMwMDExMg==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T10:17:39Z",
    "updated_at": "2020-09-30T10:17:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Every dialProtocol is manual dial to peer. Automatic dial happens when discovery service (discv5 in our case) find peer, we dial to get peer libp2p metadata (supported protocols for example)\r\n\r\nAgree, but in our case, I believe we have a connection to peer already since we got a lot of successful requests, we call `dialProtocol` just to get a stream with same connection.\r\n\r\n> The issue might be: you add the peer's addresses to the AddressBook, which will result in autoDial to kick in and dial your peer. In parallel, you do a manual dial and it will wait for the previous one without using the abort signal:\r\n\r\nI don't think this is the scenario we face since we have a couple of successful requests/responses already, I guess `autoDial` only works if we have no connection to peer https://github.com/libp2p/js-libp2p/blob/bb59b518f142065d9f40852aa9089d73ac7a7cdc/src/index.js#L521\r\n\r\nI notice the issue happens because the peer disconnected us and dialProtocol was called right before that and did not trigger Error timeout after all.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701300112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701304625",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701304625",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701304625,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTMwNDYyNQ==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T10:27:40Z",
    "updated_at": "2020-09-30T10:27:40Z",
    "author_association": "MEMBER",
    "body": "Do you think we can create test case for that so libp2p guys can help us?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701304625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701305686",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701305686",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701305686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTMwNTY4Ng==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T10:29:58Z",
    "updated_at": "2020-09-30T10:29:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "yeah it's a good idea, not easy to reproduce with our sync but I'll give it a try",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701305686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701308840",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-701308840",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 701308840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTMwODg0MA==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T10:37:01Z",
    "updated_at": "2020-09-30T10:37:01Z",
    "author_association": "MEMBER",
    "body": "> yeah it's a good idea, not easy to reproduce with our sync but I'll give it a try\r\n\r\nI don't think you need to do it in sync, just use raw dialProtocol and disconnect other peer, maybe",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/701308840/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703394386",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-703394386",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 703394386,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzM5NDM4Ng==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T04:51:54Z",
    "updated_at": "2020-10-05T04:51:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "I couldn't reproduce this in libp2p test case, if I do `dialProtocol` and disconnect peer in the middle, it threw `Error: stream ended before 1 bytes became available` instead of being suspended like in this issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703394386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703435076",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-703435076",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 703435076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzQzNTA3Ng==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T06:49:04Z",
    "updated_at": "2020-10-05T06:49:04Z",
    "author_association": "MEMBER",
    "body": "You could try with https://github.com/libp2p/js-libp2p/pull/764 and see if it maybe fixes, otherwise let's wait for libp2p0.29 and see if it still happening.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703435076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703445160",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-703445160",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 703445160,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzQ0NTE2MA==",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T07:10:33Z",
    "updated_at": "2020-10-05T07:10:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "Recently I only try everything in my libp2p 0.29 branch but it's good to know they are working on something related to the issue",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703445160/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703446760",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-703446760",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 703446760,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzQ0Njc2MA==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-05T07:13:46Z",
    "updated_at": "2020-10-05T07:13:46Z",
    "author_association": "MEMBER",
    "body": "There is also PR with same changes for 0.29 version",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/703446760/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/739037243",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-739037243",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 739037243,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTAzNzI0Mw==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2020-12-04T21:43:50Z",
    "updated_at": "2020-12-04T21:43:50Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed in 15 days if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/739037243/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/748608267",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1597#issuecomment-748608267",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1597",
    "id": 748608267,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0ODYwODI2Nw==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2020-12-20T13:32:18Z",
    "updated_at": "2020-12-20T13:32:18Z",
    "author_association": "NONE",
    "body": "This issue or pull request has been automatically been closed due to inactivity.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/748608267/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
