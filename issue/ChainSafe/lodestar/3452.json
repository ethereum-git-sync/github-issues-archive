{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/3452",
  "id": 1059742602,
  "node_id": "I_kwDOCD5_Gc4_KmOK",
  "number": 3452,
  "title": "Kintsugi :tea:  (the merge) devnets 2022 tracker",
  "user": {
    "login": "g11tech",
    "id": 76567250,
    "node_id": "MDQ6VXNlcjc2NTY3MjUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g11tech",
    "html_url": "https://github.com/g11tech",
    "followers_url": "https://api.github.com/users/g11tech/followers",
    "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
    "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
    "organizations_url": "https://api.github.com/users/g11tech/orgs",
    "repos_url": "https://api.github.com/users/g11tech/repos",
    "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g11tech/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3592888034,
      "node_id": "LA_kwDOCD5_Gc7WJx7i",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/Epic",
      "name": "Epic",
      "color": "4660F9",
      "default": false,
      "description": "Issues used as milestones and tracking multiple issues."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "g11tech",
    "id": 76567250,
    "node_id": "MDQ6VXNlcjc2NTY3MjUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g11tech",
    "html_url": "https://github.com/g11tech",
    "followers_url": "https://api.github.com/users/g11tech/followers",
    "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
    "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
    "organizations_url": "https://api.github.com/users/g11tech/orgs",
    "repos_url": "https://api.github.com/users/g11tech/repos",
    "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g11tech/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-11-22T06:21:40Z",
  "updated_at": "2022-02-08T14:32:53Z",
  "closed_at": "2022-02-08T14:32:52Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Following issues are encountered during the kintsugi devnet merge runs on local. The resolution could either belong to lodestar or the corresponding ELs. this is just a tracker.\r\n\r\n**Devnets**\r\n- [x] devnet 0 - multiple issues discovered, devnet stalled with attacking chains, EL <> CL integration issues, discovered edge case for merge transition attack with unavailable pow\r\n- [x] devnet 1 - merge worked well for lodestar-geth, lighthouse-geth nodes till it was discovered that majority chain was on a buggy EL execution (triggered by a transaction) because of a wrong feature activation in geth build, minority lodestar-nethermind, lighthouse nethermind were on correct chain but not finalizing, devnet 1 was prudently saved with geth based nodes nuked and restarted with fixed geth images, entire network now finalizing correctly. meta mask based transactions were tested out and carried successfully!\r\n- [x] devnet 2 \r\n- [x] devnet 3 December 7 2021  tl-dr: devnet 3 ran into multiple issues while booting up, because most of the clients didn't have the engine api V3 spec implemented in their build. Lodestar's PR was also delayed, while many other clients just died, lodestar kept on proposing pre-merge blocks (by design) since its execution API was also not working. After the clients got updated with the api change including lodestar, everything went back to normal. as of last observation lodestar <> geth and lodestar <> nethermind combos were doing good, proposing blocks every now and then, keeping up with the head and validators participating in the duties.\r\n  - [x] UPDATE: Users from chainsafe wanted to test out devnet 3, however the geth images were not working, giving invalid payloads and merkle state not correct errors (saw it in devnet 0, and tl-dr of those issues was that geth was not able to shift to correct chain if it latched on a bad chain). Needs further investigation. however was able to get the lodestar - nethermind setup working.\r\n  - [x] #3507\r\n    - [x] Nethermind\r\n    - [x] Geth\r\n   - [x] got the optimistic sync part 1 PR branch deployed on the devnet and seems to be working fine [(track execution status and don't produce/attest/contribute on syncing heads)](https://github.com/ChainSafe/lodestar/pull/3434) \r\n- [x] Kintsugi devnet : tl-dr: Lodestar sailed through genesis, merge block, TTD into post merge scenario, with lodestar-geth combo working well and producing blocks regularly. However some EL clients still were producing invalid blocks, and in some scenarios leading to lighthouse interpreting those errors as Syncing execution, which lead to series of nodes not proposing blocks with lots of skipped slots and reorgs happening. Prsym also got their CL working, and besu also fixing their issues with networking participation nearing ~90%\r\n  - [x] Update the merge devnet joining script with the kintsugi configuration (https://github.com/ChainSafe/lodestar/pull/3514)\r\n  - [x] Inspected the nodes spun up by Paritosh and checking on how lodestar and the corresponding ELs are doing\r\n  - [x] Helped resolved the restarting of the lodestar beacon on devnet as multi bootnode enr args format was wrong (, based)\r\n  - [x] Observed and reported per-genesis epoch transition evaluation (fixed by @tuyennhv https://github.com/ChainSafe/lodestar/pull/3533)  \r\n  - [x] Lodetstar <> Nethermind interop issues (status: waiting for a fix)\r\n    - [x]  Investigated, debugged and escalated block production issues on lodestar <> nethermind combo because of internal \r\n    - [x] As per nethermind team that is because of concurrency issues which they are currently patching. Coordinated and tested a new build .4 version but still got it. Nethermind team is currently looking and fixing\r\n  - [x] https://github.com/ChainSafe/lodestar/issues/3537\r\n\r\n\r\n**Lodestar**\r\n_ignoring EL errors and issues and treating them as Syncing kept it moving forward on chain_\r\n\r\n  - [x] handle connection refused (optimistic treatment?)\r\n  - [x] bad merkle root error (ignoring it like syncing let the chain to move forward, and ultimately geth starting responding with valid on further along the chain, should actually treat them as INVALID and let the optimistic do its thing)\r\n  - [x] timeout issues (optimistic treatment?)\r\n  - [x] EL on an attacking chain, doesnt move forward (optimistic ?)\r\n  \r\n  ~~[ ] on the merge net, the head is far ahead (4128) but lodestar keeps giving BLOCK_ERROR_PARENT_UNKOWN on few blocks (1510,1761), most probably because they and their parents are not part of canonical chain and finalization is still on epoch 35 (1120 slot): `06:43:52.316 []                 info: Synced - slot: 27418 (skipped 1) - head: 27417 0xb2b8…8d52 - finalized: 0xcb7f…5d60:35 - peers: 8`~~\r\n\r\n**Geth**\r\n  - [x] bad merkel root: on the blocks after transition even when on correct terminal pow chain (needs debugging from Geth team)\r\n  - [x] got stuck on an attacking chain (might apply to other ELs as well)\r\n  - [x] segmentation faults and restarts\r\n\r\n**Nethermind**\r\n_waiting for post bug fix build from the team to run on top_\r\n  - [x] invalid executions even (update: scenario is CL is on merge block while EL hasn't synced till TTD, expected response syncing, escalated to team) \r\n\r\n~~**EthereumJs**~~ UPDATE 17 December 2021: OUT OF SCOPE as the newer compatible builds are not yet available.\r\n(least integration issues)\r\n  ~~- [ ] High CPU usage after executing few blocks~~\r\n  ~~- [ ] timeouts and non responsive, becomes better on restart but only for again few blocks~~\r\n  \r\n**Other** \r\n- [x] merge spec issue with optimistic sync where the entire chain would stall: https://github.com/ethereum/consensus-specs/issues/2732#issue-1060223074\r\n",
  "closed_by": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452/reactions",
    "total_count": 2,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1032674024",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/3452#issuecomment-1032674024",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3452",
    "id": 1032674024,
    "node_id": "IC_kwDOCD5_Gc49jVro",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T14:32:52Z",
    "updated_at": "2022-02-08T14:32:52Z",
    "author_association": "MEMBER",
    "body": "Closing this in lieu of #3731. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1032674024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
