{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/3217",
  "id": 1002053923,
  "node_id": "I_kwDOCD5_Gc47uiEj",
  "number": 3217,
  "title": "Use synced peers only for unknown block sync",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090453,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDUz",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-low",
      "name": "prio-low",
      "color": "fde2b4",
      "default": false,
      "description": "This is nice to have."
    },
    {
      "id": 2155825090,
      "node_id": "MDU6TGFiZWwyMTU1ODI1MDkw",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-networking",
      "name": "scope-networking",
      "color": "980043",
      "default": false,
      "description": "All issues related to networking, gossip, and libp2p."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-09-21T08:36:01Z",
  "updated_at": "2022-05-10T18:22:08Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "is it better to only get peers with `status.head >= ours`? it's no use to ask for blocks from syncing peers\r\n\r\n_Originally posted by @tuyennhv in https://github.com/ChainSafe/lodestar/pull/3212#discussion_r712649826_",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/993141526",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/3217#issuecomment-993141526",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217",
    "id": 993141526,
    "node_id": "IC_kwDOCD5_Gc47MiMW",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-14T04:15:00Z",
    "updated_at": "2021-12-14T04:15:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "It happens in one of our nodes that we ban peers that don't know the below good blocks\r\n\r\n```\r\nDec-12 10:00:05.701 [SYNC]            ^[[31merror^[[39m: Removing and banning unknown parent block root=0x6823b2b51f699455c996694d513aabe1647a1a977c8ea3554a95dfb5c13e4272, slot=1899459\r\nDec-12 10:00:05.706 [SYNC]            ^[[31merror^[[39m: Removing and banning unknown parent block root=0xac57ba74cf20ca0a266f2d768147ecc9e61fb869e14d85897ca57ef679257d0e, slot=1899461\r\nDec-12 10:00:05.707 [SYNC]            ^[[31merror^[[39m: Removing and banning unknown parent block root=0x8591d52bcf1f355b23f534c8599ed432632c7dfdcbcf8f9638724c29e9c3fb6f, slot=1899462\r\nDec-12 10:00:05.707 [SYNC]            ^[[31merror^[[39m: Removing and banning unknown parent block root=0xc5c06fd6318b9bb6a9df6e403ce8c949c691dcc5182405f14f0f8d1353ac9791, slot=1899463\r\nDec-12 10:00:05.708 [SYNC]            ^[[31merror^[[39m: Removing and banning unknown parent block root=0x4fe54e558f7df0d7bb37aad2ce9fb8e9d4b50e401dce72c068914056ef2903f0, slot=1899464\r\nDec-12 10:00:06.661 []                 ^[[32minfo^[[39m: Syncing - 8.3 minutes left - 0.0969 slots/s - slot: 1899600 (skipped 48) - head: 1899552 0xa80a…4192 - finalized: 0xfbe1…0d12:59359 - peers: 11\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/993141526/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/993222586",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/3217#issuecomment-993222586",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3217",
    "id": 993222586,
    "node_id": "IC_kwDOCD5_Gc47M1-6",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-14T07:08:35Z",
    "updated_at": "2021-12-14T10:10:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "there are a lot of errors like below\r\n\r\n```\r\nDec-12 04:13:42.912 [SYNC]            ^[[34mdebug^[[39m: Error fetching UnknownBlockRoot attempt=0, blockRootHex=0x97c4479c44895d46ad9b31df0f61f367809eb42c51d24231c27c00f8813a816b, peer=16Uiu2HAm7fmahwotuD8twpLpvtG1SSFVdp2KotwzVUEoDFW5ot96 method=beacon_blocks_by_root, encoding=ssz_snappy, peer=16...W5ot96, code=REQUEST_ERROR_DIAL_ERROR, error={\"message\":\"protocol selection failed\"}\r\nError: protocol selection failed\r\n    at module.exports (/usr/app/node_modules/multistream-select/src/select.js:50:17)\r\n```\r\n\r\nwe want to only issue requests to peer with supported `beacon_blocks_by_root` protocol\r\n\r\n**Update**: actually this peer should be banned immediately, open https://github.com/ChainSafe/lodestar/issues/3517",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/993222586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
