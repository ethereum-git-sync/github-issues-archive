{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/2630",
  "id": 910856140,
  "node_id": "MDU6SXNzdWU5MTA4NTYxNDA=",
  "number": 2630,
  "title": "benchmark workflow fails with OOM",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2021-06-03T21:11:57Z",
  "updated_at": "2021-06-04T06:53:57Z",
  "closed_at": "2021-06-04T06:53:57Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "<!--NOTE: -->\r\n<!--- General questions should go to the discord chat instead of the issue tracker.-->\r\n\r\n**Describe the bug**\r\n\r\nFrom https://github.com/ChainSafe/lodestar/runs/2736236235\r\n\r\n```\r\nlerna info Executing command in 1 package: \"yarn run benchmark\"\r\n@chainsafe/lodestar-beacon-state-transition: $ ts-node test/perf/benchmark.ts\r\n@chainsafe/lodestar-beacon-state-transition: Process block\r\n@chainsafe/lodestar-beacon-state-transition: ================================================================\r\n@chainsafe/lodestar-beacon-state-transition: Process regular block                                                  191.9862 ops/s       5208707 ns/op     50 runs\r\n@chainsafe/lodestar-beacon-state-transition: Process blocks with 16 validator exits                                0.9815835 ops/s   1.018762e+9 ns/op     50 runs\r\n@chainsafe/lodestar-beacon-state-transition: Epoch transition steps\r\n@chainsafe/lodestar-beacon-state-transition: ================================================================\r\n@chainsafe/lodestar-beacon-state-transition: <--- Last few GCs --->\r\n@chainsafe/lodestar-beacon-state-transition: [3572:0x4e14770]   146324 ms: Mark-sweep (reduce) 1983.1 (1996.5) -> 1983.1 (1996.5) MB, 2272.6 / 0.0 ms  (average mu = 0.093, current mu = 0.000) last resort GC in old space requested\r\n@chainsafe/lodestar-beacon-state-transition: [3572:0x4e14770]   148504 ms: Mark-sweep (reduce) 1983.1 (1989.5) -> 1983.0 (1990.5) MB, 2179.3 / 0.0 ms  (average mu = 0.049, current mu = 0.000) last resort GC in old space requested\r\n@chainsafe/lodestar-beacon-state-transition: <--- JS stacktrace --->\r\n@chainsafe/lodestar-beacon-state-transition: FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memory\r\n@chainsafe/lodestar-beacon-state-transition:  1: 0xa222f0 node::Abort() [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  2: 0x96411f node::FatalError(char const*, char const*) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  3: 0xb97f1e v8::Utils::ReportOOMFailure(v8::internal::Isolate*, char const*, bool) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  4: 0xb98297 v8::internal::V8::FatalProcessOutOfMemory(v8::internal::Isolate*, char const*, bool) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  5: 0xd52fd5  [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  6: 0xd65841 v8::internal::Heap::AllocateRawWithRetryOrFailSlowPath(int, v8::internal::AllocationType, v8::internal::AllocationOrigin, v8::internal::AllocationAlignment) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  7: 0xd2af4d v8::internal::Factory::AllocateRaw(int, v8::internal::AllocationType, v8::internal::AllocationAlignment) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  8: 0xd271a9 v8::internal::FactoryBase<v8::internal::Factory>::AllocateRawArray(int, v8::internal::AllocationType) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition:  9: 0xd27264 v8::internal::FactoryBase<v8::internal::Factory>::NewFixedArrayWithFiller(v8::internal::Handle<v8::internal::Map>, int, v8::internal::Handle<v8::internal::Oddball>, v8::internal::AllocationType) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 10: 0xf6de9b v8::internal::OrderedHashTable<v8::internal::OrderedHashSet, 1>::Allocate(v8::internal::Isolate*, int, v8::internal::AllocationType) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 11: 0xf6e02f v8::internal::OrderedHashTable<v8::internal::OrderedHashSet, 1>::Rehash(v8::internal::Isolate*, v8::internal::Handle<v8::internal::OrderedHashSet>, int) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 12: 0xf6e74b v8::internal::OrderedHashSet::Add(v8::internal::Isolate*, v8::internal::Handle<v8::internal::OrderedHashSet>, v8::internal::Handle<v8::internal::Object>) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 13: 0xd54b74 v8::internal::Heap::KeepDuringJob(v8::internal::Handle<v8::internal::JSReceiver>) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 14: 0xc5540e  [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 15: 0xc56f26 v8::internal::Builtin_WeakRefConstructor(int, unsigned long*, v8::internal::Isolate*) [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: 16: 0x1423359  [/usr/local/bin/node]\r\n@chainsafe/lodestar-beacon-state-transition: Aborted (core dumped)\r\n@chainsafe/lodestar-beacon-state-transition: error Command failed with exit code 134.\r\n@chainsafe/lodestar-beacon-state-transition: info Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\r\nlerna ERR! yarn run benchmark exited 134 in '@chainsafe/lodestar-beacon-state-transition'\r\nerror Command failed with exit code 134.\r\n```\r\n\r\n**Expected behavior**\r\n\r\nReport status correctly without OOM",
  "closed_by": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2630/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
