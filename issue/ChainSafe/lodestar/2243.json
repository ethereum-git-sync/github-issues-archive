{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/2243",
  "id": 839578416,
  "node_id": "MDU6SXNzdWU4Mzk1Nzg0MTY=",
  "number": 2243,
  "title": "Prater logs - Error: Peer ID doesn't match libp2p public key",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090453,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDUz",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-low",
      "name": "prio-low",
      "color": "fde2b4",
      "default": false,
      "description": "This is nice to have."
    },
    {
      "id": 2159934357,
      "node_id": "MDU6TGFiZWwyMTU5OTM0MzU3",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-testnet-debugging",
      "name": "scope-testnet-debugging",
      "color": "980043",
      "default": false,
      "description": "Issues uncovered through running a node on a public testnet."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-03-24T10:31:15Z",
  "updated_at": "2023-05-24T07:46:07Z",
  "closed_at": "2023-05-24T07:46:07Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "<!--NOTE: -->\r\n<!--- General questions should go to the discord chat instead of the issue tracker.-->\r\n\r\n**Describe the bug**\r\n\r\nDuring Prater genesis I see this log a bunch of times. Does this mean that the public key of another peer has changed between the last connection and now? \r\n\r\n```\r\n2021-03-23 15:22:45 [NETWORK]         debug: Error dialing discovered peer peer=16Uiu2HAmR5sBraVshGyBayrYn6gMmT2B2aqYMcbm3mjB7LKGXR1B message=\r\n    Error: connection error 172.17.0.1:9124: connect ECONNREFUSED 172.17.0.1:9124\r\n    Error: connection error 127.0.0.1:9124: connect ECONNREFUSED 127.0.0.1:9124\r\n    Error: Error occurred during XX handshake: Error occurred while verifying signed payload: Peer ID doesn't match libp2p public key.\r\n        at Noise.performXXHandshake (/root/lodestar/node_modules/libp2p-noise/src/noise.ts:211:13)\r\n    Error: The operation was aborted\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/libp2p-tcp/src/index.js:86:14)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n    Error: The operation was aborted\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/libp2p-tcp/src/index.js:86:14)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\nAggregateError: \r\n    Error: connection error 172.17.0.1:9124: connect ECONNREFUSED 172.17.0.1:9124\r\n    Error: connection error 127.0.0.1:9124: connect ECONNREFUSED 127.0.0.1:9124\r\n    Error: Error occurred during XX handshake: Error occurred while verifying signed payload: Peer ID doesn't match libp2p public key.\r\n        at Noise.performXXHandshake (/root/lodestar/node_modules/libp2p-noise/src/noise.ts:211:13)\r\n    Error: The operation was aborted\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/libp2p-tcp/src/index.js:86:14)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n    Error: The operation was aborted\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/libp2p-tcp/src/index.js:86:14)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n    at maybeSettle (/root/lodestar/node_modules/p-some/index.js:31:11)\r\n    at /root/lodestar/node_modules/p-some/index.js:69:23\r\n    at runMicrotasks (<anonymous>)\r\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\r\n    at runNextTicks (internal/process/task_queues.js:66:3)\r\n    at processTimers (internal/timers.js:494:9)\r\n```\r\n",
  "closed_by": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/805733370",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2243#issuecomment-805733370",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
    "id": 805733370,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTczMzM3MA==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T11:09:24Z",
    "updated_at": "2021-03-24T11:09:24Z",
    "author_association": "MEMBER",
    "body": "Other log latter\r\n```\r\n2021-03-23 15:24:05 [NETWORK]         debug: Error dialing discovered peer peer=16Uiu2HAmDng5UpRhZR5q7VzFjNmEBW9DSe92VKmhXvPZo4xEAciX message=\r\n    Error: Error occurred during XX handshake: Error occurred while verifying signed payload: Peer ID doesn't match libp2p public key.\r\n        at Noise.performXXHandshake (/root/lodestar/node_modules/libp2p-noise/src/noise.ts:211:13)\r\n        at runMicrotasks (<anonymous>)\r\n    Error: Error occurred during XX handshake: Error occurred while verifying signed payload: Peer ID doesn't match libp2p public key.\r\n        at Noise.performXXHandshake (/root/lodestar/node_modules/libp2p-noise/src/noise.ts:211:13)\r\n        at runMicrotasks (<anonymous>)\r\n    Error: The operation was aborted\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/libp2p-tcp/src/index.js:86:14)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n        at abortSignal (/root/lodestar/node_modules/abort-controller/src/abort-signal.ts:68:12)\r\n        at AbortController.abort (/root/lodestar/node_modules/abort-controller/src/abort-controller.ts:26:9)\r\n        at AbortSignal.onAbort (/root/lodestar/node_modules/any-signal/index.js:13:16)\r\n        at AbortSignal.dispatchEvent (/root/lodestar/node_modules/event-target-shim/src/event-target.mjs:337:35)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/805733370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/853235097",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2243#issuecomment-853235097",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
    "id": 853235097,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzIzNTA5Nw==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-06-02T17:18:46Z",
    "updated_at": "2021-06-02T17:18:46Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed in 15 days if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/853235097/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/912547497",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2243#issuecomment-912547497",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
    "id": 912547497,
    "node_id": "IC_kwDOCD5_Gc42ZF6p",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T13:38:41Z",
    "updated_at": "2021-09-03T13:38:41Z",
    "author_association": "MEMBER",
    "body": "@vasco-santos Can you review? Is this expected behaviour in a normal setting? Is it safe to ignore this error?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/912547497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/912557696",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2243#issuecomment-912557696",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
    "id": 912557696,
    "node_id": "IC_kwDOCD5_Gc42ZIaA",
    "user": {
      "login": "vasco-santos",
      "id": 7295071,
      "node_id": "MDQ6VXNlcjcyOTUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7295071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasco-santos",
      "html_url": "https://github.com/vasco-santos",
      "followers_url": "https://api.github.com/users/vasco-santos/followers",
      "following_url": "https://api.github.com/users/vasco-santos/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasco-santos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasco-santos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasco-santos/subscriptions",
      "organizations_url": "https://api.github.com/users/vasco-santos/orgs",
      "repos_url": "https://api.github.com/users/vasco-santos/repos",
      "events_url": "https://api.github.com/users/vasco-santos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasco-santos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T13:54:06Z",
    "updated_at": "2021-09-03T13:54:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "`Error: Error occurred during XX handshake: Error occurred while verifying signed payload: Peer ID doesn't match libp2p public key.` this should only happen if a peer is advertising addresses with addresses including a different PeerId.\r\n\r\nOther more strange case I can think on top of my head is old PeerStore persisted data where IPs actually match for a different peer.\r\n\r\nMaking this an error test scenario is the best way to try to figure out a more concrete root reason / bug fix. Let me know if you can gather more data",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/912557696/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1560614676",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2243#issuecomment-1560614676",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2243",
    "id": 1560614676,
    "node_id": "IC_kwDOCD5_Gc5dBRcU",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T07:46:07Z",
    "updated_at": "2023-05-24T07:46:07Z",
    "author_association": "MEMBER",
    "body": "Closing issues for specific incidents on old versions of Lodestar, please re-open if it happens with latest stable",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1560614676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
