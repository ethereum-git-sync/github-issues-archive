{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/3099",
  "id": 992476388,
  "node_id": "MDU6SXNzdWU5OTI0NzYzODg=",
  "number": 3099,
  "title": "Unnecessary repeated epoch transitions when node is stuck",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090446,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDQ2",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-medium",
      "name": "prio-medium",
      "color": "fdc09f",
      "default": false,
      "description": "Resolve this some time soon (tm)."
    },
    {
      "id": 2963898184,
      "node_id": "MDU6TGFiZWwyOTYzODk4MTg0",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-performance",
      "name": "scope-performance",
      "color": "980043",
      "default": false,
      "description": "Performance issue and ideas to improve performance."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-09-09T17:45:22Z",
  "updated_at": "2023-05-24T07:53:26Z",
  "closed_at": "2023-05-24T07:53:26Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "<!--NOTE: -->\r\n<!--- General questions should go to the discord chat instead of the issue tracker.-->\r\n\r\n**Describe the bug**\r\n\r\nDue to the invalid head state root issue, our Prater node got stuck for a few days in limbo, memory is stable. However, many epoch transitions are done per epoch (32-50). Maybe the regen is not caching the state after advancing it? Or doesn't know how to query it.\r\n\r\nCheck in the REST API metrics the only external interaction with the node is getProposerDuties, there was no gossip received during that period.\r\n\r\n![Screenshot from 2021-09-09 19-39-55](https://user-images.githubusercontent.com/35266934/132736044-c4b6df04-55ce-411d-8b3b-18e13bb315c0.png)\r\n\r\n![Screenshot from 2021-09-09 19-40-15](https://user-images.githubusercontent.com/35266934/132736065-d97a4545-590a-444a-ac74-10cca180f3ff.png)\r\n\r\n![Screenshot from 2021-09-09 19-40-26](https://user-images.githubusercontent.com/35266934/132736079-57002bc4-590f-4da8-b3da-b2fdd8a38c7c.png)\r\n\r\n\r\n\r\n\r\nNote: prometheus query for epoch transitions per epoch\r\n```\r\nincrease(lodestar_stfn_epoch_transition_seconds_count[384s])\r\n```\r\n\r\n**Expected behavior**\r\n\r\n<!--A clear and concise description of what you expected to happen.-->\r\n\r\n**Steps to Reproduce**\r\n\r\n<!--Steps to reproduce the behavior:\r\n1. Go to '...'\r\n2. Click on '....'\r\n3. Scroll down to '....'\r\n4. See error\r\n-->\r\n\r\n**Screenshots**\r\n\r\n<!--If applicable, add screenshots to help explain your problem.-->\r\n\r\n**Desktop (please complete the following information):**\r\n\r\n- OS: <!--[e.g. ubuntu, OSX High Siera]-->\r\n- Version: <!--[e.g. 22]-->\r\n- Branch: <!--[Master]-->\r\n- Commit hash: <!--[e8232]-->\r\n",
  "closed_by": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1560624916",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/3099#issuecomment-1560624916",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3099",
    "id": 1560624916,
    "node_id": "IC_kwDOCD5_Gc5dBT8U",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T07:53:26Z",
    "updated_at": "2023-05-24T07:53:26Z",
    "author_association": "MEMBER",
    "body": "Closing issues for specific incidents on old versions of Lodestar, please re-open if it happens with latest stable\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1560624916/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
