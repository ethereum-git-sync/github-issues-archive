{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/2215",
  "id": 837452280,
  "node_id": "MDU6SXNzdWU4Mzc0NTIyODA=",
  "number": 2215,
  "title": "Keep at least 10% of outbound peers",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090447,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDQ3",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-high",
      "name": "prio-high",
      "color": "fd9579",
      "default": false,
      "description": "Resolve issues as soon as possible."
    },
    {
      "id": 1636911745,
      "node_id": "MDU6TGFiZWwxNjM2OTExNzQ1",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/status-blocked",
      "name": "status-blocked",
      "color": "d53e4f",
      "default": false,
      "description": "This is blocked by another issue that requires resolving first."
    },
    {
      "id": 4116819988,
      "node_id": "LA_kwDOCD5_Gc71YbAU",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-security",
      "name": "scope-security",
      "color": "980043",
      "default": false,
      "description": "Issues that fix security issues: DOS, key leak, CVEs."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-03-22T08:19:38Z",
  "updated_at": "2022-12-24T15:26:15Z",
  "closed_at": "2022-12-24T15:26:15Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "If you run current master with ports open the node will eventually be connected to 100% of inbound peers.\r\n\r\nFrom https://discord.com/channels/595666850260713488/646778960830660623/811507775389696050\r\n\r\n> - Is there any reason or issue to keep a certain ratio of inbound vs outbound peers? i.e. any issues with having ~100% of your peers inbound?\r\n> - You'd be much more susceptible to an eclipse attack in that scenario.  Having a minimum number of outbound peers ensures that you chose at least some of your peers.\r\n> - What specific numbers are you targeting in your implmentation?\r\n> - I don’t remember off the top of my head. I think it’s 10% are entirely randomly selected outbound connections.",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1172397696",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2215#issuecomment-1172397696",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215",
    "id": 1172397696,
    "node_id": "IC_kwDOCD5_Gc5F4V6A",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-01T14:16:53Z",
    "updated_at": "2022-07-05T13:12:07Z",
    "author_association": "MEMBER",
    "body": "May want to wait till libp2p ESM is merged. cc: @wemeetagain \r\n\r\n- blocked by https://github.com/ChainSafe/lodestar/pull/4114",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1172397696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1175178110",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2215#issuecomment-1175178110",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2215",
    "id": 1175178110,
    "node_id": "IC_kwDOCD5_Gc5GC8t-",
    "user": {
      "login": "achingbrain",
      "id": 665810,
      "node_id": "MDQ6VXNlcjY2NTgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/665810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achingbrain",
      "html_url": "https://github.com/achingbrain",
      "followers_url": "https://api.github.com/users/achingbrain/followers",
      "following_url": "https://api.github.com/users/achingbrain/following{/other_user}",
      "gists_url": "https://api.github.com/users/achingbrain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achingbrain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achingbrain/subscriptions",
      "organizations_url": "https://api.github.com/users/achingbrain/orgs",
      "repos_url": "https://api.github.com/users/achingbrain/repos",
      "events_url": "https://api.github.com/users/achingbrain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achingbrain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-05T15:13:38Z",
    "updated_at": "2022-07-05T15:13:46Z",
    "author_association": "NONE",
    "body": "When you dial a peer, it's possible to temporarily exceed the connection limit.  When the node [notices](https://github.com/libp2p/js-libp2p/blob/master/src/connection-manager/index.ts#L572-L575) the connection limit has been exceeded, it'll [close some connections](https://github.com/libp2p/js-libp2p/blob/master/src/connection-manager/index.ts#L578-L650) to bring itself back under the limit.\r\n\r\nConnected peers will be ranked in terms of importance in order to choose connections to close, starting with low-importance connections.\r\n\r\nYou can [tag peers](https://github.com/libp2p/js-libp2p/blob/master/doc/API.md#peerstoretagpeer) with a value - if we are connected to this peer, the value is used to sort the peers before closing connections.\r\n\r\nIn the future we may apply other metrics - close incoming connections first, or connections with fewer streams, etc, but at the moment it's a simple sum of all the tag values.\r\n\r\nSo, gossipsub might want to tag it's mesh peers with a high value to prevent those connections being closed, and it may also wish to untag peers that are no longer in the mesh to allow those connections to be closed.\r\n\r\nYou can also tag a peer with the special [`'keep-alive'`](https://github.com/libp2p/js-libp2p-interfaces/blob/master/packages/interface-peer-store/src/tags.ts#L2) tag which will try to dial the peer when the node starts up (e.g. after a restart) and, at some point in the future, re-open a connection to that peer if it's closed for whatever reason.\r\n\r\nTags are new in the ESM version and will be released as part of `libp2p@0.38.x` (installable with `npm i libp2p@next` right now).",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1175178110/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
