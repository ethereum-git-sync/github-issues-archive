{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5343",
  "id": 1654505460,
  "node_id": "I_kwDOCD5_Gc5inb_0",
  "number": 5343,
  "title": "Track Missed blocks",
  "user": {
    "login": "maschad",
    "id": 9755286,
    "node_id": "MDQ6VXNlcjk3NTUyODY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9755286?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maschad",
    "html_url": "https://github.com/maschad",
    "followers_url": "https://api.github.com/users/maschad/followers",
    "following_url": "https://api.github.com/users/maschad/following{/other_user}",
    "gists_url": "https://api.github.com/users/maschad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maschad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maschad/subscriptions",
    "organizations_url": "https://api.github.com/users/maschad/orgs",
    "repos_url": "https://api.github.com/users/maschad/repos",
    "events_url": "https://api.github.com/users/maschad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maschad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2966148095,
      "node_id": "MDU6TGFiZWwyOTY2MTQ4MDk1",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-metrics",
      "name": "scope-metrics",
      "color": "980043",
      "default": false,
      "description": "All issues with regards to the exposed metrics."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-04-04T20:05:45Z",
  "updated_at": "2023-05-29T17:45:07Z",
  "closed_at": "2023-05-29T17:45:06Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!--NOTE:\r\n- General questions should go to the discord chat instead of the issue tracker.\r\n-->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\n\r\n~~If a validator consistently misses blocks, their penalties will increase, and they may eventually be kicked out of the validator pool altogether. Therefore we want to track missed blocks.~~\r\n\r\nWe want to replicate the [beaconcha.in block chart](https://beaconcha.in/charts/blocks) for local validators.\r\n\r\n<!--A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]-->\r\n\r\n**Describe the solution you'd like**\r\n<!--A clear and concise description of what you want to happen.-->\r\n\r\nFollowing up from https://github.com/ChainSafe/lodestar/pull/5309  If a validator fails to propose or attest to a block at the appropriate time, it is considered a missed block. A missed block can occur for several reasons, and so we have to instrument all possible areas where it could occur. Such as Networking errors, failure to publish, failure during `processBlock`  or other bugs.\r\n\r\n\r\n\r\n**Additional context**\r\n<!--Add any other context or screenshots about the feature request here.-->\r\nRelated to #5255 ",
  "closed_by": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496721681",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5343#issuecomment-1496721681",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343",
    "id": 1496721681,
    "node_id": "IC_kwDOCD5_Gc5ZNikR",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T23:30:27Z",
    "updated_at": "2023-04-04T23:30:27Z",
    "author_association": "MEMBER",
    "body": "Missing blocks does not incur any penalties on the validator. Only missing attestation and sync committee duties incur penalties which we already track. Regarding missed blocks\r\n- failure to publish: already tracked\r\n- failure during processBlock: already tracked\r\n- Networking errors: not really possible to track since a single node has no visibility what happens on the rest of the network. The only data points you have are:\r\n  - seeing the gossip message containing your block sent again to you; which does not say much since there could be a network partition and the block still not reach the next proposer\r\n  - checking that the block is included in the chain after a sufficiently large re-org safe distance. This is what this metric intended to track https://github.com/ChainSafe/lodestar/issues/5255 basically means:\r\n    - orphaned: network observer has **seen** the block but it's not included in the canonical chain\r\n    - missed: network observer has **not seen** the block at all",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496721681/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497632428",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5343#issuecomment-1497632428",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343",
    "id": 1497632428,
    "node_id": "IC_kwDOCD5_Gc5ZRA6s",
    "user": {
      "login": "maschad",
      "id": 9755286,
      "node_id": "MDQ6VXNlcjk3NTUyODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9755286?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maschad",
      "html_url": "https://github.com/maschad",
      "followers_url": "https://api.github.com/users/maschad/followers",
      "following_url": "https://api.github.com/users/maschad/following{/other_user}",
      "gists_url": "https://api.github.com/users/maschad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maschad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maschad/subscriptions",
      "organizations_url": "https://api.github.com/users/maschad/orgs",
      "repos_url": "https://api.github.com/users/maschad/repos",
      "events_url": "https://api.github.com/users/maschad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maschad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-05T14:56:38Z",
    "updated_at": "2023-04-05T14:56:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Missing blocks does not incur any penalties on the validator. Only missing attestation and sync committee duties incur penalties which we already track. \r\n\r\nThanks for clarifying, chatGPT let me down here, should have crossed checked in [the knowledge base](https://kb.beaconcha.in/rewards-and-penalties#block-reward) \r\n\r\n> checking that the block is included in the chain after a sufficiently large re-org safe distance.\r\n\r\nWhat would you define as a sufficiently large re-org distance? I suppose 7 blocks since that is the largest reorg to date.\r\n\r\n> missed: network observer has not seen the block at all\r\n\r\nUnderstood, I'll update that PR. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497632428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497671047",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5343#issuecomment-1497671047",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343",
    "id": 1497671047,
    "node_id": "IC_kwDOCD5_Gc5ZRKWH",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-05T15:19:36Z",
    "updated_at": "2023-04-05T15:19:36Z",
    "author_association": "MEMBER",
    "body": "> or attest to a block at the appropriate time\r\n\r\nthis is also not related to missed blocks, attestations are not done per block but per slot which might or might not a include block (`beacon_block_root`, LMD GHOST vote)",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497671047/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1567380230",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5343#issuecomment-1567380230",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5343",
    "id": 1567380230,
    "node_id": "IC_kwDOCD5_Gc5dbFMG",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-29T17:45:06Z",
    "updated_at": "2023-05-29T17:45:06Z",
    "author_association": "MEMBER",
    "body": "Resolved with #5538 ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1567380230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
