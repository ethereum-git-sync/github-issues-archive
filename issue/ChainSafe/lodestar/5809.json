{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5809",
  "id": 1823800876,
  "node_id": "I_kwDOCD5_Gc5stP4s",
  "number": 5809,
  "title": "Broken `trace` logging",
  "user": {
    "login": "matthewkeil",
    "id": 18608739,
    "node_id": "MDQ6VXNlcjE4NjA4NzM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matthewkeil",
    "html_url": "https://github.com/matthewkeil",
    "followers_url": "https://api.github.com/users/matthewkeil/followers",
    "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
    "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
    "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
    "repos_url": "https://api.github.com/users/matthewkeil/repos",
    "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 5670219610,
      "node_id": "LA_kwDOCD5_Gc8AAAABUfivWg",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-bug",
      "name": "meta-bug",
      "color": "E79553",
      "default": false,
      "description": "Issues that identify a bug and require a fix."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2023-07-27T07:41:20Z",
  "updated_at": "2023-10-01T09:23:03Z",
  "closed_at": "2023-10-01T09:23:03Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nIt appears that trace logging is broken.  Attempted to add a `logger.trace()` call and e2e tests and the node broke when deployed.\r\n\r\nI removed the call and the error went away.  I changed the error to `debug` and the error also went away.  It looks like the name was changed from `silly` to `trace` in #4539 and winston expects the string `silly` to be passed.\r\n\r\nWe are [setting](https://github.com/ChainSafe/lodestar/blob/2c3d7e14f0082cfe70156e55a9213db952f815c4/packages/logger/src/winston.ts#L56) the [`logLevelNum`](https://github.com/ChainSafe/lodestar/blob/2c3d7e14f0082cfe70156e55a9213db952f815c4/packages/logger/src/interface.ts#L4) which the [docs say](https://github.com/winstonjs/winston#using-custom-logging-levels) should work but it may not be set correctly.\r\n\r\n```sh\r\nTypeError: colors[Colorizer.allColors[lookup]] is not a function\r\n    at Colorizer.colorize (/usr/src/lodestar/node_modules/logform/colorize.js:73:49)\r\n    at Colorizer.transform (/usr/src/lodestar/node_modules/logform/colorize.js:98:25)\r\n    at Format.transform (/usr/src/lodestar/node_modules/logform/combine.js:20:24)\r\n    at DerivedLogger._transform (/usr/src/lodestar/node_modules/winston/lib/winston/logger.js:313:29)\r\n    at DerivedLogger.Transform._read (/usr/src/lodestar/node_modules/readable-stream/lib/_stream_transform.js:177:10)\r\n    at DerivedLogger.Transform._write (/usr/src/lodestar/node_modules/readable-stream/lib/_stream_transform.js:164:83)\r\n    at doWrite (/usr/src/lodestar/node_modules/readable-stream/lib/_stream_writable.js:409:139)\r\n    at writeOrBuffer (/usr/src/lodestar/node_modules/readable-stream/lib/_stream_writable.js:398:5)\r\n    at DerivedLogger.Writable.write (/usr/src/lodestar/node_modules/readable-stream/lib/_stream_writable.js:307:11)\r\n    at DerivedLogger.log (/usr/src/lodestar/node_modules/winston/lib/winston/logger.js:225:14) colors[Colorizer.allColors[lookup]] is not a function\r\n```\n\n### Expected behavior\n\nA trace log should work and not break the other log levels\n\n### Steps to reproduce\n\n1. Create a `logger.trace`\r\n2. Run e2e tests and should work correctly \n\n### Additional context\n\n_No response_\n\n### Operating system\n\nLinux\n\n### Lodestar version or commit hash\n\nunstable",
  "closed_by": {
    "login": "matthewkeil",
    "id": 18608739,
    "node_id": "MDQ6VXNlcjE4NjA4NzM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matthewkeil",
    "html_url": "https://github.com/matthewkeil",
    "followers_url": "https://api.github.com/users/matthewkeil/followers",
    "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
    "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
    "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
    "repos_url": "https://api.github.com/users/matthewkeil/repos",
    "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653108720",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1653108720",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1653108720,
    "node_id": "IC_kwDOCD5_Gc5iiG_w",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-27T08:07:20Z",
    "updated_at": "2023-07-27T08:07:20Z",
    "author_association": "MEMBER",
    "body": "It looks like the ColorizeOptions expect a map with matching levels for color lookup",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653108720/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653170907",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1653170907",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1653170907,
    "node_id": "IC_kwDOCD5_Gc5iiWLb",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-27T08:43:57Z",
    "updated_at": "2023-07-27T08:43:57Z",
    "author_association": "MEMBER",
    "body": "Last time we had discussion on this in https://github.com/ChainSafe/lodestar/pull/5299 there was no push towards adding `trace`, it is not part of the [Logging policy](https://github.com/ChainSafe/lodestar/blob/unstable/CONTRIBUTING.md#logging-policy). It is not supposed to work right now and not used anywhere. \r\n\r\nAs far as I understand the renaming in https://github.com/ChainSafe/lodestar/pull/4539 was just done so you could set `--logLevel trace` on CLI, see issue https://github.com/ChainSafe/lodestar/issues/4536.\r\n\r\nBefore looking into fixing the issue here, I would suggest we first discuss if trace is a log level we should support and then add it to logging policy first.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653170907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653189595",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1653189595",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1653189595,
    "node_id": "IC_kwDOCD5_Gc5iiavb",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-27T08:56:16Z",
    "updated_at": "2023-07-27T08:56:16Z",
    "author_association": "MEMBER",
    "body": "We should remove the option if we are not going to use it.  Broke the node when i deployed trying to trace the network worker message latency to figure out why the grafana dashboard wasnt working.  Or fix it.  I figured out how to and was pretty easy.  Just needed to pass a map to the color options.  Already fixed on `mkeil/fix-log-trace` branch.  Just need to update the unit tests.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1653189595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1657843388",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1657843388",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1657843388,
    "node_id": "IC_kwDOCD5_Gc5i0K68",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-31T07:43:30Z",
    "updated_at": "2023-07-31T07:43:30Z",
    "author_association": "MEMBER",
    "body": "From the agreed logging policy we do not support trace right?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1657843388/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1660244304",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1660244304",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1660244304,
    "node_id": "IC_kwDOCD5_Gc5i9VFQ",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T12:47:06Z",
    "updated_at": "2023-08-01T12:47:06Z",
    "author_association": "MEMBER",
    "body": "Currently we do not support trace. It’s not in our contribution md.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1660244304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1660358713",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1660358713",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1660358713,
    "node_id": "IC_kwDOCD5_Gc5i9xA5",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T13:42:18Z",
    "updated_at": "2023-08-01T13:42:18Z",
    "author_association": "MEMBER",
    "body": "We should remove it from types to prevent accidental usage but still allow it to be passed through CLI to not break the use case mentioned in https://github.com/ChainSafe/lodestar/issues/4536.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1660358713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1742019298",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5809#issuecomment-1742019298",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5809",
    "id": 1742019298,
    "node_id": "IC_kwDOCD5_Gc5n1Rri",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-01T09:23:03Z",
    "updated_at": "2023-10-01T09:23:03Z",
    "author_association": "MEMBER",
    "body": "Closing.  Removed `trace` log level in #5861 ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1742019298/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
