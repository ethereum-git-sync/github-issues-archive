{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4785",
  "id": 1456620814,
  "node_id": "I_kwDOCD5_Gc5W0kUO",
  "number": 4785,
  "title": "Improve validator status logging ",
  "user": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1478321239,
      "node_id": "MDU6TGFiZWwxNDc4MzIxMjM5",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-discussion",
      "name": "meta-discussion",
      "color": "a6bddb",
      "default": false,
      "description": "Indicates a topic that requires input from various developers."
    },
    {
      "id": 4116885308,
      "node_id": "LA_kwDOCD5_Gc71Yq88",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-ux",
      "name": "scope-ux",
      "color": "980043",
      "default": false,
      "description": "Issues for CLI UX or general consumer UX."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-11-19T18:56:48Z",
  "updated_at": "2023-03-03T19:56:02Z",
  "closed_at": "2023-03-03T19:56:02Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "**Is your feature request related to a problem? Please describe.**\r\n\r\nThere has been multiple occasions where feedback was given to clarify the meaning of the `Discovered new validators = x` as to what this statement actually means for the user. \r\n\r\nPlease correct if not true: Currently, this line is logged when a user starts the validator client. When the user's validator pubkey is active (deposit is recognized from logs) on the beacon chain, that increments this count by 1. \r\n\r\nHowever there is a period of time, generally when deposits have been made recently on the execution chain (e.g. a new staker and now setting up beacon infrastructure), it can be misleading to see their logs state:\r\n\r\n```\r\ninfo: 3 local keystores\r\ninfo: 0x000000...\r\ninfo: 0x000001...\r\ninfo: 0x000002...\r\ninfo: Discovered new validator count = 0\r\n```\r\n\r\nAlthough we've clearly stated that the validator client recognizes 3 local keystores successfully decrypted and ready to process duties once activated, `Discovered new validator count = 0` in its current phrasing is counter-intuitive as these are technically new validators that haven't been discovered _yet_ by the beacon chain. This is a sensitive time period for stakers and better UX is justified to reduce confusion. This confusion is common as users generally make deposits to their validators slightly before, during or after setting up their beacon infrastructure. \r\n\r\nIn addition, if a user adds an additional key to their client, the way it's phrased confuses a user about whether it reflects \"new validators\" added since the previous run.  \r\n\r\nThis is not an issue after pubkeys have been recognized and activated on the beacon chain since the proper number of validator keys will be reflected in the log.\r\n\r\n**Describe the solution you'd like**\r\n\r\nWould like to see if there is better phrasing to reflect the reality of what we're logging to the user. An example:\r\n`Validators currently activated on the beacon chain = x`\r\n\r\nDo we need to add a small disclaimer for users about needing to wait for some time so it can be activated?\r\n`(New deposits may take some time for activation)` \r\n\r\n**Additional context**\r\n![image](https://user-images.githubusercontent.com/58080811/202866891-52040201-3cae-4986-ad6e-b0a29aa658e5.png)\r\n\r\n",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1322432566",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4785#issuecomment-1322432566",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785",
    "id": 1322432566,
    "node_id": "IC_kwDOCD5_Gc5O0rg2",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-21T17:44:49Z",
    "updated_at": "2022-11-21T17:44:49Z",
    "author_association": "MEMBER",
    "body": "> Please correct if not true: Currently, this line is logged when a user starts the validator client. When the user's validator pubkey is active (deposit is recognized from logs) on the beacon chain, that increments this count by 1\r\n\r\nNot really. The validator knows about the public key of a validator and asks the beacon node to resolve that public key to and index. When the vc prints \"discovered\" means that it can resolve pubkey to index. In that call the beacon respond also with the status of the validator (pending, active, exited) so the vc could also print that.\r\n\r\n@philknows Could you check what Prysm or Lighthouse log in that case? Maybe being closer to clients people are familiar with is a good starting point.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1322432566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1324702738",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4785#issuecomment-1324702738",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785",
    "id": 1324702738,
    "node_id": "IC_kwDOCD5_Gc5O9VwS",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-23T08:30:44Z",
    "updated_at": "2022-11-23T08:34:42Z",
    "author_association": "MEMBER",
    "body": "For Lighthouse, it looks like it does a validator discovery, logs the voting pubkeys, then logs the initialized validators. When tested, the following logs show up for 2 validators already activated by the beacon chain. It also then logs the validator config with fee_recipient, validator index, pubkey for each of the validators:\r\n\r\n```\r\nNov 23 08:24:23.190 INFO Logging to file                         path: \"/root/.lighthouse/goerli/validators/logs/validator.log\"\r\nNov 23 08:24:23.190 INFO Lighthouse started                      version: Lighthouse/v3.2.1-6d5a2b5\r\nNov 23 08:24:23.190 INFO Configured for network                  name: goerli\r\nNov 23 08:24:23.190 INFO Starting validator client               validator_dir: \"/root/.lighthouse/goerli/validators\", beacon_nodes: [\"http://localhost:5052/\"]\r\nNov 23 08:24:23.190 INFO HTTP metrics server is disabled\r\nNov 23 08:24:23.200 INFO Completed validator discovery           new_validators: 0\r\nNov 23 08:24:23.744 INFO Enabled validator                       voting_pubkey: 0x0001, signing_method: local_keystore\r\nNov 23 08:24:23.744 INFO Enabled validator                       voting_pubkey: 0x0002, signing_method: local_keystore\r\nNov 23 08:24:23.745 INFO Initialized validators                  enabled: 2, disabled: 0\r\nNov 23 08:24:23.757 INFO Connected to beacon node                endpoint: http://localhost:5052/, version: Lighthouse/v3.2.1-6d5a2b5/x86_64-linux\r\nNov 23 08:24:23.758 INFO Initialized beacon node connections     available: 1, total: 1\r\nNov 23 08:24:23.758 INFO Loaded validator keypair store          voting_validators: 2\r\nNov 23 08:24:23.764 INFO Validator exists in beacon chain        fee_recipient: 0x0000…abcd, validator_index: 123456, pubkey: 0x00001, service: duties\r\nNov 23 08:24:23.764 INFO Validator exists in beacon chain        fee_recipient: 0x0000…abcd, validator_index: 123457, pubkey: 0x00001, service: duties\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1324702738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1324789207",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4785#issuecomment-1324789207",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785",
    "id": 1324789207,
    "node_id": "IC_kwDOCD5_Gc5O9q3X",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-23T09:47:47Z",
    "updated_at": "2022-11-23T09:47:47Z",
    "author_association": "MEMBER",
    "body": "For Prysm, it's interesting as they don't do any counts as part of their logging. It just logs out the keys you have locally. If there's any keys that are not activated, it will just log `Waiting for deposit to be observed by beacon node` and if it's activated, will just log `validator: Validator activated index=123456 publicKey=0x00000000001` for each one that's activated.\r\n\r\n```\r\n[2022-11-23 09:40:13]  INFO node: Opened validator wallet keymanager-kind=direct wallet=/wallet/direct\r\n[2022-11-23 09:40:13]  WARN node: Slashing protection file /validatorDB/validator.db is missing.\r\nIf you changed your --wallet-dir or --datadir, please copy your previous \"validator.db\" file into your current --datadir.\r\nDisregard this warning if this is the first time you are running this set of keys.\r\n[2022-11-23 09:40:13]  INFO node: Checking DB databasePath=/validatorDB\r\nAdding optimizations for validator slashing protection 100% [=========]  [0s:0s]\r\n[2022-11-23 09:40:13]  WARN validator: You are using an insecure gRPC connection. If you are running your beacon node and validator on the same machines, you can ignore this message. If you want to know how to enable secure connections, see: https://docs.prylabs.network/docs/prysm-usage/secure-grpc\r\n[2022-11-23 09:40:13]  INFO node: Starting validator node version=Prysm/v3.1.2-rc.2/648ab9f2c249f1d06d0aad4328e8df429ceaf66c. Built at: 2022-10-27 14:53:24+00:00\r\n[2022-11-23 09:40:13]  INFO validator: Syncing with beacon node to align on chain genesis info\r\n[2022-11-23 09:40:13]  INFO validator: Beacon chain started genesisTime=2021-03-23 14:00:00 +0000 UTC\r\n[2022-11-23 09:40:14]  INFO validator: Validating for public key publicKey=0x00000000001\r\n[2022-11-23 09:40:14]  INFO validator: Validating for public key publicKey=0x00000000002\r\n[2022-11-23 09:40:14]  INFO validator: Waiting for deposit to be observed by beacon node pubKey=0x0000000003 status=UNKNOWN_STATUS\r\n[2022-11-23 09:40:14]  INFO validator: Validator activated index=123456 publicKey=0x00000000001\r\n[2022-11-23 09:40:14]  INFO validator: Validator activated index=123457 publicKey=0x00000000002\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1324789207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1348892078",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4785#issuecomment-1348892078",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4785",
    "id": 1348892078,
    "node_id": "IC_kwDOCD5_Gc5QZnWu",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-13T16:04:19Z",
    "updated_at": "2022-12-13T16:04:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "i think every epoch we should log the pubkey count with the validator grouped by status as lighthouse is doing",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1348892078/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
