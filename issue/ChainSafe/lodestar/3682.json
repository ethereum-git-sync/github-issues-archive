{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/3682",
  "id": 1118299111,
  "node_id": "I_kwDOCD5_Gc5Cp-Pn",
  "number": 3682,
  "title": "Add good full coverage beacon API tests",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090446,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDQ2",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-medium",
      "name": "prio-medium",
      "color": "fdc09f",
      "default": false,
      "description": "Resolve this some time soon (tm)."
    },
    {
      "id": 3054720694,
      "node_id": "MDU6TGFiZWwzMDU0NzIwNjk0",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-technical-debt",
      "name": "meta-technical-debt",
      "color": "67a9cf",
      "default": false,
      "description": "Issues introducing or resolving technical debts."
    },
    {
      "id": 4118053382,
      "node_id": "LA_kwDOCD5_Gc71dIIG",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-testing",
      "name": "scope-testing",
      "color": "980043",
      "default": false,
      "description": "Issues for adding test coverage, fixing existing tests or testing strategies."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/milestones/17",
    "html_url": "https://github.com/ChainSafe/lodestar/milestone/17",
    "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/milestones/17/labels",
    "id": 8046666,
    "node_id": "MI_kwDOCD5_Gc4AeshK",
    "number": 17,
    "title": "v1.0.0 pre-merge",
    "description": "",
    "creator": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 2,
    "closed_issues": 3,
    "state": "closed",
    "created_at": "2022-06-03T14:26:30Z",
    "updated_at": "2022-12-24T03:35:05Z",
    "due_on": "2022-08-01T07:00:00Z",
    "closed_at": "2022-09-02T18:41:29Z"
  },
  "comments": 1,
  "created_at": "2022-01-29T18:55:16Z",
  "updated_at": "2023-02-14T05:20:29Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "<!--\r\nNOTE:\r\n- General questions should go to the discord chat instead of the issue tracker.\r\n-->\r\n\r\n**What is your question?**\r\n\r\nCurrent tests for the beacon API are of sub-optimal quality:\r\n- Very limited coverage\r\n- No assurance that all and future new endpoints are tested\r\n- Require import stubbing\r\n- Extensive use of brittle stubs: which require big diffs when modifying unrelated cost.\r\n\r\nIn my subjective opinion the current test suite has a very high cost of maintenance with very little return in ensuring the API is correct.\r\n\r\n**Proposed solution**\r\n\r\nProper tests for a the beacon API should:\r\n- Have full coverage\r\n- Ensure programmatically that all endpoints current and future are tested\r\n- Be tested against a full BeaconChain instance without stubbing and with real data. We are already doing this for BeaconChain validation and such data is extremely fast to produce and to run tests against.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682/reactions",
    "total_count": 4,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 4,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1132545141",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/3682#issuecomment-1132545141",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/3682",
    "id": 1132545141,
    "node_id": "IC_kwDOCD5_Gc5DgUR1",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-20T07:01:48Z",
    "updated_at": "2022-05-20T07:06:36Z",
    "author_association": "MEMBER",
    "body": "More disabled tests\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/5d086b58a20f57c69f1d2cc90d5bf785f851f535/packages/lodestar/test/unit/api/impl/beacon/state/fork.test.ts#L9-L10\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/5d086b58a20f57c69f1d2cc90d5bf785f851f535/packages/lodestar/test/unit/api/impl/beacon/pool/pool.test.ts#L25-L26\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/5d086b58a20f57c69f1d2cc90d5bf785f851f535/packages/lodestar/test/unit/api/impl/debug/index.test.ts#L20-L21\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/5d086b58a20f57c69f1d2cc90d5bf785f851f535/packages/lodestar/test/unit/chain/factory/block/blockAssembly.test.ts#L21-L22",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1132545141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
