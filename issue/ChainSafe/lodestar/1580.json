{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/1580",
  "id": 706995287,
  "node_id": "MDU6SXNzdWU3MDY5OTUyODc=",
  "number": 1580,
  "title": "Error updating eth1 chain cache",
  "user": {
    "login": "SeaMonkey82",
    "id": 20866869,
    "node_id": "MDQ6VXNlcjIwODY2ODY5",
    "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SeaMonkey82",
    "html_url": "https://github.com/SeaMonkey82",
    "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
    "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
    "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
    "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
    "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
    "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-09-23T03:33:13Z",
  "updated_at": "2020-09-25T04:39:02Z",
  "closed_at": "2020-09-25T04:39:02Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n```\r\n2020-09-22 23:11:36  [ETH1]            error: Error updating eth1 chain cache Error: missing response (requestBody=\"{\\\"method\\\":\\\"eth_blockNumber\\\",\\\"params\\\":[],\\\"id\\\":958516,\\\"jsonrpc\\\":\\\"2.0\\\"}\", requestMethod=\"POST\", serverError={\"errno\":\"ECONNREFUSED\",\"code\":\"ECONNREFUSED\",\"syscall\":\"connect\",\"address\":\"127.0.0.1\",\"port\":8545}, url=\"http://localhost:8545\", code=SERVER_ERROR, version=web/5.0.1)\r\nError: missing response (requestBody=\"{\\\"method\\\":\\\"eth_blockNumber\\\",\\\"params\\\":[],\\\"id\\\":958516,\\\"jsonrpc\\\":\\\"2.0\\\"}\", requestMethod=\"POST\", serverError={\"errno\":\"ECONNREFUSED\",\"code\":\"ECONNREFUSED\",\"syscall\":\"connect\",\"address\":\"127.0.0.1\",\"port\":8545}, url=\"http://localhost:8545\", code=SERVER_ERROR, version=web/5.0.1)\r\n    at Logger.makeError (/home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/logger/lib/index.js:179:21)\r\n    at Logger.throwError (/home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/logger/lib/index.js:188:20)\r\n    at /home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/web/lib/index.js:142:36\r\n    at step (/home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/web/lib/index.js:33:23)\r\n    at Object.throw (/home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/web/lib/index.js:14:53)\r\n    at rejected (/home/seamonkey/Downloads/lodestar/node_modules/@ethersproject/web/lib/index.js:6:65)\r\n    at runMicrotasks (<anonymous>)\r\n    at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n```\r\n\r\n**Expected behavior**\r\nNo error\r\n\r\n**Steps to Reproduce**\r\nGoerli Geth launched with...\r\n```\r\ngeth --goerli --datadir=\"$HOME/Goerli\" --http --http.addr=earth.thegalaxy --http.port=8545 --ws --ws.addr=earth.thegalaxy --ws.port=8546 --syncmode=full --nat=extip:1.2.3.4 --port=13431\r\n```\r\nearth.thegalaxy resolves to 192.168.0.2\r\n```\r\n➜  lodestar git:(master) nslookup earth.thegalaxy\r\nServer:         192.168.0.1\r\nAddress:        192.168.0.1#53\r\n\r\nName:   earth.thegalaxy\r\nAddress: 192.168.0.2\r\n```\r\n\r\nBeacon launched with...\r\n```\r\nnode --trace-deprecation --stack-size=6000 --max-old-space-size=9192 ./packages/lodestar-cli/bin/lodestar beacon --rootDir=/home/seamonkey/.eth2/lodestar --metrics.enabled=true --metrics.serverPort=8010 --testnet=medalla --network.discv5.bindAddr='/ip4/0.0.0.0/udp/13430' --network.localMultiaddrs='/ip4/0.0.0.0/tcp/13430' --api.enabled=true --enr-ip='1.2.3.4' --logFile=/home/seamonkey/.eth2/lodestar/lodestar.log --network.maxPeers=1000 --api.port=9596 --eth1.enabled=true --eth1.provider.url=http://192.168.0.2:8545\r\n```\r\n\r\n```\r\n➜  lodestar git:(master) ss -tulnp | grep geth\r\nudp   UNCONN 0      0                                      *:13431            *:*         users:((\"geth\",pid=11327,fd=62))\r\ntcp   LISTEN 0      4096                         192.168.0.2:8545       0.0.0.0:*         users:((\"geth\",pid=11327,fd=39))\r\ntcp   LISTEN 0      4096                         192.168.0.2:8546       0.0.0.0:*         users:((\"geth\",pid=11327,fd=68))\r\ntcp   LISTEN 0      4096                                   *:13431            *:*         users:((\"geth\",pid=11327,fd=61))\r\n```\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Linux Mint\r\n - Version: 20\r\n - Branch: Master\r\n - Commit hash: 7885cc5370d158577b72286f1ea81f22e213aadd\r\n",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697150326",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1580#issuecomment-697150326",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580",
    "id": 697150326,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzE1MDMyNg==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T05:56:19Z",
    "updated_at": "2020-09-23T05:56:19Z",
    "author_association": "MEMBER",
    "body": "@SeaMonkey82 The flag to for the eth1 provider URL is not right, can you try with this one?\r\n```\r\n--eth1.providerUrl=http://192.168.0.2:8545\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697150326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697152403",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1580#issuecomment-697152403",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580",
    "id": 697152403,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzE1MjQwMw==",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T06:02:41Z",
    "updated_at": "2020-09-23T06:02:41Z",
    "author_association": "NONE",
    "body": "```\r\nnode --trace-deprecation --stack-size=6000 --max-old-space-size=9192 ./packages/lodestar-cli/bin/lodestar beacon --rootDir=/home/seamonkey/.eth2/lodestar --metrics.enabled=true --metrics.serverPort=8010 --testnet=medalla --network.discv5.bindAddr='/ip4/0.0.0.0/udp/13430' --network.localMultiaddrs='/ip4/0.0.0.0/tcp/13430' --api.enabled=true --enr-ip='1.2.3.4' --logFile=/home/seamonkey/.eth2/lodestar/lodestar.log --network.maxPeers=1000 --api.port=9596 --eth1.enabled=true --eth1.providerUrl=http://192.168.0.2:8545\r\n```\r\n\r\nresults in\r\n\r\n```\r\n2020-09-23 02:00:19  [ETH1]            error: Error updating eth1 chain cache Error: Incorrect data length 72, expect 80\r\nError: Incorrect data length 72, expect 80\r\n    at ContainerStructuralHandler.validateBytes (/home/seamonkey/Downloads/lodestar/node_modules/@chainsafe/ssz/lib/backings/structural/abstract.js:82:13)\r\n    at ContainerStructuralHandler.fromBytes (/home/seamonkey/Downloads/lodestar/node_modules/@chainsafe/ssz/lib/backings/structural/container.js:101:10)\r\n    at ContainerStructuralHandler.deserialize (/home/seamonkey/Downloads/lodestar/node_modules/@chainsafe/ssz/lib/backings/structural/abstract.js:95:17)\r\n    at ContainerType.deserialize (/home/seamonkey/Downloads/lodestar/node_modules/@chainsafe/ssz/lib/types/composite/abstract.js:128:28)\r\n    at Eth1DataRepository.decodeValue (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/db/api/beacon/repositories/abstract.js:59:22)\r\n    at /home/seamonkey/Downloads/lodestar/packages/lodestar/lib/db/api/beacon/repositories/abstract.js:173:42\r\n    at Array.map (<anonymous>)\r\n    at Eth1DataRepository.values (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/db/api/beacon/repositories/abstract.js:173:25)\r\n    at runMicrotasks (<anonymous>)\r\n    at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697152403/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697153575",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1580#issuecomment-697153575",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580",
    "id": 697153575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzE1MzU3NQ==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T06:06:16Z",
    "updated_at": "2020-09-23T06:06:16Z",
    "author_association": "MEMBER",
    "body": "Can you clear the DB if possible?\r\n```\r\nrm -rf /home/seamonkey/.eth2/lodestar/chain-db\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697153575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697154546",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1580#issuecomment-697154546",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1580",
    "id": 697154546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzE1NDU0Ng==",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T06:09:12Z",
    "updated_at": "2020-09-23T06:09:12Z",
    "author_association": "NONE",
    "body": "Cleared the db and ran with the same flags.  Result:\r\n\r\n```\r\n2020-09-23 02:07:59  [ETH1]            error: Error updating eth1 chain cache Error: No deposits found for block range [0, 999]\r\nError: No deposits found for block range [0, 999]\r\n    at getEth1DataForBlocks (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/eth1/utils/eth1Data.js:44:11)\r\n    at runMicrotasks (<anonymous>)\r\n    at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n    at async Eth1DepositsCache.getEth1DataForBlocks (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/eth1/eth1DepositsCache.js:81:12)\r\n    at async Eth1ForBlockProduction.updateBlockCache (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/eth1/eth1ForBlockProduction.js:183:23)\r\n    at async Eth1ForBlockProduction.update (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/eth1/eth1ForBlockProduction.js:136:29)\r\n    at async Eth1ForBlockProduction.runAutoUpdate (/home/seamonkey/Downloads/lodestar/packages/lodestar/lib/eth1/eth1ForBlockProduction.js:116:28)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/697154546/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
