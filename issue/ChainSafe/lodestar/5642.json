{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5642",
  "id": 1756506799,
  "node_id": "I_kwDOCD5_Gc5osiqv",
  "number": 5642,
  "title": "Beacon node active handles after close sequence is completed",
  "user": {
    "login": "nflaig",
    "id": 38436224,
    "node_id": "MDQ6VXNlcjM4NDM2MjI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nflaig",
    "html_url": "https://github.com/nflaig",
    "followers_url": "https://api.github.com/users/nflaig/followers",
    "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
    "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
    "organizations_url": "https://api.github.com/users/nflaig/orgs",
    "repos_url": "https://api.github.com/users/nflaig/repos",
    "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nflaig/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 5670219610,
      "node_id": "LA_kwDOCD5_Gc8AAAABUfivWg",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-bug",
      "name": "meta-bug",
      "color": "E79553",
      "default": false,
      "description": "Issues that identify a bug and require a fix."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-06-14T09:57:40Z",
  "updated_at": "2023-10-13T12:26:32Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Describe the bug\r\n\r\nIn some rare cases when the node is running for a longer time it does not exit when receiving a exit signal.\r\n\r\n**Active handles**\r\n\r\n```\r\n[WTF Node?] open handles:\r\n- File descriptors: (note: stdio always exists)\r\n  - fd 2 (tty) (stdio)\r\n  - fd 1 (tty) (stdio)\r\n  - fd 0 (tty)\r\n- Sockets:\r\n  - 135.181.2.45:9000 -> undefined:undefined\r\n  - 135.181.2.45:9000 -> undefined:undefined\r\n.... (45 more)\r\n  - 135.181.2.45:9000 -> undefined:undefined\r\n  - 135.181.2.45:9000 -> 57.128.86.167:45906\r\n  - 135.181.2.45:9000 -> 34.222.49.115:9252\r\n- Servers:\r\n  - 0.0.0.0:9000 (TCP)\r\n    - Listeners:\r\n      - connection: bound onSocket @ file:///home/devops/goerli/lodestar/node_modules/@libp2p/tcp/src/listener.ts:78\r\n- Timers:\r\n  - (30000 ~ 30 s) (anonymous) @ /home/devops/goerli/lodestar/node_modules/retimer/retimer.js:25\r\n```\r\n\r\nThe Sockets that show `135.181.2.45:9000 -> undefined:undefined` can probably be ignored as those are also there if beacon node exits correctly.\r\n\r\n\r\n**Debug logs** \r\n\r\n```\r\nJun-14 09:58:42.886[network]       verbose: Failed to send goodbye peer=16...3dHdMu Timeout\r\nError: Timeout\r\n    at timeoutPromise (file:///home/devops/goerli/lodestar/packages/utils/src/timeout.ts:15:11)\r\n    at runNextTicks (node:internal/process/task_queues:60:5)\r\n    at listOnTimeout (node:internal/timers:538:9)\r\n    at processTimers (node:internal/timers:512:7)\r\n    at withTimeout (file:///home/devops/goerli/lodestar/packages/utils/src/timeout.ts:19:12)\r\n    at PeerManager.goodbyeAndDisconnect (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/peers/peerManager.ts:648:7)\r\n    at async Promise.all (index 50)\r\n    at PeerManager.goodbyeAndDisconnectAllPeers (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/peers/peerManager.ts:223:5)\r\n    at NetworkCore.close (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/core/networkCore.ts:255:5)\r\n    at Network.close (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/network.ts:197:5)\r\nJun-14 09:58:42.887[network]       verbose: Req  done method=goodbye, version=1, encoding=ssz_snappy, client=Lighthouse, peer=16...3dHdMu, requestId=1769\r\nJun-14 09:58:42.887[network]       verbose: Failed to send goodbye peer=16...GW2Ein Timeout\r\nError: Timeout\r\n    at timeoutPromise (file:///home/devops/goerli/lodestar/packages/utils/src/timeout.ts:15:11)\r\n    at withTimeout (file:///home/devops/goerli/lodestar/packages/utils/src/timeout.ts:19:12)\r\n    at PeerManager.goodbyeAndDisconnect (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/peers/peerManager.ts:648:7)\r\n    at async Promise.all (index 54)\r\n    at PeerManager.goodbyeAndDisconnectAllPeers (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/peers/peerManager.ts:223:5)\r\n    at NetworkCore.close (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/core/networkCore.ts:255:5)\r\n    at Network.close (file:///home/devops/goerli/lodestar/packages/beacon-node/src/network/network.ts:197:5)\r\n    at BeaconNode.close (file:///home/devops/goerli/lodestar/packages/beacon-node/src/node/nodejs.ts:316:7)\r\n    at EventTarget.abortController.signal.addEventListener.once (file:///home/devops/goerli/lodestar/packages/cli/src/cmds/beacon/handler.ts:137:11)\r\nJun-14 09:58:42.889[network]         debug: network sent goodbye to all peers\r\nJun-14 09:58:42.889[network]       verbose: Req  done method=goodbye, version=1, encoding=ssz_snappy, client=Teku, peer=16...GW2Ein, requestId=1773\r\nJun-14 09:58:42.932[network]         debug: network peerManager closed\r\nJun-14 09:58:42.934[network]         debug: network gossip closed\r\nJun-14 09:58:43.038[network]         debug: Dialing discovered peer peer=16...HRUh4M\r\nJun-14 09:58:43.038[network]         debug: Dialing discovered peer peer=16...zqJUKj\r\nJun-14 09:58:43.130[network]         debug: network reqResp closed\r\nJun-14 09:58:43.146[network]         debug: Error dialing discovered peer peer=16...m56aPB All promises were rejected\r\nAggregateError: All promises were rejected\r\nJun-14 09:58:43.146[network]         debug: Error dialing discovered peer peer=16...MS9Luf All promises were rejected\r\nAggregateError: All promises were rejected\r\nJun-14 09:58:43.146[network]         debug: Error dialing discovered peer peer=16...HRUh4M All promises were rejected\r\nAggregateError: All promises were rejected\r\nJun-14 09:58:43.152[network]         debug: Error dialing discovered peer peer=16...zqJUKj All promises were rejected\r\nAggregateError: All promises were rejected\r\nJun-14 09:58:43.152[network]         debug: Error dialing discovered peer peer=16...yH119U All promises were rejected\r\nAggregateError: All promises were rejected\r\nJun-14 09:58:43.153[network]         debug: network lib2p closed\r\nJun-14 09:58:43.153[network]         debug: network core closed\r\nJun-14 09:58:43.649[chain]         verbose: Archived finalized state finalizedEpoch=182885\r\nJun-14 09:58:44.617[]                debug: Beacon node closed\r\n```\r\n\r\nWhat looks really suspicious is that we are dialing peers after network is already closed\r\n\r\n```\r\nJun-14 09:58:43.038[network]         debug: Dialing discovered peer peer=16...HRUh4M\r\nJun-14 09:58:43.038[network]         debug: Dialing discovered peer peer=16...zqJUKj\r\n```\r\n\r\n### Expected behavior\r\n\r\nBeacon node should always exit process after [close sequence](https://github.com/ChainSafe/lodestar/blob/82914a1443fa1077d2a217cda9a1248e03084c46/packages/beacon-node/src/node/nodejs.ts#L309) succeeds. No explicit process.exit should be required.\r\n\r\n### Steps to reproduce\r\n\r\nRun beacon node for a while with the following command (or similar)\r\n\r\n```sh\r\n./lodestar beacon \\\r\n    --dataDir /home/devops/goerli/data/beacon \\\r\n    --rest \\\r\n    --rest.address \"0.0.0.0\" \\\r\n    --rest.namespace '*' \\\r\n    --metrics \\\r\n    --execution.urls http://localhost:8551 \\\r\n    --jwt-secret /home/devops/goerli/data/jwtsecret \\\r\n    --logLevel info \\\r\n    --network goerli \\\r\n    --checkpointSyncUrl \"https://beaconstate-goerli.chainsafe.io/\"\r\n```\r\n\r\nCTRL + C to exit gracefully and observe that it is not shutting down even though [close sequence](https://github.com/ChainSafe/lodestar/blob/82914a1443fa1077d2a217cda9a1248e03084c46/packages/beacon-node/src/node/nodejs.ts#L309) is executed successfully.\r\n\r\n### Operating system\r\n\r\nLinux\r\n\r\n### Lodestar version or commit hash\r\n\r\nunstable (bf5842733a738c59a6f9aa147496806fb2d4c98f)",
  "closed_by": {
    "login": "nflaig",
    "id": 38436224,
    "node_id": "MDQ6VXNlcjM4NDM2MjI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nflaig",
    "html_url": "https://github.com/nflaig",
    "followers_url": "https://api.github.com/users/nflaig/followers",
    "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
    "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
    "organizations_url": "https://api.github.com/users/nflaig/orgs",
    "repos_url": "https://api.github.com/users/nflaig/repos",
    "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nflaig/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642/timeline",
  "performed_via_github_app": null,
  "state_reason": "reopened"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1607587942",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1607587942",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
    "id": 1607587942,
    "node_id": "IC_kwDOCD5_Gc5f0dhm",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-26T14:15:39Z",
    "updated_at": "2023-06-26T14:16:22Z",
    "author_association": "MEMBER",
    "body": "Another issue reported [on discord](https://discord.com/channels/593655374469660673/593655641445367808/1122863589796102234), the BN process is not shutting down but based on the logs ([beacon-2023-06-25.log](https://github.com/ChainSafe/lodestar/files/11870280/beacon-2023-06-25.log)) it is hard to tell what the issue is.\r\n\r\nWe might have to call process.exit explicitly after beacon node closed if this issue can't be resolved.\r\nhttps://github.com/ChainSafe/lodestar/blob/f5d12a893f5b913a04938275bb248ace1ca47539/packages/cli/src/cmds/beacon/handler.ts#L132\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1607587942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1625203415",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1625203415",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
    "id": 1625203415,
    "node_id": "IC_kwDOCD5_Gc5g3qLX",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-07T10:28:19Z",
    "updated_at": "2023-07-07T10:28:19Z",
    "author_association": "MEMBER",
    "body": "The issue seems to be fixed with upgrade to libp2p to 0.45.9 in 7280234bea66b49da3900b916a1b54c4666e4173.\r\n\r\nThe PR that fixed the issue:\r\n- https://github.com/ChainSafe/js-libp2p-gossipsub/pull/438",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1625203415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1630749223",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1630749223",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
    "id": 1630749223,
    "node_id": "IC_kwDOCD5_Gc5hM0In",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-11T12:37:57Z",
    "updated_at": "2023-07-11T12:37:57Z",
    "author_association": "MEMBER",
    "body": "Reopening as issue does not yet seem to be resolved.\r\n\r\nLooks like we are pinging peers after sending goodbye\r\n\r\n```\r\nJun-25 02:58:27.655[network]         \u001B[34mdebug\u001B[39m: Req  dialing peer method=goodbye, version=1, encoding=ssz_snappy, client=Lighthouse, peer=16...VYqoz3, requestId=295952\r\n```\r\n```\r\nJun-25 02:58:27.903[network]         \u001B[34mdebug\u001B[39m: Req  received method=ping, client=Lighthouse, peer=16...VYqoz3, requestId=295961\r\nJun-25 02:58:27.903[network]       \u001B[36mverbose\u001B[39m: Resp done method=ping, client=Lighthouse, peer=16...VYqoz3, requestId=295961\r\n```\r\n\r\nor still dialing peers while disconnecting (`goodbyeAndDisconnectAllPeers`)\r\n```\r\nJun-25 02:58:28.311[network]         \u001B[34mdebug\u001B[39m: Req  dialing peer method=metadata, version=2, encoding=ssz_snappy, client=Unknown, peer=16...ohL5Xo, requestId=295963\r\n```\r\n\r\nBased on the current network close sequence it looks like we close the peer manager after disconnecting peers which could explain this behavior\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/85ff3cf17e9f8338865cc66f129f9e60e0ec029b/packages/beacon-node/src/network/core/networkCore.ts#L253-L256\r\n\r\nas only after closing, the intervals and event listeners are removed\r\n\r\nhttps://github.com/ChainSafe/lodestar/blob/85ff3cf17e9f8338865cc66f129f9e60e0ec029b/packages/beacon-node/src/network/peers/peerManager.ts#L203-L212\r\n\r\nChanging the order of the closing sequence will likely fix the issue, but extensive testing is required as this issue is hard to reproduce.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1630749223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1631977838",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1631977838",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
    "id": 1631977838,
    "node_id": "IC_kwDOCD5_Gc5hRgFu",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-12T07:17:01Z",
    "updated_at": "2023-07-12T07:17:01Z",
    "author_association": "MEMBER",
    "body": "Proposed solution https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1630749223 does not resolve the issue.\r\n\r\nThe problem seems to be with [libp2p](https://github.com/libp2p/js-libp2p) which in the end must take care of closing all connections / removing tcp listeners. There are several closed but also open issues regarding connections not being closed properly.\r\n- https://github.com/libp2p/js-libp2p/issues/433\r\n- https://github.com/libp2p/js-libp2p/issues/436\r\n\r\nThis comment https://github.com/libp2p/js-libp2p/issues/436#issuecomment-432624680 summarizes open tasks but there was no progress in a while.\r\n\r\nFor now,  we just have to explicitly exit process until upstream issues are fixed.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1631977838/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1761433473",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5642#issuecomment-1761433473",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5642",
    "id": 1761433473,
    "node_id": "IC_kwDOCD5_Gc5o_VeB",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-13T12:26:31Z",
    "updated_at": "2023-10-13T12:26:31Z",
    "author_association": "MEMBER",
    "body": "Potential fix has been merged to unstable\r\n- https://github.com/ChainSafe/lodestar/pull/6015\r\n\r\nIt is hard to verify if this actually fixed the issue due to the fact that it  is not really reproducible and happens rarely.\r\n\r\nTwo things have to be done to confirm a fix\r\n- set `--network.useWorker false` and\r\n- explicit exit has to be removed\r\nhttps://github.com/ChainSafe/lodestar/blob/ab2dfdde652b0b0e4e9b2b96f8d8ee08fec6b720/packages/cli/src/cmds/beacon/handler.ts#L136\r\n- then run beacon node for multiple hours and shutdown process, likely after a week of doing that without hanging process we can be confident enough and close this issue\r\n\r\nNote: there is a chance that the process would also hang with `--network.useWorker true` set (https://github.com/ChainSafe/lodestar/issues/5775 <-- this issue was still observed recently) but this happened even less often, hence it is harder to confirm a fix of the issue. ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1761433473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
