{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/1562",
  "id": 706057924,
  "node_id": "MDU6SXNzdWU3MDYwNTc5MjQ=",
  "number": 1562,
  "title": "Regular Sync keeps retry same range even it's a success round",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2020-09-22T03:50:31Z",
  "updated_at": "2020-09-25T01:26:23Z",
  "closed_at": "2020-09-25T01:26:23Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\nPreviously at regular sync it's the only source to fetch/process block until a gossip block comes. If `lastFetchedSlot === chainHead` then it thinks it failed to get range.\r\nNow we allow to receive gossip block when we don't have parent block yet,  it means chain head is out of control of regular sync and we should not base on that for a retry.\r\n```\r\n2020-09-22 10:09:24  [SYNC]             info: Imported blocks for slots: 349699,349700,349701,349702,349703,349704,349708,349709,349710,349711,349713,349714,349715,349716\r\n2020-09-22 10:09:24  [SYNC]             warn: Regular Sync: retrying range {\"start\":349698,\"end\":349717}\r\n2020-09-22 10:09:24  [SYNC]             info: Regular Sync: Requesting blocks from slot 349698 to slot 349717\r\n2020-09-22 10:09:24  [NETWORK]       verbose: sending beacon_blocks_by_range request to 16Uiu2HAm4kspH1T8VDPTE8XGLKVaCxPkAVTEShbK5tvAHJzS5MY1 requestId=460e74449b3d3f7e, encoding=ssz_snappy\r\n2020-09-22 10:09:25  [SYNC]             info: Peer status activePeers=5, syncPeers=5\r\n2020-09-22 10:09:25  [NETWORK]       verbose: got stream to 16Uiu2HAm4kspH1T8VDPTE8XGLKVaCxPkAVTEShbK5tvAHJzS5MY1 requestId=460e74449b3d3f7e, encoding=ssz_snappy\r\n2020-09-22 10:09:25  [NETWORK]       verbose: Started gossip aggregate and proof validation attestationSlot=349844, aggregatorIndex=8991, root=0x7b402d2b9fcbc9afad9310c2fd52745e6a784a0ce8a573066507117e594b4ecf, attestationRoot=0xe9f617b40bc4c0a347f9b744853f3fe67b71d35bddc37ecfb4de21b3356ad30b\r\n2020-09-22 10:09:26  [NETWORK]       verbose: receive beacon_blocks_by_range response with 14 chunks from 16Uiu2HAm4kspH1T8VDPTE8XGLKVaCxPkAVTEShbK5tvAHJzS5MY1 requestId=460e74449b3d3f7e, encoding=ssz_snappy, body={\"startSlot\":\"349698\",\"count\":\"20\",\"step\":\"1\"}\r\n2020-09-22 10:09:26  [SYNC]             info: Imported blocks for slots: 349699,349700,349701,349702,349703,349704,349708,349709,349710,349711,349713,349714,349715,349716\r\n2020-09-22 10:09:26  [SYNC]             warn: Regular Sync: retrying range {\"start\":349698,\"end\":349717}\r\n```\r\n\r\n**Expected behavior**\r\nAs in the above log, regular sync keeps retrying range, it should move forward instead.\r\nRegular sync should base on its own `lastProcessedBlock` like initial sync instead of basing on chain head.\r\n",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1562/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
