{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4596",
  "id": 1385244127,
  "node_id": "I_kwDOCD5_Gc5SkSXf",
  "number": 4596,
  "title": "Invalid state root error with ZERO_HASH",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-09-26T01:02:39Z",
  "updated_at": "2023-05-29T07:13:33Z",
  "closed_at": "2023-05-29T07:13:32Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nInvestigate this log in goerli nodes:\r\n```\r\nSep-26 00:48:25.493[chain]           ^[[31merror^[[39m: Block error slot=3970442 root=0x2656995d89a183e60a7199a3e0755af6155dc9c2991af44348bf5f3786e10c2b, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nError: BLOCK_ERROR_INVALID_STATE_ROOT\r\n    at verifyBlocksStateTransitionOnly (file:///usr/app/packages/beacon-node/src/chain/blocks/verifyBlocksStateTransitionOnly.ts:51:13)\r\n    at BeaconChain.verifyBlocksInEpoch (file:///usr/app/packages/beacon-node/src/chain/blocks/verifyBlock.ts:70:7)\r\n    at runMicrotasks (<anonymous>)\r\n    at runNextTicks (node:internal/process/task_queues:61:5)\r\n    at listOnTimeout (node:internal/timers:528:9)\r\n    at processTimers (node:internal/timers:502:7)\r\n    at BeaconChain.processBlocks (file:///usr/app/packages/beacon-node/src/chain/blocks/index.ts:71:68)\r\n    at Timeout.JobItemQueue.runJob [as _onTimeout] (file:///usr/app/packages/beacon-node/src/util/queue/itemQueue.ts:92:22)\r\n```\r\n\r\nnote that the expectedRoot is somehow ZERO_HASH, for Sep 25 it happened 78 times\r\n\r\n```\r\ngrep -e expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000 -rn beacon-2022-09-25.log  | wc -l\r\n78\r\n```\r\n\r\n**Expected behavior**\r\n\r\nNo error, or a good explanation of the error",
  "closed_by": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1258881360",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4596#issuecomment-1258881360",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
    "id": 1258881360,
    "node_id": "IC_kwDOCD5_Gc5LCQFQ",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T02:24:55Z",
    "updated_at": "2022-09-27T02:24:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "all of the blocks have ZERO_HASH state root and invalid, if we check the block explorer they are all missed (not included in chain)\r\n\r\n```\r\nbeacon-2022-09-26.log:973523:Sep-26 13:51:37.247[chain]           error: Block error slot=3974358 root=0x6f261166376ebb03595a2d488fedc5bfb372a51a9843ec52b13db3c71c9f858f, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nbeacon-2022-09-26.log:978334:Sep-26 13:55:49.136[chain]           error: Block error slot=3974379 root=0x6f0c8c539357d76886f942743235a1df06f9705645cd6a2411539e9e0cab1a76, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nbeacon-2022-09-26.log:1016735:Sep-26 14:27:25.467[chain]           error: Block error slot=3974537 root=0xcbdc4da67a0d354db075b3996095ca55ab610dead72eaa4f17df38143e0df1a0, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nbeacon-2022-09-26.log:1027224:Sep-26 14:36:01.454[chain]           error: Block error slot=3974580 root=0x842690fd90967ae25a67c4e6ac8e81db3c9432c4f28af47f469d446fde7abf13, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nbeacon-2022-09-26.log:1028124:Sep-26 14:36:49.064[chain]           error: Block error slot=3974584 root=0xe88b14b11f1f9cc9b128484750ef70b4176b32897f622f30d8dca1f9171cb9c9, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\nbeacon-2022-09-26.log:1034595:Sep-26 14:42:01.007[chain]           error: Block error slot=3974610 root=0xc994d9913814894cb66002f4d3b614e33d0154d2d92ee339dfb8b05db01619f1, expectedRoot=0x0000000000000000000000000000000000000000000000000000000000000000\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1258881360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1258903421",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4596#issuecomment-1258903421",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
    "id": 1258903421,
    "node_id": "IC_kwDOCD5_Gc5LCVd9",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T02:59:37Z",
    "updated_at": "2022-09-27T02:59:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "The peer id logged is incorrect\r\n\r\n```\r\nSep-27 00:01:26.469[network]       ^[[36mverbose^[[39m: Received gossip block slot=3977407, root=0x7bc6â€¦52f8, curentSlot=3977407, peerId=bafzaajiiaijcca2szy2eje5bz2y6w4mucwv3pe7gi33p2b3a3z5u2qszjzt6eqnzxq, delaySec=2.4609999656677246\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1258903421/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1259178443",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4596#issuecomment-1259178443",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
    "id": 1259178443,
    "node_id": "IC_kwDOCD5_Gc5LDYnL",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-27T08:40:25Z",
    "updated_at": "2022-09-27T08:40:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "we should be able to disconnect peers that send us too many rejected gossip messages\r\n\r\nshould bring this back https://github.com/ChainSafe/lodestar/pull/3781\r\n\r\nlast time the PR was reverted because we don't have a strong mechanism to find subnet peers and a clear gossipsub metrics",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1259178443/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1262191111",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4596#issuecomment-1262191111",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
    "id": 1262191111,
    "node_id": "IC_kwDOCD5_Gc5LO4IH",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-29T12:13:55Z",
    "updated_at": "2022-09-29T12:13:55Z",
    "author_association": "MEMBER",
    "body": "> we should be able to disconnect peers that send us too many rejected gossip messages\r\n\r\nSounds good to me",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1262191111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1566669687",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4596#issuecomment-1566669687",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4596",
    "id": 1566669687,
    "node_id": "IC_kwDOCD5_Gc5dYXt3",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-29T07:13:32Z",
    "updated_at": "2023-05-29T07:13:32Z",
    "author_association": "MEMBER",
    "body": "Closing issues for specific incidents on old versions of Lodestar, please re-open if it happens with latest stable\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1566669687/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
