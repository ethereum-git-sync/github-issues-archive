{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/6105",
  "id": 1988963613,
  "node_id": "I_kwDOCD5_Gc52jS0d",
  "number": 6105,
  "title": "Improve gossip block receive time",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 5670219610,
      "node_id": "LA_kwDOCD5_Gc8AAAABUfivWg",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-bug",
      "name": "meta-bug",
      "color": "E79553",
      "default": false,
      "description": "Issues that identify a bug and require a fix."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-11-11T14:03:11Z",
  "updated_at": "2024-01-13T07:05:39Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nOn one node, the block receive time is 3.62s\r\n\r\n```\r\n2023-11-11 04:24:38.676 | Nov-11 01:24:38.676[network]       verbose: Received gossip block slot=7736821, root=0x06c9…4c44, curentSlot=7736821, peerId=16Uiu2HAmS7eWw4dWQ78FQdYqfoZg4K3YbvZ6rZkF6adoAYrk8d5M, delaySec=3.628000020980835, recvToVal=0.04800009727478027\r\n```\r\n\r\nit's alsmost 0.45s delay compared to other node\r\n\r\n```\r\n2023-11-11 04:24:38.222 | Nov-11 01:24:38.221[network]       verbose: Received gossip block slot=7736821, root=0x06c9…4c44, curentSlot=7736821, peerId=16Uiu2HAmTwzuybJco3ABCj7UpSrotK3HkCgf8vSjR9fayZJkLtRd, delaySec=3.174999952316284, recvToVal=0.046000003814697266\r\n```\r\n\r\nNote that we have a missed attestations with this block slot, a 200ms improvement could help validators vote for the correct head.\n\n### Expected behavior\n\nNote that we have a missed attestations with this block slot, a 200ms improvement could help validators vote for the correct head.\r\n\r\n- Right now UnknownBlock sync only based on forkchoice check to search for a block while gossip block already comes, when gossip block comes we should let forkchoice know there's incoming block so that we don't need to search for that same block again https://github.com/ChainSafe/lodestar/blob/v1.12.0/packages/beacon-node/src/network/processor/index.ts#L270\r\nThis is because downloaded unknown block comes with the cost of decrypting at different layers at least, that blocks the main thread I/O when validating gossip block at execution engine\r\n- Also consider #4170\n\n### Steps to reproduce\n\n_No response_\n\n### Additional context\n\n_No response_\n\n### Operating system\n\nLinux\n\n### Lodestar version or commit hash\n\nv1.12.0",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/6105/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
