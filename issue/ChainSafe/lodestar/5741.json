{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5741",
  "id": 1795911287,
  "node_id": "I_kwDOCD5_Gc5rC253",
  "number": 5741,
  "title": "I/O performance issue when subscribing to sync committee",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-07-10T04:21:56Z",
  "updated_at": "2023-07-10T04:21:56Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Describe the bug\n\nA lot of attestations were submitted late from Jun 29 to Jul 01\r\n\r\n<img width=\"799\" alt=\"Screenshot 2023-07-10 at 11 08 08\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/2f4f66e3-f569-4ff9-bb38-6c2890da73f6\">\r\n\r\nThis happened when the node subscribed to sync committee topic (notice that job wait time was too big for sync committee messages)\r\n\r\n<img width=\"791\" alt=\"Screenshot 2023-07-10 at 11 09 58\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/6203cf9b-e282-4933-976e-9acb11d6b7b0\">\r\n\r\ntopic peers spiked because a lot of nodes with big long lived subnets connected to us at that time\r\n\r\n<img width=\"1284\" alt=\"Screenshot 2023-07-10 at 11 12 04\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/652b2b8d-41cd-4d0f-a3eb-f9b7730987f9\">\r\n\r\nthere are more messages sent to us\r\n\r\n<img width=\"802\" alt=\"Screenshot 2023-07-10 at 11 15 11\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/ed852179-e079-4057-822b-4fc9b7ea72c4\">\r\n\r\nand we have to published to too many peers also\r\n\r\n<img width=\"793\" alt=\"Screenshot 2023-07-10 at 11 15 49\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/327ca74a-7580-4bfc-a99b-b5db342c388c\">\r\n\r\nthis caused I/O lag issue (see #5740)\r\n\r\n<img width=\"798\" alt=\"Screenshot 2023-07-10 at 11 16 14\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/c83c9a2a-bade-4469-a553-552226b05156\">\r\n\r\nnode received too many PRUNE messages\r\n\r\n<img width=\"1284\" alt=\"Screenshot 2023-07-10 at 11 17 53\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/956d8bca-b262-42ca-8189-611542c00f45\">\r\n\r\nmesh peers were dropped (including core topics)\r\n\r\n<img width=\"795\" alt=\"Screenshot 2023-07-10 at 11 18 09\" src=\"https://github.com/ChainSafe/lodestar/assets/10568965/cc2dea5e-e0a5-494d-a66e-44367d98346d\">\r\n\r\nthis caused gossip blocks being late, node had to process a lot of attestations at the same time which push pressure to our BLS worker pool (see #5739)\r\n\n\n### Expected behavior\n\nNo I/O performance issue, network thread (`useWorker=true`) could resolve this\n\n### Steps to reproduce\n\n_No response_\n\n### Additional context\n\n_No response_\n\n### Operating system\n\nLinux\n\n### Lodestar version or commit hash\n\nv1.8.0",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5741/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
