{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5028",
  "id": 1550565767,
  "node_id": "I_kwDOCD5_Gc5ca8GH",
  "number": 5028,
  "title": "Fallback to publishing block when it fails to publish blinded block",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-01-20T09:43:56Z",
  "updated_at": "2023-01-20T15:57:35Z",
  "closed_at": "2023-01-20T15:53:25Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Is your feature request related to a problem? Please describe.**\r\n\r\nWe may fail to publish blinded block and validator misses a block proposal\r\n\r\n```\r\nBad Gateway: Bad Gateway: no successful relay response - Failed to publish block\r\nError: Bad Gateway: Bad Gateway: no successful relay response - Failed to publish block\r\n    at HttpClient.requestWithBody (file:///usr/app/packages/api/src/utils/client/httpClient.ts:258:15)\r\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\r\n    at HttpClient.request (file:///usr/app/packages/api/src/utils/client/httpClient.ts:132:12)\r\n    at Object.request [as publishBlindedBlock] (file:///usr/app/packages/api/src/utils/client/client.ts:82:9)\r\n    at BlockProposingService.createAndPublishBlock (file:///usr/app/packages/validator/src/services/block.ts:95:7)\r\n    at async Promise.all (index 0)\r\n```\r\n\r\n**Describe the solution you'd like**\r\n\r\nSince we have signed block at that time, we should be able to publish it (call `/eth/v1/beacon/block`) to avoid a missed block proposal ",
  "closed_by": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1398589604",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5028#issuecomment-1398589604",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028",
    "id": 1398589604,
    "node_id": "IC_kwDOCD5_Gc5TXMik",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-20T15:53:25Z",
    "updated_at": "2023-01-20T15:53:25Z",
    "author_association": "MEMBER",
    "body": "@tuyennhv We did an investigation with Bloxroute and determined the issue to be relay related. I've previously tested the builder API before and we do fallback to local execution to propose a block currently. But the problem is when we sign a blinded block header and do not receive the payload from the relay. Unfortunately there's not much we can do there because we cannot sign two different blocks.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1398589604/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1398593060",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5028#issuecomment-1398593060",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5028",
    "id": 1398593060,
    "node_id": "IC_kwDOCD5_Gc5TXNYk",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-20T15:56:35Z",
    "updated_at": "2023-01-20T15:57:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "here we have signed BLINDED block, which we try to publish:\r\n1. to publish it we submit it to the relay which publishes as well as returns full payload\r\n2. which we also use to construct full block on our side and publish on our own (this is an optional step)\r\n\r\nHowever if the api fails at 1. nothing else can be done and the block proposal opprtunity is effectively lost as we run the risk of double signing (relay api could fail even after accepting the block and there is no way to confirm if relay actually didn't accept and publish the block)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1398593060/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
