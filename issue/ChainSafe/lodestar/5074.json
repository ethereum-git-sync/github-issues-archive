{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5074",
  "id": 1561639768,
  "node_id": "I_kwDOCD5_Gc5dFLtY",
  "number": 5074,
  "title": "Low gossipsub score due to p7",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090447,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDQ3",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-high",
      "name": "prio-high",
      "color": "fd9579",
      "default": false,
      "description": "Resolve issues as soon as possible."
    },
    {
      "id": 2155825090,
      "node_id": "MDU6TGFiZWwyMTU1ODI1MDkw",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-networking",
      "name": "scope-networking",
      "color": "980043",
      "default": false,
      "description": "All issues related to networking, gossip, and libp2p."
    },
    {
      "id": 4116812272,
      "node_id": "LA_kwDOCD5_Gc71YZHw",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-interop",
      "name": "scope-interop",
      "color": "980043",
      "default": false,
      "description": "Issues that fix interop issues between Lodestar and CL, EL or tooling."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-01-30T02:39:48Z",
  "updated_at": "2023-03-28T01:27:56Z",
  "closed_at": "2023-03-28T01:27:56Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nThis fix https://github.com/ChainSafe/js-libp2p-gossipsub/pull/385 helps minimize broken promises for a while, however since Jan 25 we catch less promises from duplicate and there are more broken promises\r\n\r\nThis is monitored from a mainnet node subscribing to all subnets. __Update__: this happens on all mainnet nodes\r\n\r\n<img width=\"789\" alt=\"Screen Shot 2023-01-30 at 09 22 54\" src=\"https://user-images.githubusercontent.com/10568965/215374276-d20a1827-63ca-480f-89c6-3e4eddb6ab88.png\">\r\n\r\n<img width=\"1296\" alt=\"Screen Shot 2023-01-30 at 09 23 29\" src=\"https://user-images.githubusercontent.com/10568965/215374342-8bd8e248-ab2a-4cff-a136-3b3a3b1484a0.png\">\r\n\r\n<img width=\"797\" alt=\"Screen Shot 2023-01-30 at 09 23 53\" src=\"https://user-images.githubusercontent.com/10568965/215374396-2ae045a1-8d9e-4b6d-826e-7cf8954bf5a3.png\">\r\n\r\n\r\n**Expected behavior**\r\n\r\nLow broken promises",
  "closed_by": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1407927723",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5074#issuecomment-1407927723",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074",
    "id": 1407927723,
    "node_id": "IC_kwDOCD5_Gc5T60Wr",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T03:10:59Z",
    "updated_at": "2023-02-01T09:53:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "On mainnet, the percentage of promise broken ratio is quite high since Jan 25\r\n\r\n<img width=\"1297\" alt=\"Screen Shot 2023-01-30 at 10 10 39\" src=\"https://user-images.githubusercontent.com/10568965/215379492-71a3a253-ee60-4e94-9afd-cad6de9dd842.png\">\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1407927723/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1418373164",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5074#issuecomment-1418373164",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074",
    "id": 1418373164,
    "node_id": "IC_kwDOCD5_Gc5Uiqgs",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T01:44:59Z",
    "updated_at": "2023-02-06T01:44:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "since Jan 25 on mainnet nodes there are more Nimbus peers\r\n\r\n<img width=\"793\" alt=\"Screen Shot 2023-02-06 at 08 42 48\" src=\"https://user-images.githubusercontent.com/10568965/216862869-260c7c4c-cfec-419d-9d19-bee81ddba16d.png\">\r\n\r\nthere are a lot of IWANT promise that's never delivered since then\r\n\r\n<img width=\"1284\" alt=\"Screen Shot 2023-02-06 at 08 43 43\" src=\"https://user-images.githubusercontent.com/10568965/216862971-8f280ce4-0a68-462c-a72b-96a608fba23a.png\">\r\n\r\nthis PR also confirms Nimbus peer score is low https://github.com/ChainSafe/lodestar/pull/5094#issuecomment-1418365878\r\n\r\nneed to work with Nimbus to improve its gossip peer score",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1418373164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1439216847",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5074#issuecomment-1439216847",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074",
    "id": 1439216847,
    "node_id": "IC_kwDOCD5_Gc5VyLTP",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T23:16:35Z",
    "updated_at": "2023-03-28T01:21:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Some issues/PRs in progress in order to debug this issue:\r\n- [x] https://github.com/ChainSafe/lodestar/pull/5175\r\n- [x] https://github.com/ChainSafe/js-libp2p-gossipsub/issues/406\r\n- [ ] https://github.com/ChainSafe/js-libp2p-gossipsub/issues/408 ===> this is the root cause",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1439216847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1486077841",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5074#issuecomment-1486077841",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5074",
    "id": 1486077841,
    "node_id": "IC_kwDOCD5_Gc5Yk7-R",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-28T01:27:56Z",
    "updated_at": "2023-03-28T01:27:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue disappeared since Mar 06. Also Nimbus had a fix to not limit responding only first 25 message ids in response to gossip `Iwant` request\r\n\r\nThe number of Nimbus peers is also not consistently high as earlier: some have very few Nimbus peers, some have up to 50% Nimbus peers\r\n\r\n<img width=\"791\" alt=\"Screenshot 2023-03-28 at 08 26 46\" src=\"https://user-images.githubusercontent.com/10568965/228102913-6a1d713a-b51f-4683-9282-c4cbc2ad8783.png\">\r\n\r\nClosing the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1486077841/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
