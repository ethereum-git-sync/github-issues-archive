{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4587",
  "id": 1382781865,
  "node_id": "I_kwDOCD5_Gc5Sa5Op",
  "number": 4587,
  "title": "Error updating eth1 chain cache",
  "user": {
    "login": "kornface13",
    "id": 4585037,
    "node_id": "MDQ6VXNlcjQ1ODUwMzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4585037?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kornface13",
    "html_url": "https://github.com/kornface13",
    "followers_url": "https://api.github.com/users/kornface13/followers",
    "following_url": "https://api.github.com/users/kornface13/following{/other_user}",
    "gists_url": "https://api.github.com/users/kornface13/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kornface13/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kornface13/subscriptions",
    "organizations_url": "https://api.github.com/users/kornface13/orgs",
    "repos_url": "https://api.github.com/users/kornface13/repos",
    "events_url": "https://api.github.com/users/kornface13/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kornface13/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-09-22T17:26:29Z",
  "updated_at": "2022-09-23T06:42:11Z",
  "closed_at": "2022-09-23T06:42:10Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\nI'm seeing the following error in lodestar: `error: Error updating eth1 chain cache  Timeout request`\r\n\r\nHere is a log snippet:\r\n```Sep-22 17:12:30.000[]                 info: Synced - slot: 3946562 (skipped 2) - head: 3946560 0x4fb5…48e8 - execution: valid(0xe776…bf24) - finalized: 0xacca…4f95:123328 - peers: 47\r\nSep-22 17:12:42.001[]                 info: Synced - slot: 3946563 - head: 3946563 0x25b5…ddc0 - execution: valid(0x3898…13bf) - finalized: 0xacca…4f95:123328 - peers: 50\r\nSep-22 17:12:54.014[]                 info: Synced - slot: 3946564 - head: 3946564 0x7475…08ef - execution: valid(0x67e7…a6e1) - finalized: 0xacca…4f95:123328 - peers: 49\r\nSep-22 17:13:06.003[]                 info: Synced - slot: 3946565 (skipped 1) - head: 3946564 0x7475…08ef - execution: valid(0x67e7…a6e1) - finalized: 0xacca…4f95:123328 - peers: 52\r\nSep-22 17:13:18.000[]                 info: Synced - slot: 3946566 - head: 3946566 0xce90…e051 - execution: valid(0x2915…3c63) - finalized: 0xacca…4f95:123328 - peers: 49\r\nSep-22 17:13:30.001[]                 info: Synced - slot: 3946567 - head: 3946567 0xde06…7eb1 - execution: valid(0xa561…8bbf) - finalized: 0xacca…4f95:123328 - peers: 50\r\nSep-22 17:13:32.831[ETH1]            error: Error updating eth1 chain cache  Timeout request\r\nError: Timeout request\r\n    at JsonRpcHttpClient.fetchJsonOneUrl (file:///usr/app/packages/beacon-node/src/eth1/provider/jsonRpcHttpClient.ts:239:17)\r\n    at runMicrotasks (<anonymous>)\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at JsonRpcHttpClient.fetchJson (file:///usr/app/packages/beacon-node/src/eth1/provider/jsonRpcHttpClient.ts:160:16)\r\n    at JsonRpcHttpClient.fetchBatch (file:///usr/app/packages/beacon-node/src/eth1/provider/jsonRpcHttpClient.ts:143:39)\r\n    at async Promise.all (index 0)\r\n    at retry (file:///usr/app/packages/utils/src/retry.ts:33:14)\r\n    at Eth1Provider.getBlocksByNumber (file:///usr/app/packages/beacon-node/src/eth1/provider/eth1Provider.ts:114:23)\r\n    at Eth1DepositDataTracker.updateBlockCache (file:///usr/app/packages/beacon-node/src/eth1/eth1DepositDataTracker.ts:260:23)\r\n    at Eth1DepositDataTracker.update (file:///usr/app/packages/beacon-node/src/eth1/eth1DepositDataTracker.ts:192:31)```\r\n\r\nThis happens continually.  The lodestar validator still submits attestations correctly.  \r\n\r\nNethermind is rapidly scrolling lines similar to:\r\n```2022-09-22 17:14:33.1075|Executing JSON RPC call eth_getBlockByNumber with params [0x61a51e, False]\r\n2022-09-22 17:14:33.1781|Executing JSON RPC call eth_getBlockByNumber with params [0x61a51f, False]\r\n2022-09-22 17:14:33.1817|Executing JSON RPC call eth_getBlockByNumber with params [0x61a520, False]\r\n2022-09-22 17:14:33.1870|Executing JSON RPC call eth_getBlockByNumber with params [0x61a521, False]```\r\n\r\nThese do not ever seem to stop.  If I close Lodestar and use nimbus or lighthouse with nethermind, I get these lines occasionally but not at the extreme rate they appear when using Lodestar and Nethermind.\r\n\r\n\r\nWhen I tell lodestar to communicate with Geth, this timeout does not occur.  \r\n\r\n<!--A clear and concise description of what the bug is and steps to reproduce it.-->\r\n\r\nI start nethermind with the following docker command:\r\n`docker run -d -p 8545:8545 -p 8551:8551 -p 30303:30303/tcp -p 30303:30303/udp -v /media/2tb/nethermind/data:/nethermind/data  -v /media/2tb/jwtsecret:/tmp/jwtsecret nethermind/nethermind --JsonRpc.Enabled true --JsonRpc.Host 0.0.0.0 --JsonRpc.EnginePort 8551 --JsonRpc.EngineHost 0.0.0.0 --JsonRpc.JwtSecretFile=/tmp/jwtsecret --config goerli --datadir data --HealthChecks.Enabled true --HealthChecks.UIEnabled true --Sync.SnapSync true`\r\n\r\nNethermind version: `Nethermind/v1.14.2-0-08354f9fa-20220922/X64-Linux/6.0.9`\r\n\r\nI start Lodestar using eth-docker and just have `EL_NODE=http://192.168.13.99:8551` in my .env file. \r\nLodestar version: 1.0.0 \r\n\r\n<!--A clear and concise description of what you expected to happen.-->\r\n\r\nI expect to never see timeouts talking to the execution layer.  I also do not expect to see Nethermind scrolling logs so rapidly.  \r\n\r\n\r\n\r\n\r\n- OS: Ubuntu \r\n- Version: 22.04.1\r\n",
  "closed_by": {
    "login": "philknows",
    "id": 58080811,
    "node_id": "MDQ6VXNlcjU4MDgwODEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/philknows",
    "html_url": "https://github.com/philknows",
    "followers_url": "https://api.github.com/users/philknows/followers",
    "following_url": "https://api.github.com/users/philknows/following{/other_user}",
    "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
    "organizations_url": "https://api.github.com/users/philknows/orgs",
    "repos_url": "https://api.github.com/users/philknows/repos",
    "events_url": "https://api.github.com/users/philknows/events{/privacy}",
    "received_events_url": "https://api.github.com/users/philknows/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1255361302",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4587#issuecomment-1255361302",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587",
    "id": 1255361302,
    "node_id": "IC_kwDOCD5_Gc5K00sW",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-22T17:52:27Z",
    "updated_at": "2022-09-22T17:52:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "already resolved in https://github.com/ChainSafe/lodestar/pull/4532, could you try `next` docker image tag, it should have this fix, and let know if the timeout issues automatically resolves (you will still see some timeouts which will make lodestar dynamically adjust its load to nethermind)\r\nonce confirmed resolve we can close off this issue cc @philknows ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1255361302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1255849229",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4587#issuecomment-1255849229",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4587",
    "id": 1255849229,
    "node_id": "IC_kwDOCD5_Gc5K2r0N",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-23T06:42:10Z",
    "updated_at": "2022-09-23T06:42:10Z",
    "author_association": "MEMBER",
    "body": "Resolved as mentioned in the Discord chat. Thanks for writing this up as documentation for others! ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1255849229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
