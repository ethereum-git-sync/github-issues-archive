{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/2468",
  "id": 873960139,
  "node_id": "MDU6SXNzdWU4NzM5NjAxMzk=",
  "number": 2468,
  "title": "Metrics to add tracker",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2966148095,
      "node_id": "MDU6TGFiZWwyOTY2MTQ4MDk1",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-metrics",
      "name": "scope-metrics",
      "color": "980043",
      "default": false,
      "description": "All issues with regards to the exposed metrics."
    },
    {
      "id": 3592888034,
      "node_id": "LA_kwDOCD5_Gc7WJx7i",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/Epic",
      "name": "Epic",
      "color": "4660F9",
      "default": false,
      "description": "Issues used as milestones and tracking multiple issues."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-05-02T14:45:58Z",
  "updated_at": "2023-05-26T16:28:01Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Ready to execute\r\n\r\n- https://github.com/ChainSafe/lodestar/issues/2483\r\n- https://github.com/ChainSafe/lodestar/issues/2984\r\n- https://github.com/ChainSafe/lodestar/issues/3033\r\n- https://github.com/ChainSafe/lodestar/issues/3112\r\n- https://github.com/ChainSafe/lodestar/issues/3115\r\n- https://github.com/ChainSafe/lodestar/issues/3205\r\n- https://github.com/ChainSafe/lodestar/issues/3413\r\n- https://github.com/ChainSafe/lodestar/issues/3680\r\n- https://github.com/ChainSafe/lodestar/issues/3946\r\n- https://github.com/ChainSafe/lodestar/pull/4122 ReqResp request times \r\n- https://github.com/ChainSafe/lodestar/pull/4123 Reorg depth histogram\r\n- https://github.com/ChainSafe/lodestar/pull/4123 Distance to parent block histogram \r\n- https://github.com/ChainSafe/lodestar/pull/4124 Histogram of balance increase for block proposer\r\n- https://github.com/ChainSafe/lodestar/pull/4125 Total signatures aggregated (optional histogram for time spent aggregating) \r\n- https://github.com/ChainSafe/lodestar/pull/4127 JSON RPC client metrics \r\n- From Lighthouse: https://github.com/ChainSafe/lodestar/issues/4273\r\n- From Lighthouse: https://github.com/ChainSafe/lodestar/issues/4274\r\n- From Lighthouse: https://github.com/ChainSafe/lodestar/issues/2558\r\n- From Lighthouse: https://github.com/ChainSafe/lodestar/issues/2984\r\n- From Lighthouse: https://github.com/ChainSafe/lodestar/issues/2473\r\n\r\n## Metric ideas\r\n\r\n### Misc\r\n\r\nOnce properly defined, convert to issue or pull request and move above to \"**Ready to execute**\"\r\n\r\n- Improve state.clone() metrics, what we really care about is before doing state-transitions if the state has cache or not.\r\n- Add more sync metrics to measure efficiency: # blocks downloaded to process # of blocks. To count duplicated downloads indirectly.\r\n- Discv5 ping times\r\n- Gossipsub received blocks\r\n- Blocks in last epoch, to compute percent of orphaned\r\n- More HTTP metrics?\r\n\r\n### From Lighthouse\r\n\r\nReviewed this file and select interesting metrics to add\r\nhttps://github.com/sigp/lighthouse/blob/stable/beacon_node/beacon_chain/src/metrics.rs\r\n\r\n**Block Delay Metrics**\r\n\r\n- [x] `beacon_block_imported_slot_start_delay_time`: Duration between the start of the blocks slot and the current time when it was imported.\r\n- [x] `beacon_block_head_slot_start_delay_time`: Duration between the start of the blocks slot and the current time when it was as head.\r\n- [ ] `beacon_block_head_slot_start_delay_exceeded_total`: Triggered when the duration between the start of the blocks slot and the current time will result in failed attestations. https://github.com/ChainSafe/lodestar/pull/5559\r\n\r\n**Persisting BeaconChain components to disk**\r\n\r\n- [ ] `beacon_persist_head`: Time taken to persist the canonical head\r\n- [ ] `beacon_persist_op_pool`: Time taken to persist the operations pool - Does Lighthouse keep all ops in memory?\r\n- [ ] `beacon_persist_eth1_cache`: Time taken to persist the eth1 caches\r\n\r\n**Chain Head**\r\n\r\n- [x] `beacon_update_head_seconds`: Time taken to update the canonical head - Review what does it refer too\r\n\r\n",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/863749553",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2468#issuecomment-863749553",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
    "id": 863749553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2Mzc0OTU1Mw==",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-18T04:38:30Z",
    "updated_at": "2021-06-18T04:38:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "assign please",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/863749553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/869140405",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2468#issuecomment-869140405",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
    "id": 869140405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2OTE0MDQwNQ==",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-27T10:40:45Z",
    "updated_at": "2021-06-27T10:40:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dapplion these looks like good metrics to pick up next ?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/869140405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/869148492",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2468#issuecomment-869148492",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
    "id": 869148492,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2OTE0ODQ5Mg==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-27T11:48:26Z",
    "updated_at": "2021-06-27T11:48:40Z",
    "author_association": "MEMBER",
    "body": "> @dapplion these looks like good metrics to pick up next ?\r\n\r\nI think the next interesting group to add would be around block production. Note that lighthouse has very detailed timings on each step of the process. Our approach to block production is more simple so maybe a single histogram around the entire thing would suffice. We are already kind of tracking it via the API response times, but it would be nice to track it anyway.\r\n\r\n- beacon_block_production_requests_total: Count of all block production requests\r\n- beacon_block_production_successes_total: Count of blocks successfully produced\r\n- beacon_block_production_seconds: Full runtime of block production\r\n\r\nAt the same time it would be quite a priority to have metrics in our regen / state cache: https://github.com/ChainSafe/lodestar/issues/2153. Let's discuss details in that issue if you are interested.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/869148492/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/874920939",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2468#issuecomment-874920939",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
    "id": 874920939,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDkyMDkzOQ==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T16:48:39Z",
    "updated_at": "2021-07-06T16:48:39Z",
    "author_association": "MEMBER",
    "body": "Keeping open since there are some metrics we want to implement soonish too",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/874920939/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1293873572",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/2468#issuecomment-1293873572",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/2468",
    "id": 1293873572,
    "node_id": "IC_kwDOCD5_Gc5NHvGk",
    "user": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-27T17:52:53Z",
    "updated_at": "2022-10-27T17:52:53Z",
    "author_association": "MEMBER",
    "body": "Adding some ideas to this from @wemeetagain discussion in Columbia that I found in my notes:\r\n\r\n- Block size metrics (due to 4844 blobs) to test performance\r\n- Number of operations per block\r\n- Metrics on exits, slashings, deposits.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1293873572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
