{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5341",
  "id": 1653962115,
  "node_id": "I_kwDOCD5_Gc5ilXWD",
  "number": 5341,
  "title": "Document getting flamechart of live node",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1478321239,
      "node_id": "MDU6TGFiZWwxNDc4MzIxMjM5",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/meta-discussion",
      "name": "meta-discussion",
      "color": "a6bddb",
      "default": false,
      "description": "Indicates a topic that requires input from various developers."
    },
    {
      "id": 2966148095,
      "node_id": "MDU6TGFiZWwyOTY2MTQ4MDk1",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-metrics",
      "name": "scope-metrics",
      "color": "980043",
      "default": false,
      "description": "All issues with regards to the exposed metrics."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/milestones/29",
    "html_url": "https://github.com/ChainSafe/lodestar/milestone/29",
    "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/milestones/29/labels",
    "id": 9244445,
    "node_id": "MI_kwDOCD5_Gc4AjQ8d",
    "number": 29,
    "title": "v1.9.0",
    "description": "",
    "creator": {
      "login": "philknows",
      "id": 58080811,
      "node_id": "MDQ6VXNlcjU4MDgwODEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/58080811?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/philknows",
      "html_url": "https://github.com/philknows",
      "followers_url": "https://api.github.com/users/philknows/followers",
      "following_url": "https://api.github.com/users/philknows/following{/other_user}",
      "gists_url": "https://api.github.com/users/philknows/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/philknows/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/philknows/subscriptions",
      "organizations_url": "https://api.github.com/users/philknows/orgs",
      "repos_url": "https://api.github.com/users/philknows/repos",
      "events_url": "https://api.github.com/users/philknows/events{/privacy}",
      "received_events_url": "https://api.github.com/users/philknows/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 7,
    "closed_issues": 13,
    "state": "open",
    "created_at": "2023-04-04T13:04:23Z",
    "updated_at": "2023-06-02T04:59:39Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 9,
  "created_at": "2023-04-04T14:04:13Z",
  "updated_at": "2023-05-23T18:38:39Z",
  "closed_at": "2023-05-23T18:38:38Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "To understand what's affecting Lodestar performance our current strategy is to attach a chromium dev tools instance into a node running with `node --inspect`\r\n\r\nThose dev tools can render a stack chart by time, but not a regular flamechart by purely stack occurrences. The information exposed by `node --inspect` _should_ be enough to produce a flamechart.\r\n\r\nCC: @matthewkeil @nflaig @tuyennhv \r\n\r\n- [x] Research existing tools that can produce and render a flamechart attaching into a running process; i.e. run process as normal for 1 hour, then capture stacks for 12 minutes, then detach.\r\n- [x] Write reproducible steps + scripts for other contributors",
  "closed_by": {
    "login": "matthewkeil",
    "id": 18608739,
    "node_id": "MDQ6VXNlcjE4NjA4NzM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matthewkeil",
    "html_url": "https://github.com/matthewkeil",
    "followers_url": "https://api.github.com/users/matthewkeil/followers",
    "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
    "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
    "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
    "repos_url": "https://api.github.com/users/matthewkeil/repos",
    "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496261228",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1496261228",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1496261228,
    "node_id": "IC_kwDOCD5_Gc5ZLyJs",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T16:21:47Z",
    "updated_at": "2023-04-04T16:21:47Z",
    "author_association": "MEMBER",
    "body": "could give [node-clinic](https://github.com/clinicjs/node-clinic) a try, specifically [node-clinic-flame](https://github.com/clinicjs/node-clinic-flame)\r\n\r\nflame graph looks like this\r\n\r\n![image](https://user-images.githubusercontent.com/38436224/229855183-3150ea12-61d5-4803-b9d1-59ebc678b699.png)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496261228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496723820",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1496723820",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1496723820,
    "node_id": "IC_kwDOCD5_Gc5ZNjFs",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T23:34:02Z",
    "updated_at": "2023-04-04T23:34:02Z",
    "author_association": "MEMBER",
    "body": "Can it attach to a process live after N time? Docs I've seen appear to capture flamecharts on entire process lifetime",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1496723820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497040157",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1497040157",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1497040157,
    "node_id": "IC_kwDOCD5_Gc5ZOwUd",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-05T07:23:56Z",
    "updated_at": "2023-04-05T07:23:56Z",
    "author_association": "MEMBER",
    "body": "Based on the `clinic flame` flags I don't see an option to do that.\r\n\r\nCan be used programmatically as well, then could just call `flame.collect` after N time, see [node-clinic-flame docs](https://github.com/clinicjs/node-clinic-flame#documentation). \r\n\r\nMight have to use [0x](https://github.com/davidmarkclements/0x) directly to get more fine-grained control as this seems to have a `--collect-delay` flag (Specify a delay(ms) before collecting data).",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1497040157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499828642",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1499828642",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1499828642,
    "node_id": "IC_kwDOCD5_Gc5ZZZGi",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-07T01:39:06Z",
    "updated_at": "2023-04-11T05:01:28Z",
    "author_association": "MEMBER",
    "body": "All of the libraries I found seem to want to run the node process directly and cannot be turned on and then off again programatically.  After a bit of googling I found [this blog](https://betterprogramming.pub/create-a-flame-graph-for-your-node-app-profiling-nodejs-app-e0a91e5ed585) and noted the flags.  I looked at the `Ox` code and found a few things to better understanding how that library works.\r\n\r\nIt looks like they are running the process [here](https://github.com/davidmarkclements/0x/blob/8d34f06bce33c287e6e50ee602ef4b1b55175101/platform/v8.js#L27) and [here](https://github.com/davidmarkclements/0x/blob/8d34f06bce33c287e6e50ee602ef4b1b55175101/platform/linux.js#L41) depending on if they are profiling v8 or linux.  \r\n\r\nFor v8 they are out-putting the isolate data to a log. Then then parse the data into `tick`s [here](https://github.com/davidmarkclements/0x/blob/8d34f06bce33c287e6e50ee602ef4b1b55175101/platform/v8.js#L128) to build the graph data.\r\n\r\nFor linux they are launching using a system level perf command and passing `--perf-basic-prof` and then turn the trace into `tick`s [here](https://github.com/davidmarkclements/0x/blob/8d34f06bce33c287e6e50ee602ef4b1b55175101/platform/linux.js#L105)\r\n\r\n~~Sadly in both situations they use a flag to output perf data.  I am doing a bit more digging to see how it is implemented to try and understand if/what the performance implications will be.~~\r\n\r\nThere are [4 perf flags](https://github.com/nodejs/node/blob/4166d40d0873b6d8a0c7291872c8d20dc680b1d7/doc/api/cli.md?plain=1#L1964-L1973) that are available and the [node flamegraph docs](https://nodejs.org/en/docs/guides/diagnostics-flamegraph) talk about a few of the details.\r\n\r\nI am reading about the [Chrome Debugging Protocol](https://chromedevtools.github.io/debugger-protocol-viewer/v8/) docs that were referred to in the [debugger](https://nodejs.org/en/docs/guides/debugging-getting-started) section of the node docs to see how the protocol works so we can potentially leverage the flag\r\n\r\nUpdated. ~~I am guessing there will be some degradation so it might not be ideal for prod but will add another comment below when I get further~~\r\n\r\nI researched the performance implications of the `--inspect` flag and there is none when a debugger is not attached.  However, when one is attached it is 100x to 300x according to [this thread](https://stackoverflow.com/questions/45379080/does-the-node-inspect-flag-have-any-notable-performance-impact) on SO.\r\n\r\n[This post](https://stackoverflow.com/questions/59743800/is-it-a-good-idea-to-enable-inspect-for-nodejs-in-production-kubernetes) elaborates a bit on the security risks but it also mentions that debugging can be flipped on with `kill -usr1 ${PID}` but I have not tested.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499828642/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499857873",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1499857873",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1499857873,
    "node_id": "IC_kwDOCD5_Gc5ZZgPR",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-07T02:15:36Z",
    "updated_at": "2023-04-10T14:51:39Z",
    "author_association": "MEMBER",
    "body": "During my journey I found an interesting video...\r\nhttps://www.youtube.com/watch?v=Xb_0awoShR8&t=570s\r\n\r\nUpdated. The speaker talks about `process._debugProcess(pid)` to turn on debugging from outside of a running node instance.  It is what node uses [under the hood](https://github.com/nodejs/node/blob/4166d40d0873b6d8a0c7291872c8d20dc680b1d7/lib/internal/debugger/inspect.js#L319) to turn on debugging incidentally. It and [_debugEnd](https://github.com/nodejs/node/blob/4166d40d0873b6d8a0c7291872c8d20dc680b1d7/lib/internal/bootstrap/switches/is_main_thread.js#L13) are available. \r\n\r\nThis is another highlight\r\nhttps://youtu.be/Xb_0awoShR8?t=682\r\n\r\nUpdated. The speaker talks about the core debugging protocol and using it for profiling.  See the links below for more detail:\r\nhttps://nodejs.org/dist/latest-v18.x/docs/api/inspector.html#cpu-profiler\r\nhttps://chromedevtools.github.io/devtools-protocol/v8/Profiler/\r\n\r\nstarting to get somewhere notable I think ðŸ˜„",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499857873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499882718",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1499882718",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1499882718,
    "node_id": "IC_kwDOCD5_Gc5ZZmTe",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-07T03:04:49Z",
    "updated_at": "2023-04-07T03:24:58Z",
    "author_association": "MEMBER",
    "body": "@dapplion I also found the reference that I mentioned on standup, it is a youtube video. It wasn't a blog is why I couldn't find with a google search.  It is a Netflix engineer talking about flame graphs on running node process in prod.\r\n\r\nThe speaker talks about the `--perf` flags mentioned above in [this video here](https://youtu.be/O1YP8QP9gLA?t=477) and in particular the usage for `--perf-basic-prof-only-functions` to generate the flamegraph. He mentions that it is very low impact on the running process.\r\n\r\nThey are using a linux library [perf](https://perf.wiki.kernel.org/index.php/Main_Page) and describe how they implement [here](https://youtu.be/O1YP8QP9gLA?t=402).  It is the same library that `Ox` is using for linux.\r\n\r\nNetflix is using [brendangregg/FlameGraph](https://github.com/brendangregg/FlameGraph) to generate the flamegraphs.  `Ox` is using a custom implementation that [renders](https://github.com/davidmarkclements/0x/blob/8d34f06bce33c287e6e50ee602ef4b1b55175101/lib/render.js) and bundles an html page that is [in source](https://github.com/davidmarkclements/0x/tree/8d34f06bce33c287e6e50ee602ef4b1b55175101/visualizer).\r\n\r\nAs a note there was some GREAT other stuff in that video about post mortem debugging with core-dumps that was very interesting.  The whole video is def worth watching.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1499882718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1510774218",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1510774218",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1510774218,
    "node_id": "IC_kwDOCD5_Gc5aDJXK",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-17T06:22:54Z",
    "updated_at": "2023-04-17T06:26:29Z",
    "author_association": "MEMBER",
    "body": "@dapplion checkout a branch diff [here](https://github.com/ChainSafe/lodestar/compare/unstable...mkeil/flamegraph) that has an idea for how to generate the stack traces.  I talked with @Faithtosin about strategies to collect the flamegraph data when not running locally.  Please tell me what you think.\r\n\r\n@Faithtosin was asking me about the scope for where and when you would like to run this?  Is it just something contributors will want to run on the cloud nodes or should it run locally?  I have had challenges running on mac.  I have only tried to catch OS level and not v8 level on mac though to mimic what happens on linux",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1510774218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1511294719",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1511294719",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1511294719,
    "node_id": "IC_kwDOCD5_Gc5aFIb_",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-17T13:00:13Z",
    "updated_at": "2023-04-17T23:19:48Z",
    "author_association": "MEMBER",
    "body": "@tuyennhv captures CPU profiles regularly to ensure Lodestar performance profile is good, i.e. So we usually:\r\n- Capture CPU profiles every 2 weeks on latest unstable to understand what's the next target for optimization\r\n- Capture CPU profiles on feature branches to ensure they don't introduce visible regressions\r\n\r\nSo we always run on demand on specific machines. The goal here it to make it easier so we do it more often. But I'm not sure we should bake it into production code, sounds more like a job for external tooling\n\nIt should be run on our test nodes in the cloud",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1511294719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1519123913",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/5341#issuecomment-1519123913",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5341",
    "id": 1519123913,
    "node_id": "IC_kwDOCD5_Gc5ai_3J",
    "user": {
      "login": "matthewkeil",
      "id": 18608739,
      "node_id": "MDQ6VXNlcjE4NjA4NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/18608739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthewkeil",
      "html_url": "https://github.com/matthewkeil",
      "followers_url": "https://api.github.com/users/matthewkeil/followers",
      "following_url": "https://api.github.com/users/matthewkeil/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthewkeil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthewkeil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthewkeil/subscriptions",
      "organizations_url": "https://api.github.com/users/matthewkeil/orgs",
      "repos_url": "https://api.github.com/users/matthewkeil/repos",
      "events_url": "https://api.github.com/users/matthewkeil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthewkeil/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-23T18:09:59Z",
    "updated_at": "2023-04-23T18:09:59Z",
    "author_association": "MEMBER",
    "body": "@dapplion I added as many references that I could [here](https://github.com/matthewkeil/flamegraph/blob/main/doc/implementation-notes.md). It has most of the breadcrumbs that I found and the libraries that I seriously considered (and looked through the code).  The rest that came up by searching were either not widely used (less that 100 installs weekly) or were very old and hadn't had a commit since 2017",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1519123913/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
