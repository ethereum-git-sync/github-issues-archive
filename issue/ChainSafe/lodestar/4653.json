{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4653",
  "id": 1402209514,
  "node_id": "I_kwDOCD5_Gc5TlATq",
  "number": 4653,
  "title": "Unstable BLS performance",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-10-09T09:12:46Z",
  "updated_at": "2022-11-04T09:47:19Z",
  "closed_at": "2022-11-04T09:47:19Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nOn deployment of `unstable` or `v1.2.0-rc.0` to `unstable, beta, feat1, feat2`, I see different performance of BLS, which leads to different time on gossip validation.\r\n\r\n- On beta since we deploy `v1.2.0-rc.0`, we have worse BLS performance: longer `from worker latency`, longer job wait time, lower utilization rate\r\n\r\n<img width=\"1612\" alt=\"Screen Shot 2022-10-09 at 15 51 17\" src=\"https://user-images.githubusercontent.com/10568965/194747354-511270a8-11e0-4c74-8762-ca9537f4516c.png\">\r\n\r\n- On unstable group, both the job wait time is smaller/more stable, also the `job wait time`\r\n\r\n<img width=\"1564\" alt=\"Screen Shot 2022-10-09 at 15 52 38\" src=\"https://user-images.githubusercontent.com/10568965/194747400-bc403684-25c3-40c3-a146-1b23c41a0bac.png\">\r\n\r\nWorse BLS performance leads to longer gossip validation time\r\n- Beta\r\n\r\n<img width=\"779\" alt=\"Screen Shot 2022-10-09 at 15 58 00\" src=\"https://user-images.githubusercontent.com/10568965/194747654-2b6f7e1b-a7f4-4b87-afe1-27fde1d62870.png\">\r\n\r\n- Unstable\r\n\r\n<img width=\"966\" alt=\"Screen Shot 2022-10-09 at 15 59 00\" src=\"https://user-images.githubusercontent.com/10568965/194747690-2fcb1b14-0f26-40d7-93ce-05eacf96f574.png\">\r\n\r\nThe worse BLS performance, the worse performance of node overall including the I/O lagged issue in #4600\r\n\r\nSimilar metrics are monitored in feat1 and feat2\r\n\r\n**Expected behavior**\r\n\r\nStable performance of BLS",
  "closed_by": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1302965294",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4653#issuecomment-1302965294",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653",
    "id": 1302965294,
    "node_id": "IC_kwDOCD5_Gc5Nqawu",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-04T04:48:20Z",
    "updated_at": "2022-11-04T04:48:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "right now it tends to always offload to the 1st worker thread, and if that cpu is busy (by any tasks outside of lodestar) it could have high latency. We could try offloading to the smallest latency worker thread.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1302965294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1303186375",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4653#issuecomment-1303186375",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4653",
    "id": 1303186375,
    "node_id": "IC_kwDOCD5_Gc5NrQvH",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-04T09:47:19Z",
    "updated_at": "2022-11-04T09:47:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "turned out `beta md16` used this cpu type `Model name:                      Intel(R) Xeon(R) CPU E5-2620 v3 @ 2.40GHz`\r\n\r\nwhile others `md16` use this cpu type `AMD EPYC 7282 16-Core Processor`\r\n\r\nthe inconsistency also happened in the epoch transition metric",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1303186375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
