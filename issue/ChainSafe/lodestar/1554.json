{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/1554",
  "id": 705063966,
  "node_id": "MDU6SXNzdWU3MDUwNjM5NjY=",
  "number": 1554,
  "title": "Massive repo size",
  "user": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-09-20T07:48:32Z",
  "updated_at": "2021-03-18T10:52:34Z",
  "closed_at": "2021-03-18T10:52:34Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "`ChainSafe/lodestar` currently weighs 131.75MB on clone. This is way too much for a src, and we should fix it.\r\n\r\n```\r\nlion@lion:~/Code/eth2.0$ git clone git@github.com:ChainSafe/lodestar.git\r\nCloning into 'lodestar'...\r\nremote: Enumerating objects: 3768, done.\r\nremote: Counting objects: 100% (3768/3768), done.\r\nremote: Compressing objects: 100% (681/681), done.\r\nremote: Total 303063 (delta 2007), reused 3339 (delta 1669), pack-reused 299295\r\nReceiving objects: 100% (303063/303063), 131.75 MiB | 892.00 KiB/s, done.\r\nResolving deltas: 100% (185861/185861), done.\r\n```\r\n\r\nThere seems to be a binary of prometheus in the scripts directory https://github.com/ChainSafe/lodestar/blob/master/scripts/prometheus is that an error?",
  "closed_by": {
    "login": "dapplion",
    "id": 35266934,
    "node_id": "MDQ6VXNlcjM1MjY2OTM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dapplion",
    "html_url": "https://github.com/dapplion",
    "followers_url": "https://api.github.com/users/dapplion/followers",
    "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
    "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
    "organizations_url": "https://api.github.com/users/dapplion/orgs",
    "repos_url": "https://api.github.com/users/dapplion/repos",
    "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dapplion/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/696036458",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1554#issuecomment-696036458",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554",
    "id": 696036458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjAzNjQ1OA==",
    "user": {
      "login": "mpetrunic",
      "id": 8836210,
      "node_id": "MDQ6VXNlcjg4MzYyMTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8836210?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpetrunic",
      "html_url": "https://github.com/mpetrunic",
      "followers_url": "https://api.github.com/users/mpetrunic/followers",
      "following_url": "https://api.github.com/users/mpetrunic/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpetrunic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpetrunic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpetrunic/subscriptions",
      "organizations_url": "https://api.github.com/users/mpetrunic/orgs",
      "repos_url": "https://api.github.com/users/mpetrunic/repos",
      "events_url": "https://api.github.com/users/mpetrunic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpetrunic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-21T10:42:58Z",
    "updated_at": "2020-09-21T10:42:58Z",
    "author_association": "MEMBER",
    "body": "i'm in favor of removing that. We could create some docker-compose to set those things up",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/696036458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/767168502",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1554#issuecomment-767168502",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554",
    "id": 767168502,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NzE2ODUwMg==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-25T23:01:53Z",
    "updated_at": "2021-01-25T23:01:53Z",
    "author_association": "MEMBER",
    "body": "Repo size is still huge since this file will leave forever in the git history https://github.com/ChainSafe/lodestar/commit/79ac7f76\r\n\r\nThe only way to get rid of it is by re-writing this repo's git history from that commit (see the process below). It's quite dramatic because all existing tags and commits hash will change, but it's doable.\r\n\r\n```     \r\nubuntu@lodestar-cloud-01:~$ java -jar bfg-1.13.2.jar  --strip-blobs-bigger-than 50M lodestar/\r\n\r\nUsing repo : /home/ubuntu/lodestar/.git\r\n\r\nScanning packfile for large blobs: 614687\r\nScanning packfile for large blobs completed in 9,751 ms.\r\nFound 1 blob ids for large blobs - biggest=84346472 smallest=84346472\r\nTotal size (unpacked)=84346472\r\nFound 1180 objects to protect\r\nFound 3 tag-pointing refs : refs/tags/v0.13.0, refs/tags/v0.14.0, refs/tags/v0.6.0\r\nFound 65 commit-pointing refs : HEAD, refs/heads/master, refs/remotes/origin/HEAD, ...\r\n\r\nProtected commits\r\n-----------------\r\n\r\n\r\nThese are your protected commits, and so their contents will NOT be altered:\r\n\r\n * commit 83f69eee (protected by 'HEAD')\r\n\r\nCleaning\r\n--------\r\n\r\nFound 7221 commits\r\nCleaning commits:       100% (7221/7221)\r\nCleaning commits completed in 15,058 ms.\r\n\r\nUpdating 65 Refs\r\n----------------\r\n\r\n\tRef                                                                      Before     After   \r\n\t--------------------------------------------------------------------------------------------\r\n\trefs/heads/master                                                      | 83f69eee | b75aa1b3\r\n\trefs/remotes/origin/P0/config-logger                                   | 92279f64 | 71c289b1\r\n\trefs/remotes/origin/P0/error-types                                     | f14eb641 | fdf75718\r\n\trefs/remotes/origin/P0/medalla-genesis                                 | 0472c8e3 | 61aae95f\r\n\trefs/remotes/origin/P0/validator-service-data                          | eac48901 | a70497f8\r\n\trefs/remotes/origin/P0/volexit-cli                                     | 5590302f | 96c325c1\r\n\trefs/remotes/origin/cayman/ssz/merkle-proofs                           | c6bb22cc | c8f1d401\r\n\trefs/remotes/origin/dapplion/benchmark-build                           | e80bd377 | ae80ec14\r\n\trefs/remotes/origin/dapplion/benchmark-build-tsc@v4                    | 088f8a83 | 2fa81ed3\r\n\trefs/remotes/origin/dapplion/clock-recursion                           | d2bb2a72 | 6a8c7354\r\n\trefs/remotes/origin/dapplion/enable-typescript-script-opts             | fa76d9f7 | 33e0fa94\r\n\trefs/remotes/origin/dapplion/eth1-genesis-store-progress               | 12920822 | 8b46cdd7\r\n\trefs/remotes/origin/dapplion/eth1/json-error                           | a2b5af3f | 07266e71\r\n\trefs/remotes/origin/dapplion/process-chain-seg-sync                    | f699d7fc | 3c1d5f9a\r\n\trefs/remotes/origin/dapplion/spec-test-ssz-generic                     | 638ea55d | 8c3ca0d3\r\n\t...\r\n\r\nUpdating references:    100% (65/65)\r\n...Ref update completed in 147 ms.\r\n\r\nCommit Tree-Dirt History\r\n------------------------\r\n\r\n\tEarliest                                              Latest\r\n\t|                                                          |\r\n\t..................DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDmmmmmmmmmm\r\n\r\n\tD = dirty commits (file tree fixed)\r\n\tm = modified commits (commit message or parents changed)\r\n\t. = clean commits (no changes to file tree)\r\n\r\n\t                        Before     After   \r\n\t-------------------------------------------\r\n\tFirst modified commit | 79ac7f76 | 34c9b982\r\n\tLast dirty commit     | e712e7aa | 5ce0705b\r\n\r\nDeleted files\r\n-------------\r\n\r\n\tFilename     Git id            \r\n\t-------------------------------\r\n\tprometheus | d68c273b (80.4 MB)\r\n\r\n\r\nIn total, 7971 object ids were changed. Full details are logged here:\r\n\r\n\t/home/ubuntu/lodestar.bfg-report/2021-01-25/22-54-38\r\n\r\nBFG run is complete! When ready, run: git reflog expire --expire=now --all && git gc --prune=now --aggressive\r\nubuntu@lodestar-cloud-01:~$ git reflog \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/767168502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/801824213",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/1554#issuecomment-801824213",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/1554",
    "id": 801824213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMTgyNDIxMw==",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-18T10:52:34Z",
    "updated_at": "2021-03-18T10:52:34Z",
    "author_association": "MEMBER",
    "body": "Fixing this would require changing the commit hash of all release tags. Also, the weekly volume of commits of this repo is so big that the size of the `prometheus` binary is more diluted than when this issue was opened. :man_shrugging: ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/801824213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
