{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4349",
  "id": 1319510472,
  "node_id": "I_kwDOCD5_Gc5OpiHI",
  "number": 4349,
  "title": "No \"exports\" main defined in @chainsafe/lodestar-api/package.json",
  "user": {
    "login": "oblak1",
    "id": 23618471,
    "node_id": "MDQ6VXNlcjIzNjE4NDcx",
    "avatar_url": "https://avatars.githubusercontent.com/u/23618471?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/oblak1",
    "html_url": "https://github.com/oblak1",
    "followers_url": "https://api.github.com/users/oblak1/followers",
    "following_url": "https://api.github.com/users/oblak1/following{/other_user}",
    "gists_url": "https://api.github.com/users/oblak1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/oblak1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/oblak1/subscriptions",
    "organizations_url": "https://api.github.com/users/oblak1/orgs",
    "repos_url": "https://api.github.com/users/oblak1/repos",
    "events_url": "https://api.github.com/users/oblak1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/oblak1/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2022-07-27T12:43:30Z",
  "updated_at": "2022-10-25T18:32:47Z",
  "closed_at": "2022-08-02T12:11:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--NOTE: -->\r\n<!--- General questions should go to the discord chat instead of the issue tracker.-->\r\n\r\n**Describe the bug**\r\nI'm trying to index beacon chain with _@chainsafe/lodestar-api_ version 0.39.0 but I keep getting  this error:\r\n```\r\nError [ERR_PACKAGE_PATH_NOT_EXPORTED]: No \"exports\" main defined in /node_modules/@chainsafe/lodestar-api/package.json\r\n    at new NodeError (node:internal/errors:372:5)\r\n    at throwExportsNotFound (node:internal/modules/esm/resolve:472:9)\r\n    at packageExportsResolve (node:internal/modules/esm/resolve:693:7)\r\n    at resolveExports (node:internal/modules/cjs/loader:482:36)\r\n    at Function.Module._findPath (node:internal/modules/cjs/loader:522:31)\r\n    at Function.Module._resolveFilename (node:internal/modules/cjs/loader:919:27)\r\n    at Function.Module._resolveFilename.sharedData.moduleResolveFilenameHook.installedValue [as _resolveFilename] (/home/explorer/multichain-explorer/node_modules/@cspotcode/source-map-support/source-map-support.js:811:30)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:778:27)\r\n    at Module.require (node:internal/modules/cjs/loader:1005:19)\r\n    at require (node:internal/modules/cjs/helpers:102:18) {\r\n  code: 'ERR_PACKAGE_PATH_NOT_EXPORTED'\r\n}\r\n```\r\n\r\nI'm trying to use getClient method. I'm using node v16 with yarn 1.x (monorepo setup) on Ubuntu, running it with ts-node in development mode.\r\n\r\n```\r\nimport { getClient } from '@chainsafe/lodestar-api';\r\nimport { config } from '@chainsafe/lodestar-config/default';\r\n...\r\n  const api = getClient(\r\n    {\r\n      baseUrl: 'eth2-beacon-mainnet.infura.io',\r\n    },\r\n    { config }\r\n  );\r\n```\r\n\r\nInterestingly the _import { config } from '@chainsafe/lodestar-config/default';_ works fine.\r\n\r\nThe exports part of the package.json (lodestar-api) looks like this:\r\n\r\n  ```\r\n...\r\n\"exports\": {\r\n    \".\": {\r\n      \"import\": \"./lib/index.js\"\r\n    },\r\n    \"./beacon\": {\r\n      \"import\": \"./lib/beacon/index.js\"\r\n    },\r\n    \"./beacon/server\": {\r\n      \"import\": \"./lib/beacon/server/index.js\"\r\n    },\r\n    \"./builder\": {\r\n      \"import\": \"./lib/builder/index.js\"\r\n    },\r\n    \"./builder/server\": {\r\n      \"import\": \"./lib/builder/server/index.js\"\r\n    },\r\n    \"./keymanager\": {\r\n      \"import\": \"./lib/keymanager/index.js\"\r\n    },\r\n    \"./keymanager/server\": {\r\n      \"import\": \"./lib/keymanager/server/index.js\"\r\n    }\r\n  },\r\n...\r\n```\r\nMeaning it has the necessary \"exports\" paths. Any help is appreciated. \r\n\r\n",
  "closed_by": {
    "login": "oblak1",
    "id": 23618471,
    "node_id": "MDQ6VXNlcjIzNjE4NDcx",
    "avatar_url": "https://avatars.githubusercontent.com/u/23618471?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/oblak1",
    "html_url": "https://github.com/oblak1",
    "followers_url": "https://api.github.com/users/oblak1/followers",
    "following_url": "https://api.github.com/users/oblak1/following{/other_user}",
    "gists_url": "https://api.github.com/users/oblak1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/oblak1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/oblak1/subscriptions",
    "organizations_url": "https://api.github.com/users/oblak1/orgs",
    "repos_url": "https://api.github.com/users/oblak1/repos",
    "events_url": "https://api.github.com/users/oblak1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/oblak1/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196857990",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1196857990",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1196857990,
    "node_id": "IC_kwDOCD5_Gc5HVpqG",
    "user": {
      "login": "wemeetagain",
      "id": 1348242,
      "node_id": "MDQ6VXNlcjEzNDgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wemeetagain",
      "html_url": "https://github.com/wemeetagain",
      "followers_url": "https://api.github.com/users/wemeetagain/followers",
      "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
      "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
      "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
      "repos_url": "https://api.github.com/users/wemeetagain/repos",
      "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-27T14:47:05Z",
    "updated_at": "2022-07-27T14:47:05Z",
    "author_association": "MEMBER",
    "body": "Try running with `ts-node --esm`",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196857990/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196899205",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1196899205",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1196899205,
    "node_id": "IC_kwDOCD5_Gc5HVzuF",
    "user": {
      "login": "oblak1",
      "id": 23618471,
      "node_id": "MDQ6VXNlcjIzNjE4NDcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/23618471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oblak1",
      "html_url": "https://github.com/oblak1",
      "followers_url": "https://api.github.com/users/oblak1/followers",
      "following_url": "https://api.github.com/users/oblak1/following{/other_user}",
      "gists_url": "https://api.github.com/users/oblak1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oblak1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oblak1/subscriptions",
      "organizations_url": "https://api.github.com/users/oblak1/orgs",
      "repos_url": "https://api.github.com/users/oblak1/repos",
      "events_url": "https://api.github.com/users/oblak1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oblak1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-27T15:19:56Z",
    "updated_at": "2022-07-27T15:20:50Z",
    "author_association": "NONE",
    "body": "Hmm, it didn't work, unfortunately. This is the console:\r\n\r\n```\r\n[nodemon] starting `ts-node --esm ./src/index.ts`\r\nError [ERR_PACKAGE_PATH_NOT_EXPORTED]: No \"exports\" main defined in node_modules/@chainsafe/lodestar-api/package.json\r\n```\r\nIs it possible to debug this problem by changing the lib .js / package.json files?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196899205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196934774",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1196934774",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1196934774,
    "node_id": "IC_kwDOCD5_Gc5HV8Z2",
    "user": {
      "login": "oblak1",
      "id": 23618471,
      "node_id": "MDQ6VXNlcjIzNjE4NDcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/23618471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oblak1",
      "html_url": "https://github.com/oblak1",
      "followers_url": "https://api.github.com/users/oblak1/followers",
      "following_url": "https://api.github.com/users/oblak1/following{/other_user}",
      "gists_url": "https://api.github.com/users/oblak1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oblak1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oblak1/subscriptions",
      "organizations_url": "https://api.github.com/users/oblak1/orgs",
      "repos_url": "https://api.github.com/users/oblak1/repos",
      "events_url": "https://api.github.com/users/oblak1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oblak1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-27T15:48:04Z",
    "updated_at": "2022-07-27T15:48:04Z",
    "author_association": "NONE",
    "body": "I did a little more testing and found out I have to transform my whole project to ES module type so I can normally import and work with the library. \r\nSo I can't use commonJS as target in tsconfig file? Am I correct?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1196934774/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1198174972",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1198174972",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1198174972,
    "node_id": "IC_kwDOCD5_Gc5HarL8",
    "user": {
      "login": "wemeetagain",
      "id": 1348242,
      "node_id": "MDQ6VXNlcjEzNDgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wemeetagain",
      "html_url": "https://github.com/wemeetagain",
      "followers_url": "https://api.github.com/users/wemeetagain/followers",
      "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
      "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
      "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
      "repos_url": "https://api.github.com/users/wemeetagain/repos",
      "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-28T13:54:03Z",
    "updated_at": "2022-07-28T13:54:03Z",
    "author_association": "MEMBER",
    "body": "thats right.\r\n\r\nThe alternative is to import the api as a dynamic import:\r\n```ts\r\nconst { getClient } = await import('@chainsafe/lodestar-api')\r\n...\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1198174972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1201134694",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1201134694",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1201134694,
    "node_id": "IC_kwDOCD5_Gc5Hl9xm",
    "user": {
      "login": "oblak1",
      "id": 23618471,
      "node_id": "MDQ6VXNlcjIzNjE4NDcx",
      "avatar_url": "https://avatars.githubusercontent.com/u/23618471?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oblak1",
      "html_url": "https://github.com/oblak1",
      "followers_url": "https://api.github.com/users/oblak1/followers",
      "following_url": "https://api.github.com/users/oblak1/following{/other_user}",
      "gists_url": "https://api.github.com/users/oblak1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oblak1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oblak1/subscriptions",
      "organizations_url": "https://api.github.com/users/oblak1/orgs",
      "repos_url": "https://api.github.com/users/oblak1/repos",
      "events_url": "https://api.github.com/users/oblak1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oblak1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-01T12:26:03Z",
    "updated_at": "2022-08-01T12:26:03Z",
    "author_association": "NONE",
    "body": "Thank you. \r\n\r\nJust one follow up question, if I query the block which has execution payload for example, how do I tell the lodestar client it should apply the correct interface (not allForks.signedBlock but the bellatrix one) so I can get the execution property from object?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1201134694/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1201314038",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1201314038",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1201314038,
    "node_id": "IC_kwDOCD5_Gc5Hmpj2",
    "user": {
      "login": "wemeetagain",
      "id": 1348242,
      "node_id": "MDQ6VXNlcjEzNDgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wemeetagain",
      "html_url": "https://github.com/wemeetagain",
      "followers_url": "https://api.github.com/users/wemeetagain/followers",
      "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
      "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
      "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
      "repos_url": "https://api.github.com/users/wemeetagain/repos",
      "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-01T14:56:29Z",
    "updated_at": "2022-08-01T14:56:29Z",
    "author_association": "MEMBER",
    "body": "you can do something like:\r\n`... as bellatrix.SignedBeaconBlock`",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1201314038/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1290427089",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1290427089",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1290427089,
    "node_id": "IC_kwDOCD5_Gc5M6lrR",
    "user": {
      "login": "Stevewu1234",
      "id": 42365700,
      "node_id": "MDQ6VXNlcjQyMzY1NzAw",
      "avatar_url": "https://avatars.githubusercontent.com/u/42365700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Stevewu1234",
      "html_url": "https://github.com/Stevewu1234",
      "followers_url": "https://api.github.com/users/Stevewu1234/followers",
      "following_url": "https://api.github.com/users/Stevewu1234/following{/other_user}",
      "gists_url": "https://api.github.com/users/Stevewu1234/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Stevewu1234/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Stevewu1234/subscriptions",
      "organizations_url": "https://api.github.com/users/Stevewu1234/orgs",
      "repos_url": "https://api.github.com/users/Stevewu1234/repos",
      "events_url": "https://api.github.com/users/Stevewu1234/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Stevewu1234/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-25T11:53:45Z",
    "updated_at": "2022-10-25T11:53:45Z",
    "author_association": "NONE",
    "body": "> I did a little more testing and found out I have to transform my whole project to ES module type so I can normally import and work with the library. So I can't use commonJS as target in tsconfig file? Am I correct?\r\n\r\nHey, can you share your code? I have met the same error, but all of the solution I found didn't work.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1290427089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1290980580",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4349#issuecomment-1290980580",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4349",
    "id": 1290980580,
    "node_id": "IC_kwDOCD5_Gc5M8szk",
    "user": {
      "login": "wemeetagain",
      "id": 1348242,
      "node_id": "MDQ6VXNlcjEzNDgyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wemeetagain",
      "html_url": "https://github.com/wemeetagain",
      "followers_url": "https://api.github.com/users/wemeetagain/followers",
      "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
      "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
      "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
      "repos_url": "https://api.github.com/users/wemeetagain/repos",
      "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-25T18:32:47Z",
    "updated_at": "2022-10-25T18:32:47Z",
    "author_association": "MEMBER",
    "body": "Here's a good explainer for handling ESM:\r\nhttps://gist.github.com/sindresorhus/a39789f98801d908bbc7ff3ecc99d99c",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1290980580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
