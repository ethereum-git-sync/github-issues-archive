{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/5219",
  "id": 1604481317,
  "node_id": "I_kwDOCD5_Gc5fonEl",
  "number": 5219,
  "title": "Vc keeps waiting for both builder and engine blocks",
  "user": {
    "login": "tuyennhv",
    "id": 10568965,
    "node_id": "MDQ6VXNlcjEwNTY4OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuyennhv",
    "html_url": "https://github.com/tuyennhv",
    "followers_url": "https://api.github.com/users/tuyennhv/followers",
    "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
    "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
    "repos_url": "https://api.github.com/users/tuyennhv/repos",
    "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090447,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDQ3",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-high",
      "name": "prio-high",
      "color": "fd9579",
      "default": false,
      "description": "Resolve issues as soon as possible."
    },
    {
      "id": 4116804709,
      "node_id": "LA_kwDOCD5_Gc71YXRl",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-profitability",
      "name": "scope-profitability",
      "color": "980043",
      "default": false,
      "description": "Issues to directly improve validator performance and its profitability."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "g11tech",
    "id": 76567250,
    "node_id": "MDQ6VXNlcjc2NTY3MjUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g11tech",
    "html_url": "https://github.com/g11tech",
    "followers_url": "https://api.github.com/users/g11tech/followers",
    "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
    "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
    "organizations_url": "https://api.github.com/users/g11tech/orgs",
    "repos_url": "https://api.github.com/users/g11tech/repos",
    "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g11tech/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-03-01T08:10:30Z",
  "updated_at": "2023-03-06T07:21:12Z",
  "closed_at": "2023-03-06T07:21:12Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nThis happens on mainnet, bn log:\r\n\r\n```\r\nFeb-28 19:45:35.000[chain]         ^[[36mverbose^[[39m: Clock slot slot=5899126\r\nFeb-28 19:45:35.040[rest]            ^[[34mdebug^[[39m: Req req-gssm produceBlindedBlock\r\nFeb-28 19:45:35.129[rest]            ^[[34mdebug^[[39m: Req req-gssn getProposerDuties\r\nFeb-28 19:45:35.129[rest]            ^[[34mdebug^[[39m: Req req-gsso produceBlockV2\r\nFeb-28 19:45:35.317[rest]            ^[[34mdebug^[[39m: Res req-gssn getProposerDuties - 200\r\nFeb-28 19:45:36.539[rest]            ^[[34mdebug^[[39m: Res req-gssm produceBlindedBlock - 200\r\nFeb-28 19:45:44.222[rest]            ^[[34mdebug^[[39m: Res req-gsso produceBlockV2 - 200\r\n```\r\n==> there was 9s delay producing block from bn `produceBlockV2` and vc keeps waiting for that\r\n\r\nvc logs\r\n\r\n```\r\nFeb-28 19:45:35.001[]                ^[[34mdebug^[[39m: Producing block slot=5899126, validator=0xb88b38d7e613353b29120bd1c34e53db77deeaf03ed30111c273fa6ba61e3d63ab713fd99e090ebbf87492637cef46b8\r\nFeb-28 19:45:35.002[]                ^[[34mdebug^[[39m: HttpClient request routeId=produceBlindedBlock\r\nFeb-28 19:45:35.002[]                ^[[34mdebug^[[39m: HttpClient request routeId=produceBlockV2\r\nFeb-28 19:45:35.642[]                ^[[34mdebug^[[39m: HttpClient response routeId=produceBlockV2\r\nFeb-28 19:45:36.571[]                ^[[34mdebug^[[39m: HttpClient response routeId=produceBlindedBlock\r\nFeb-28 19:45:47.004[]                ^[[34mdebug^[[39m: Request error, retrying  Timeout request\r\nError: Timeout request\r\n    at HttpClient.requestWithBody (file:///usr/app/packages/api/src/utils/client/httpClient.ts:298:17)\r\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\r\nFeb-28 19:45:47.004[]                ^[[34mdebug^[[39m: Requesting fallback URL routeId=produceBlockV2, baseUrl=http://***:9596, score=10\r\nFeb-28 19:45:59.000[]                ^[[34mdebug^[[39m: HttpClient request routeId=getProposerDuties\r\nFeb-28 19:45:59.005[]                ^[[31merror^[[39m: Failed to produce execution block  Timeout request\r\nError: Timeout request\r\n    at HttpClient.requestWithBody (file:///usr/app/packages/api/src/utils/client/httpClient.ts:298:17)\r\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\r\nFeb-28 19:45:59.005[]                ^[[34mdebug^[[39m: Produced block slot=5899126, validator=0xb88b38d7e613353b29120bd1c34e53db77deeaf03ed30111c273fa6ba61e3d63ab713fd99e090ebbf87492637cef46b8, source=builder, blockValue=40189560818336940\r\n```\r\n\r\n==> vc wait for `produceBlock` on first url then got timed out error after 12s, then try the fallback url and got timed out error after 12s, it's 24s in total\r\n\r\nvc got the blinded block early but had to wait for 24s for nothing (supposed to get execution block)\r\n\r\nThe result is a big delay of block reaching bn and that block became missed\r\n\r\n```\r\nbeacon-2023-02-28.log:1047384:Feb-28 19:46:00.407[chain]         verbose: Added block to forkchoice slot=5899126, root=0x6e3272efebf0b145a3462d782e95115d605456c5dba5856939c9d594a8f301f8\r\nbeacon-2023-02-28.log:1047387:Feb-28 19:46:00.524[chain]         verbose: Block processed slot=5899126, root=0x6e3272efebf0b145a3462d782e95115d605456c5dba5856939c9d594a8f301f8, delaySec=25.5239999294281\r\n```\r\n\r\n**Expected behavior**\r\n\r\nIn this case the blinded block was on time, we should implement some timeout and pick whatever return instead of waiting for both execution block and builder block\r\n",
  "closed_by": {
    "login": "g11tech",
    "id": 76567250,
    "node_id": "MDQ6VXNlcjc2NTY3MjUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g11tech",
    "html_url": "https://github.com/g11tech",
    "followers_url": "https://api.github.com/users/g11tech/followers",
    "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
    "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
    "organizations_url": "https://api.github.com/users/g11tech/orgs",
    "repos_url": "https://api.github.com/users/g11tech/repos",
    "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g11tech/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/5219/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
