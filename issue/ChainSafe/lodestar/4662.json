{
  "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
  "repository_url": "https://api.github.com/repos/ChainSafe/lodestar",
  "labels_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662/labels{/name}",
  "comments_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662/comments",
  "events_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662/events",
  "html_url": "https://github.com/ChainSafe/lodestar/issues/4662",
  "id": 1413007037,
  "node_id": "I_kwDOCD5_Gc5UOMa9",
  "number": 4662,
  "title": "Bug: Lodestar can't self connect to itself in local mutli node test",
  "user": {
    "login": "g11tech",
    "id": 76567250,
    "node_id": "MDQ6VXNlcjc2NTY3MjUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/g11tech",
    "html_url": "https://github.com/g11tech",
    "followers_url": "https://api.github.com/users/g11tech/followers",
    "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
    "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
    "organizations_url": "https://api.github.com/users/g11tech/orgs",
    "repos_url": "https://api.github.com/users/g11tech/repos",
    "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
    "received_events_url": "https://api.github.com/users/g11tech/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1200090450,
      "node_id": "MDU6TGFiZWwxMjAwMDkwNDUw",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/prio-critical",
      "name": "prio-critical",
      "color": "fd6f60",
      "default": false,
      "description": "Drop everything to resolve this immediately. Examples: consensus bug, un-usable CLI"
    },
    {
      "id": 2155825090,
      "node_id": "MDU6TGFiZWwyMTU1ODI1MDkw",
      "url": "https://api.github.com/repos/ChainSafe/lodestar/labels/scope-networking",
      "name": "scope-networking",
      "color": "980043",
      "default": false,
      "description": "All issues related to networking, gossip, and libp2p."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2022-10-18T10:55:52Z",
  "updated_at": "2022-10-20T18:02:09Z",
  "closed_at": "2022-10-20T18:02:09Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "From 1.2.0rc-0, lodestar isn't able to self connect to itself, which was not an issue <= 1.1.0\r\n\r\n###setup \r\n#### peer 1 \r\nargs: ` lodestar dev --eth false --enr.ip 127.0.0.1 --enr.tcp 9000 --enr.udp 9000 --genesisValidators 8 --startValidators 0..3 --logLevel debug`\r\n#### peer 2\r\nargs: `lodestar dev --eth1 false --genesisValidators 8 --startValidators 4..7 --port 9001 --bootnodes <peer 1 enr> --network.connectToDiscv5Bootnodes`\r\n\r\nError that shows on peer2 while connecting to peer1:\r\n```typescript\r\nEph -1/4 5.024[network]       verbose: Req  error method=ping, encoding=ssz_snappy, client=Unknown, peer=16...kzLQxQ, requestId=0 code=REQUEST_ERROR_DIAL_ERROR, error=write EPIPE\r\nError: write EPIPE\r\n    at afterWriteDispatched (node:internal/stream_base_commons:160:15)\r\n    at writeGeneric (node:internal/stream_base_commons:151:3)\r\n    at Socket._writeGeneric (node:net:874:11)\r\n    at Socket._write (node:net:886:8)\r\n    at writeOrBuffer (node:internal/streams/writable:391:12)\r\n    at _write (node:internal/streams/writable:332:10)\r\n    at Socket.Writable.write (node:internal/streams/writable:336:10)\r\n    at /usr/app/node_modules/stream-to-it/sink.js:71:20\r\n    at Object.sink (file:///usr/app/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9)\r\nError: REQUEST_ERROR_DIAL_ERROR\r\n    at file:///usr/app/packages/beacon-node/src/network/reqresp/request/index.ts:102:15\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at sendRequest (file:///usr/app/packages/beacon-node/src/network/reqresp/request/index.ts:88:20)\r\n    at ReqResp.sendRequest (file:///usr/app/packages/beacon-node/src/network/reqresp/reqResp.ts:157:22)\r\n    at ReqResp.ping (file:///usr/app/packages/beacon-node/src/network/reqresp/reqResp.ts:103:12)\r\n    at PeerManager.requestPing (file:///usr/app/packages/beacon-node/src/network/peers/peerManager.ts:348:25)\r\n```\r\non peer1 corresponding log:\r\n```typescript\r\nEph -1/4 4.993[network]       verbose: peer connected peer=16...NBb3vb, direction=inbound, status=OPEN\r\nEph -1/4 5.004[network]       verbose: peer disconnected peer=16...NBb3vb, direction=inbound, status=CLOSED\r\nEph -1/4 5.004[network]       verbose: peer connected peer=16...NBb3vb, direction=inbound, status=OPEN\r\nEph\r\n```\r\n\r\nAlso when we do Ctr^C on peer2 to stop it since its not connecting to peer 1, it gives a further log:\r\n```typescript\r\nph -1/5 3.001[]                 info: Synced - slot: -3 - head: 0 0xa424…644e - finalized: 0x0000…0000:0 - peers: 0\r\nEph -1/5 3.844[rest]            error: Req req-e eventstream error  aborted\r\nError: aborted\r\n    at connResetException (node:internal/errors:704:14)\r\n    at abortIncoming (node:_http_server:625:17)\r\n    at socketOnClose (node:_http_server:619:3)\r\n    at Socket.emit (node:events:525:35)\r\n    at TCP.<anonymous> (node:net:757:14)\r\n^Cexit signal recived\r\ncleaning up\r\n```\r\n\r\nReason could be the libp2p upgrade that has been causing other issues : \r\n- https://github.com/ChainSafe/lodestar/issues/4661\r\n- https://github.com/ChainSafe/lodestar/issues/4660#issuecomment-1280411436",
  "closed_by": {
    "login": "wemeetagain",
    "id": 1348242,
    "node_id": "MDQ6VXNlcjEzNDgyNDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1348242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wemeetagain",
    "html_url": "https://github.com/wemeetagain",
    "followers_url": "https://api.github.com/users/wemeetagain/followers",
    "following_url": "https://api.github.com/users/wemeetagain/following{/other_user}",
    "gists_url": "https://api.github.com/users/wemeetagain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wemeetagain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wemeetagain/subscriptions",
    "organizations_url": "https://api.github.com/users/wemeetagain/orgs",
    "repos_url": "https://api.github.com/users/wemeetagain/repos",
    "events_url": "https://api.github.com/users/wemeetagain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wemeetagain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282519043",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1282519043",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1282519043,
    "node_id": "IC_kwDOCD5_Gc5McbAD",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-18T14:49:37Z",
    "updated_at": "2022-10-18T14:49:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "`client=Unknown` => looks like we're not able to detect another lodestar node since this PR  https://github.com/ChainSafe/lodestar/pull/4612/files",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282519043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282543216",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1282543216",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1282543216,
    "node_id": "IC_kwDOCD5_Gc5Mcg5w",
    "user": {
      "login": "dapplion",
      "id": 35266934,
      "node_id": "MDQ6VXNlcjM1MjY2OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35266934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dapplion",
      "html_url": "https://github.com/dapplion",
      "followers_url": "https://api.github.com/users/dapplion/followers",
      "following_url": "https://api.github.com/users/dapplion/following{/other_user}",
      "gists_url": "https://api.github.com/users/dapplion/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dapplion/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dapplion/subscriptions",
      "organizations_url": "https://api.github.com/users/dapplion/orgs",
      "repos_url": "https://api.github.com/users/dapplion/repos",
      "events_url": "https://api.github.com/users/dapplion/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dapplion/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-18T15:04:09Z",
    "updated_at": "2022-10-18T15:04:09Z",
    "author_association": "MEMBER",
    "body": "@g11tech can you run again with `DEBUG=*` on both nodes?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282543216/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282896888",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1282896888",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1282896888,
    "node_id": "IC_kwDOCD5_Gc5Md3P4",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-18T19:24:39Z",
    "updated_at": "2022-10-18T19:24:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "selecting the relvant bits \r\n\r\nOn peer2 (peer1 is the bootnode, so peer2 dials peer1)\r\n```typescript\r\nlibp2p:connection-manager dial to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +725ms\r\n  libp2p:dialer check multiaddrs 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +0ms\r\n  libp2p:dialer creating dial target for 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +0ms\r\n libp2p:peer-store:proto-book added provided protocols for 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +23ms\r\n  libp2p:peer-store:proto-book:trace add release write lock +7ms\r\n  libp2p:peer-store:address-book:trace getRawEnvelope await read lock +19ms\r\n  libp2p:peer-store:proto-book:trace add await write lock +1ms\r\n  libp2p:peer-store:proto-book:trace get got read lock +0ms\r\n  libp2p:peer-store:address-book:trace getRawEnvelope got read lock +1ms\r\n  libp2p:peer-store:proto-book:trace get release read lock +0ms\r\n  libp2p:peer-store:address-book:trace getRawEnvelope release read lock +0ms\r\n  libp2p:peer-store:proto-book:trace get wait for read lock +12ms\r\n  libp2p:dialer 4 tokens request, returning 2, 98 remaining +108ms\r\n  libp2p:tcp dialing {\"family\":4,\"host\":\"10.244.0.35\",\"transport\":\"tcp\",\"port\":9000} +0ms\r\n  libp2p:tcp dialing {\"family\":4,\"host\":\"10.244.0.35\",\"transport\":\"tcp\",\"port\":9000} +1ms\r\n  libp2p:tcp connection opened {\"family\":4,\"host\":\"10.244.0.35\",\"transport\":\"tcp\",\"port\":9000} +63ms\r\n  libp2p:tcp new outbound connection /ip4/10.244.0.35/tcp/9000/p2p/16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +1ms\r\n  libp2p:upgrader Starting the outbound connection upgrade +0ms\r\n  libp2p:upgrader selecting outbound crypto protocol [ '/noise' ] +0ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/noise\"] +0ms\r\n  libp2p:tcp connection opened {\"family\":4,\"host\":\"10.244.0.35\",\"transport\":\"tcp\",\"port\":9000} +1ms\r\n  libp2p:tcp new outbound connection /ip4/10.244.0.35/tcp/9000/p2p/16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +1ms\r\n  libp2p:upgrader Starting the outbound connection upgrade +2ms\r\n  libp2p:upgrader selecting outbound crypto protocol [ '/noise' ] +0ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/noise\"] +1ms\r\nEph -1/4 3\r\nlibp2p:upgrader encrypting outbound connection to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +6ms\r\n  libp2p:noise Stage 0 - Initiator starting to send first message. +3ms\r\n  libp2p:noise Stage 0 - Initiator finished sending first message. +1ms\r\n  libp2p:noise Stage 1 - Initiator waiting to receive first message from responder... +0ms\r\n  libp2p:noise Stage 1 - Initiator received the message. +15ms\r\n  libp2p:noise Initiator going to check remote's signature... +0ms\r\n  libp2p:noise All good with the signature! +4ms\r\n  libp2p:noise Stage 2 - Initiator sending third handshake message. +0ms\r\n  libp2p:noise Stage 2 - Initiator sent message with signed payload. +2ms\r\nlibp2p:upgrader outbound selecting muxer [ '/mplex/6.7.0' ] +25ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/mplex/6.7.0\"] +25ms\r\n  libp2p:mss:select select: read \"/multistream/1.0.0\" +12ms\r\n  libp2p:mss:select select: read \"/mplex/6.7.0\" +0ms\r\n  libp2p:upgrader /mplex/6.7.0 selected as muxer protocol +12ms\r\n  libp2p:upgrader Successfully upgraded outbound connection +0ms\r\n  libp2p:peer-store:key-book:trace set await write lock +0ms\r\n  libp2p:tcp outbound connection /ip4/10.244.0.35/tcp/9000/p2p/16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse upgraded +66ms\r\n  libp2p:peer-store:key-book:trace set got write lock +1ms\r\n  libp2p:dialer token 0 released +135ms\r\n  libp2p:dialer token 1 released +3ms\r\n  libp2p:dialer dial succeeded to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +0ms\r\n  libp2p:peer-store:key-book:trace set release write lock +4ms\r\n  libp2p:connection-manager:trace checking limit of maxConnections. current value: 1 of 1 +0ms\r\n  libp2p:upgrader outbound: starting new stream on [ '/ipfs/id/1.0.0' ] +6ms\r\n  libp2p:mplex new initiator stream 0 +0ms\r\n  libp2p:mplex:trace initiator stream 0 send { id: 0, type: 'NEW_STREAM (0)', data: '0' } +0ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/ipfs/id/1.0.0\"] +7ms\r\n  libp2p:peer-store:address-book:trace add await write lock +87ms\r\n  libp2p:peer-store:address-book:trace add await write lock +0ms\r\n  libp2p:peer-store:address-book:trace add got write lock +1ms\r\n  libp2p:mplex:trace initiator stream 0 send {\r\n  id: 0,\r\n  type: 'MESSAGE_INITIATOR (2)',\r\n  data: '132f6d756c746973747265616d2f312e302e300a0f2f697066732f69642f312e302e300a'\r\n} +2ms\r\n  libp2p:upgrader:error error multiplexing outbound stream AbortError: The operation was aborted\r\n    at nextAbortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:37:20)\r\n    at EventTarget.abortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:21:37)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10)\r\n    at AbortController.abort (node:internal/abort_controller:122:5)\r\n    at EventTarget.onAbort (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/any-signal/index.js:11:16)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10) {\r\n  type: 'aborted',\r\n  code: 'ABORT_ERR'\r\n} +0ms\r\n  libp2p:upgrader:error Failed to upgrade outbound connection AbortError: The operation was aborted\r\n    at nextAbortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:37:20)\r\n    at EventTarget.abortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:21:37)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10)\r\n    at AbortController.abort (node:internal/abort_controller:122:5)\r\n    at EventTarget.onAbort (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/any-signal/index.js:11:16)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10) {\r\n  type: 'aborted',\r\n  code: 'ERR_MUXER_UNAVAILABLE'\r\n} +4ms\r\n  libp2p:tcp:socket 10.244.0.35:9000 socket was already destroyed when trying to close +0ms\r\n  libp2p:mplex:trace incoming message { id: 0, type: 'NEW_STREAM (0)', data: '0' } +5ms\r\n  libp2p:mplex new receiver stream 0 +8ms\r\n  libp2p:peer-store:address-book:trace set release write lock +5ms\r\n  libp2p:connection-manager dial to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +255ms\r\n  libp2p:connection-manager had an existing connection to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +0ms\r\n  libp2p:upgrader outbound: starting new stream on [ '/eth2/beacon_chain/req/ping/1/ssz_snappy' ] +8ms\r\n  libp2p:mplex new initiator stream 1 +0ms\r\n  libp2p:mplex:trace initiator stream 1 send { id: 1, type: 'NEW_STREAM (0)', data: '1' } +1ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/eth2/beacon_chain/req/ping/1/ssz_snappy\"] +8ms\r\n  libp2p:dialer:error dial to /ip4/10.244.0.35/tcp/9000/p2p/16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse failed AbortError: The operation was aborted\r\n    at nextAbortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:37:20)\r\n    at EventTarget.abortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:21:37)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10)\r\n    at AbortController.abort (node:internal/abort_controller:122:5)\r\n    at EventTarget.onAbort (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/any-signal/index.js:11:16)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10) {\r\n  type: 'aborted',\r\n  code: 'ERR_MUXER_UNAVAILABLE'\r\n} +0ms\r\n libp2p:peer-store:address-book:trace add got write lock +1ms\r\n  libp2p:mplex:trace initiator stream 1 send {\r\n  id: 1,\r\n  type: 'MESSAGE_INITIATOR (2)',\r\n  data: '132f6d756c746973747265616d2f312e302e300a292f657468322f626561636f6e5f636861696e2f7265712f70696e672f312f73737a5f736e617070790a'\r\n} +0ms\r\n  libp2p:peer-store:address-book:trace set release write lock +0ms\r\n  libp2p:connection-manager dial to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +1ms\r\n  libp2p:connection-manager had an existing connection to 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse +0ms\r\n  libp2p:upgrader outbound: starting new stream on [ '/eth2/beacon_chain/req/status/1/ssz_snappy' ] +1ms\r\n  libp2p:mplex new initiator stream 2 +1ms\r\n  libp2p:mplex:trace initiator stream 2 send { id: 2, type: 'NEW_STREAM (0)', data: '2' } +0ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/eth2/beacon_chain/req/status/1/ssz_snappy\"] +0ms\r\n  libp2p:mplex:trace initiator stream 2 send {\r\n  id: 2,\r\n  type: 'MESSAGE_INITIATOR (2)',\r\n  data: '132f6d756c746973747265616d2f312e302e300a2b2f657468322f626561636f6e5f636861696e2f7265712f7374617475732f312f73737a5f736e617070790a'\r\n} +1ms\r\n  libp2p:tcp:socket 10.244.0.35:9000 socket read timeout +3ms\r\n  libp2p:tcp socket error Error: write EPIPE\r\n    at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n    at writeGeneric (node:internal/stream_base_commons:155:3)\r\n    at Socket._writeGeneric (node:net:795:11)\r\n    at Socket._write (node:net:807:8)\r\n    at writeOrBuffer (node:internal/streams/writable:389:12)\r\n    at _write (node:internal/streams/writable:330:10)\r\n    at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n    at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n    at Object.sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) {\r\n  errno: -32,\r\n  code: 'EPIPE',\r\n  syscall: 'write'\r\n} +20ms\r\n  libp2p:tcp:socket Error: write EPIPE\r\n  libp2p:tcp:socket     at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n  libp2p:tcp:socket     at writeGeneric (node:internal/stream_base_commons:155:3)\r\n  libp2p:tcp:socket     at Socket._writeGeneric (node:net:795:11)\r\n  libp2p:tcp:socket     at Socket._write (node:net:807:8)\r\n  libp2p:tcp:socket     at writeOrBuffer (node:internal/streams/writable:389:12)\r\n  libp2p:tcp:socket     at _write (node:internal/streams/writable:330:10)\r\n  libp2p:tcp:socket     at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n  libp2p:tcp:socket     at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n  libp2p:tcp:socket     at Object.sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) +6ms\r\n  libp2p:mplex error in sink Error: write EPIPE\r\n    at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n    at writeGeneric (node:internal/stream_base_commons:155:3)\r\n    at Socket._writeGeneric (node:net:795:11)\r\n    at Socket._write (node:net:807:8)\r\n    at writeOrBuffer (node:internal/streams/writable:389:12)\r\n    at _write (node:internal/streams/writable:330:10)\r\n    at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n    at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n    at Object.sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) {\r\n  errno: -32,\r\n  code: 'EPIPE',\r\n  syscall: 'write'\r\n```\r\n\r\nOn peer1:\r\n```typescript\r\n libp2p:mdns:trace received incoming mDNS query +3s\r\n  libp2p:mdns:query responding to query +3s\r\n  libp2p:mdns:trace received mDNS query response +12ms\r\n  libp2p:mdns:query peer found 16Uiu2HAm5iTmnwh1LZwxv9Qpf6dSyg6ELDhdF1UNAYZzX9Rpd5Vx +3ms\r\n  libp2p:mdns discovered peer in mDNS qeury response 16Uiu2HAm5iTmnwh1LZwxv9Qpf6dSyg6ELDhdF1UNAYZzX9Rpd5Vx +3s\r\n  libp2p:peer-store:address-book:trace add await write lock +3s\r\n  libp2p:peer-store:address-book:trace add got write lock +0ms\r\n  libp2p:peer-store:address-book:trace set release write lock +3ms\r\n  libp2p:mdns:trace received mDNS query response +6ms\r\n  libp2p:mdns:compat:responder:trace got query {\r\n  id: 1,\r\n  type: 'query',\r\n  flags: 0,\r\n  flag_qr: false,\r\n  opcode: 'QUERY',\r\n  flag_aa: false,\r\n  flag_tc: false,\r\n  flag_rd: false,\r\n  flag_ra: false,\r\n  flag_z: false,\r\n  flag_ad: false,\r\n  flag_cd: false,\r\n  rcode: 'NOERROR',\r\n  questions: [ { name: '_ipfs-discovery._udp.local', type: 'PTR', class: 'IN' } ],\r\n  answers: [],\r\n  authorities: [],\r\n  additionals: []\r\n} { address: '10.244.0.35', family: 'IPv4', port: 54136, size: 44 } +5s\r\n  libp2p:mdns:compat:responder:trace responding to query +0ms\r\n  libp2p:mdns:compat:responder:trace query answers [\r\n  {\r\n    name: '_ipfs-discovery._udp.local',\r\n    type: 'PTR',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: '16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse._ipfs-discovery._udp.local'\r\n  },\r\n  {\r\n    name: '16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse._ipfs-discovery._udp.local',\r\n    type: 'TXT',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: [\r\n      <Buffer 31 36 55 69 75 32 48 41 6d 37 4d 6d 4c 36 4e 38 63 6b 34 7a 64 67 75 73 4b 62 67 78 45 5a 63 48 53 31 75 75 4a 76 52 56 4d 77 42 4e 48 41 34 46 62 51 ... 3 more bytes>\r\n    ]\r\n  },\r\n  {\r\n    name: '16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse._ipfs-discovery._udp.local',\r\n    type: 'SRV',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: {\r\n      priority: 10,\r\n      weight: 1,\r\n      port: 9000,\r\n      target: '77f6fbcfd4-hmrnb'\r\n    }\r\n  },\r\n  {\r\n    name: '77f6fbcfd4-hmrnb',\r\n    type: 'A',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: '127.0.0.1'\r\n  },\r\n  {\r\n    name: '16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse._ipfs-discovery._udp.local',\r\n    type: 'SRV',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: {\r\n      priority: 10,\r\n      weight: 1,\r\n      port: 9000,\r\n      target: '7f6fbcfd4-hmrnb'\r\n    }\r\n  },\r\n  {\r\n    name: '77f6fbcfd4-hmrnb',\r\n    type: 'A',\r\n    class: 'IN',\r\n    ttl: 120,\r\n    data: '10.244.0.35'\r\n  }\r\n] +0ms\r\n  libp2p:mdns:trace received incoming mDNS query +2s\r\n  libp2p:mdns:query responding to query +2s\r\n  libp2p:mdns:trace received mDNS query response +18ms\r\n  libp2p:mdns:query peer found 16Uiu2HAm5iTmnwh1LZwxv9Qpf6dSyg6ELDhdF1UNAYZzX9Rpd5Vx +4ms\r\n  libp2p:mdns discovered peer in mDNS qeury response 16Uiu2HAm5iTmnwh1LZwxv9Qpf6dSyg6ELDhdF1UNAYZzX9Rpd5Vx +2s\r\n  libp2p:peer-store:address-book:trace add await write lock +2s\r\n  libp2p:peer-store:address-book:trace add got write lock +0ms\r\n  libp2p:peer-store:address-book:trace set release write lock +5ms\r\n  libp2p:mdns:trace received incoming mDNS query +8ms\r\n  libp2p:mdns:trace received mDNS query response +16ms\r\nEph -1/4 3.062[]                 info: Synced - slot: -4 - head: 0 0xcb06…a914 - finalized: 0x0000…0000:0 - peers: 0\r\n  libp2p:mdns:trace received mDNS query response +204ms\r\n  libp2p:mdns:query peer found 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +231ms\r\n  libp2p:mdns discovered peer in mDNS qeury response 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +231ms\r\n  libp2p:peer-store:address-book:trace add await write lock +226ms\r\n  libp2p:peer-store:address-book:trace add got write lock +0ms\r\n  libp2p:peer-store:address-book added multiaddrs for 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +6s\r\n  libp2p:peer-store:address-book:trace set release write lock +9ms\r\n  libp2p:tcp:listener new inbound connection /ip4/10.244.0.35/tcp/51368 +7s\r\n  libp2p:upgrader starting the inbound connection upgrade +0ms\r\n  libp2p:upgrader handling inbound crypto protocol selection [ '/noise' ] +0ms\r\n  libp2p:tcp:listener new inbound connection /ip4/10.244.0.35/tcp/51374 +5ms\r\n  libp2p:upgrader starting the inbound connection upgrade +4ms\r\n  libp2p:upgrader handling inbound crypto protocol selection [ '/noise' ] +0ms\r\n  libp2p:mss:handle read \"/multistream/1.0.0\" +0ms\r\n  libp2p:mss:handle respond with \"/multistream/1.0.0\" for \"/multistream/1.0.0\" +0ms\r\n  libp2p:mss:handle read \"/noise\" +1ms\r\n  libp2p:mss:handle respond with \"/noise\" for \"/noise\" +0ms\r\n  libp2p:upgrader encrypting inbound connection... +2ms\r\n  libp2p:noise Stage 0 - Responder waiting to receive first message.\r\n  libp2p:mss:handle read \"/multistream/1.0.0\" +4ms\r\n  libp2p:mss:handle respond with \"/multistream/1.0.0\" for \"/multistream/1.0.0\" +0ms\r\n  libp2p:mss:handle read \"/noise\" +0ms\r\n  libp2p:mss:handle respond with \"/noise\" for \"/noise\" +0ms\r\n  libp2p:upgrader encrypting inbound connection... +4ms\r\n  libp2p:noise Stage 0 - Responder waiting to receive first message... +2ms\r\n  libp2p:noise Stage 0 - Responder received first message. +4ms\r\n  libp2p:noise Stage 1 - Responder sending out first message with signed payload and static key. +0ms\r\n  libp2p:noise Stage 1 - Responder sent the second handshake message with signed payload. +7ms\r\n  libp2p:noise Stage 2 - Responder waiting for third handshake message... +0ms\r\n  libp2p:noise Stage 0 - Responder received first message. +2ms\r\n  libp2p:noise Stage 1 - Responder sending out first message with signed payload and static key. +0ms\r\n  libp2p:noise Stage 1 - Responder sent the second handshake message with signed payload. +5ms\r\n  libp2p:noise Stage 2 - Responder waiting for third handshake message... +0ms\r\n  libp2p:noise Stage 2 - Responder received the message, finished handshake. +14ms\r\n  libp2p:upgrader inbound handling muxers [ '/mplex/6.7.0' ] +39ms\r\n  libp2p:mss:handle read \"/multistream/1.0.0\" +41ms\r\n  libp2p:mss:handle respond with \"/multistream/1.0.0\" for \"/multistream/1.0.0\" +0ms\r\n  libp2p:mss:handle read \"/mplex/6.7.0\" +0ms\r\n  libp2p:mss:handle respond with \"/mplex/6.7.0\" for \"/mplex/6.7.0\" +0ms\r\n  libp2p:upgrader Successfully upgraded inbound connection +2ms\r\n  libp2p:peer-store:key-book:trace set await write lock +0ms\r\n  libp2p:tcp:listener inbound connection /ip4/10.244.0.35/tcp/51368 upgraded +49ms\r\n  libp2p:peer-store:key-book:trace set got write lock +0ms\r\n  libp2p:peer-store:key-book:trace set release write lock +2ms\r\n  libp2p:connection-manager:trace checking limit of maxConnections. current value: 1 of 1 +0ms\r\n  libp2p:upgrader inbound: starting new stream on [ '/ipfs/id/1.0.0' ] +4ms\r\n  libp2p:mplex new initiator stream 0 +0ms\r\n  libp2p:mplex:trace initiator stream 0 send { id: 0, type: 'NEW_STREAM (0)', data: '0' } +0ms\r\n  libp2p:mss:select select: write [\"/multistream/1.0.0\", \"/ipfs/id/1.0.0\"] +0ms\r\n  libp2p:mplex:trace initiator stream 0 send {\r\n  id: 0,\r\n  type: 'MESSAGE_INITIATOR (2)',\r\n  data: '132f6d756c746973747265616d2f312e302e300a0f2f697066732f69642f312e302e300a'\r\n} +1ms\r\n  libp2p:noise Stage 2 - Responder received the message, finished handshake. +15ms\r\n  libp2p:upgrader inbound handling muxers [ '/mplex/6.7.0' ] +7ms\r\n  libp2p:mss:handle read \"/multistream/1.0.0\" +13ms\r\n  libp2p:mss:handle respond with \"/multistream/1.0.0\" for \"/multistream/1.0.0\" +0ms\r\n  libp2p:mss:handle read \"/mplex/6.7.0\" +0ms\r\n  libp2p:mss:handle respond with \"/mplex/6.7.0\" for \"/mplex/6.7.0\" +0ms\r\n  libp2p:upgrader Successfully upgraded inbound connection +2ms\r\n  libp2p:peer-store:key-book:trace set await write lock +9ms\r\n  libp2p:tcp:listener inbound connection /ip4/10.244.0.35/tcp/51374 upgraded +11ms\r\n  libp2p:peer-store:key-book:trace set got write lock +1ms\r\n  libp2p:peer-store:key-book:trace set release write lock +0ms\r\n  libp2p:connection-manager:trace checking limit of maxConnections. current value: 2 of 1 +10ms\r\n  libp2p:connection-manager 16Uiu2HAm7MmL6N8ck4zdgusKbgxEZcHS1uuJvRVMwBNHA4FbQmse: limit exceeded: maxConnections, 2/1, pruning 1 connection(s) +7s\r\n  libp2p:peer-store:metadata-book:trace getValue await read lock +6s\r\n  libp2p:peer-store:metadata-book:trace getValue got read lock +0ms\r\n  libp2p:peer-store:metadata-book:trace getValue release write lock +0ms\r\n  libp2p:connection-manager too many connections open - closing a connection to 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +0ms\r\n  libp2p:mplex:stream:trace initiator stream 0 close +0ms\r\n libp2p:mplex:stream:trace initiator stream 0 closeRead +0ms\r\n  libp2p:mplex:stream:trace initiator stream 0 source end - err: undefined +0ms\r\n  libp2p:mplex:stream:trace initiator stream 0 closeWrite +0ms\r\n  libp2p:mplex:trace initiator stream 0 send { id: 0, type: 'CLOSE_INITIATOR (4)' } +9ms\r\n  libp2p:mplex:stream:trace initiator stream 0 sink end - err: undefined +0ms\r\n  libp2p:mplex initiator stream with id 0 and protocol undefined ended +11ms\r\n  libp2p:tcp:socket 10.244.0.35:51368 closing socket +0ms\r\n  libp2p:upgrader:error could not create new stream Error: stream ended before 1 bytes became available\r\n    at file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-reader/src/index.ts:44:9\r\n    at Object.next (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:58:23)\r\n    at abortable (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:42:18)\r\n    at decoder (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-length-prefixed/src/decode.ts:58:22)\r\n    at first (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-first/index.js:11:20)\r\n    at file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:77:23\r\n    at read (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:74:15)\r\n    at Module.readString (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:92:15)\r\n    at Module.select (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/select.ts:33:18)\r\n    at ConnectionImpl.newStream [as _newStream] (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/upgrader.ts:431:40) {\r\n  code: 'ERR_UNDER_READ',\r\n  buffer: Uint8ArrayList { bufs: [], length: 0 }\r\n} +0ms\r\n  libp2p:identify:error Error: stream ended before 1 bytes became available\r\n  libp2p:identify:error     at file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-reader/src/index.ts:44:9\r\n  libp2p:identify:error     at Object.next (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:58:23)\r\n  libp2p:identify:error     at abortable (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:42:18)\r\n  libp2p:identify:error     at decoder (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-length-prefixed/src/decode.ts:58:22)\r\n  libp2p:identify:error     at first (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/it-first/index.js:11:20)\r\n  libp2p:identify:error     at file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:77:23\r\n  libp2p:identify:error     at read (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:74:15)\r\n  libp2p:identify:error     at Module.readString (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/multistream.ts:92:15)\r\n  libp2p:identify:error     at Module.select (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/multistream-select/src/select.ts:33:18)\r\n  libp2p:identify:error     at ConnectionImpl.newStream [as _newStream] (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/upgrader.ts:431:40) +0ms\r\n  libp2p:tcp:listener socket error Error: write ECONNRESET\r\n    at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n    at writeGeneric (node:internal/stream_base_commons:155:3)\r\n    at Socket._writeGeneric (node:net:795:11)\r\n    at Socket._write (node:net:807:8)\r\n    at writeOrBuffer (node:internal/streams/writable:389:12)\r\n    at _write (node:internal/streams/writable:330:10)\r\n    at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n    at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n    at sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) {\r\n  errno: -104,\r\n  code: 'ECONNRESET',\r\n  syscall: 'write'\r\n} +37ms\r\n  libp2p:tcp:socket Error: write ECONNRESET\r\n  libp2p:tcp:socket     at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n  libp2p:tcp:socket     at writeGeneric (node:internal/stream_base_commons:155:3)\r\n  libp2p:tcp:socket     at Socket._writeGeneric (node:net:795:11)\r\n  libp2p:tcp:socket     at Socket._write (node:net:807:8)\r\n  libp2p:tcp:socket     at writeOrBuffer (node:internal/streams/writable:389:12)\r\n  libp2p:tcp:socket     at _write (node:internal/streams/writable:330:10)\r\n  libp2p:tcp:socket     at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n  libp2p:tcp:socket     at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n  libp2p:tcp:socket     at sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) +35ms\r\n  libp2p:mplex error in sink Error: write ECONNRESET\r\n    at afterWriteDispatched (node:internal/stream_base_commons:164:15)\r\n    at writeGeneric (node:internal/stream_base_commons:155:3)\r\n    at Socket._writeGeneric (node:net:795:11)\r\n    at Socket._write (node:net:807:8)\r\n    at writeOrBuffer (node:internal/streams/writable:389:12)\r\n    at _write (node:internal/streams/writable:330:10)\r\n    at Socket.Writable.write (node:internal/streams/writable:334:10)\r\n    at /usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/stream-to-it/sink.js:71:20\r\n    at sink (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/tcp/src/socket-to-conn.ts:100:9) {\r\n  errno: -104,\r\n  code: 'ECONNRESET',\r\n  syscall: 'write'\r\n} +36ms\r\n  libp2p:tcp:socket 10.244.0.35:51374 socket read timeout +3ms\r\n  libp2p:tcp:socket 10.244.0.35:51374 socket was already destroyed when trying to close +1ms\r\n  libp2p:tcp:socket 10.244.0.35:51368 socket read timeout +0ms\r\n  libp2p:peer-store:proto-book:trace get wait for read lock +6s\r\n  libp2p:tcp:socket 10.244.0.35:51368 socket closed +0ms\r\n  libp2p:peer-store:proto-book:trace get got read lock +0ms\r\n  libp2p:peer-store:proto-book:trace get release read lock +1ms\r\n  libp2p:mplex error in sink AbortError: The operation was aborted\r\n    at nextAbortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:37:20)\r\n    at EventTarget.abortHandler (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/abortable-iterator/src/index.ts:21:37)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10)\r\n    at AbortController.abort (node:internal/abort_controller:122:5)\r\n    at EventTarget.onAbort (/usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/any-signal/index.js:11:16)\r\n    at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n    at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n    at abortSignal (node:internal/abort_controller:97:10) {\r\n  type: 'aborted',\r\n  code: 'ABORT_ERR'\r\n} +4ms\r\n  libp2p:identify:error Error: the connection is closed\r\n  libp2p:identify:error     at ConnectionImpl.newStream (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/connection/src/index.ts:114:21)\r\n  libp2p:identify:error     at IdentifyService._identify (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/identify/index.ts:250:33)\r\n  libp2p:identify:error     at IdentifyService.identify (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/identify/index.ts:292:32)\r\n  libp2p:identify:error     at EventTarget.<anonymous> (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/identify/index.ts:97:12)\r\n  libp2p:identify:error     at EventTarget.[nodejs.internal.kHybridDispatch] (node:internal/event_target:562:20)\r\n  libp2p:identify:error     at EventTarget.dispatchEvent (node:internal/event_target:504:26)\r\n  libp2p:identify:error     at EventTarget.dispatchEvent (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/@libp2p/interfaces/src/events.ts:64:26)\r\n  libp2p:identify:error     at EventTarget._onConnect (file:///usr/local/lib/node_modules/@chainsafe/lodestar/node_modules/libp2p/src/connection-manager/index.ts:456:10)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282896888/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282902806",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1282902806",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1282902806,
    "node_id": "IC_kwDOCD5_Gc5Md4sW",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-18T19:30:23Z",
    "updated_at": "2022-10-18T19:30:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can see this log on peer1(bootnode) could be the reason:\r\n```typescript\r\n libp2p:connection-manager too many connections open - closing a connection to 16Uiu2HAmF1N7LrGGxf16g4fnCto4cfGuPRxWDcU5ZG7nkhGTzg5c +0ms\r\n  libp2p:mplex:stream:trace initiator stream 0 close +0ms\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1282902806/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283338151",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1283338151",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1283338151,
    "node_id": "IC_kwDOCD5_Gc5Mfi-n",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T02:55:08Z",
    "updated_at": "2022-10-19T02:55:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "```\r\nlibp2p:connection-manager:trace checking limit of maxConnections. current value: 2 of 1 +10ms\r\n```\r\n\r\nsomehow the maxConnection is configured as 1, and there are 2 connections so it prune 1\r\n\r\non a regular node setup, `maxConnections` is `maxPeers` (which is 55) and `minConnection `is `targetPeers` (which is 50)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283338151/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283361993",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1283361993",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1283361993,
    "node_id": "IC_kwDOCD5_Gc5MfozJ",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T03:21:22Z",
    "updated_at": "2022-10-19T03:21:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "@g11tech could you change https://github.com/ChainSafe/lodestar/blob/64892640a4c60ea7901b3ac2f2df61d572cf3ffa/packages/cli/src/cmds/dev/options.ts#L80 to 55 and try again?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283361993/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283629199",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1283629199",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1283629199,
    "node_id": "IC_kwDOCD5_Gc5MgqCP",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T08:31:35Z",
    "updated_at": "2022-10-19T08:31:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes max peer works, why would we limit maxpeers to 1 as default?",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283629199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283639621",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1283639621",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1283639621,
    "node_id": "IC_kwDOCD5_Gc5MgslF",
    "user": {
      "login": "tuyennhv",
      "id": 10568965,
      "node_id": "MDQ6VXNlcjEwNTY4OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10568965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tuyennhv",
      "html_url": "https://github.com/tuyennhv",
      "followers_url": "https://api.github.com/users/tuyennhv/followers",
      "following_url": "https://api.github.com/users/tuyennhv/following{/other_user}",
      "gists_url": "https://api.github.com/users/tuyennhv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tuyennhv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tuyennhv/subscriptions",
      "organizations_url": "https://api.github.com/users/tuyennhv/orgs",
      "repos_url": "https://api.github.com/users/tuyennhv/repos",
      "events_url": "https://api.github.com/users/tuyennhv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tuyennhv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T08:38:49Z",
    "updated_at": "2022-10-19T08:38:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "> yes max peer works, why would we limit maxpeers to 1 as default?\r\n\r\nI have no idea, haven't used this `dev` command much, @wemeetagain do you know this? I suppose we can increase it.",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283639621/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283695774",
    "html_url": "https://github.com/ChainSafe/lodestar/issues/4662#issuecomment-1283695774",
    "issue_url": "https://api.github.com/repos/ChainSafe/lodestar/issues/4662",
    "id": 1283695774,
    "node_id": "IC_kwDOCD5_Gc5Mg6Se",
    "user": {
      "login": "g11tech",
      "id": 76567250,
      "node_id": "MDQ6VXNlcjc2NTY3MjUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/76567250?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/g11tech",
      "html_url": "https://github.com/g11tech",
      "followers_url": "https://api.github.com/users/g11tech/followers",
      "following_url": "https://api.github.com/users/g11tech/following{/other_user}",
      "gists_url": "https://api.github.com/users/g11tech/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/g11tech/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/g11tech/subscriptions",
      "organizations_url": "https://api.github.com/users/g11tech/orgs",
      "repos_url": "https://api.github.com/users/g11tech/repos",
      "events_url": "https://api.github.com/users/g11tech/events{/privacy}",
      "received_events_url": "https://api.github.com/users/g11tech/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T09:21:45Z",
    "updated_at": "2022-10-19T09:21:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "in my opinion, we should just remove the `targetPeers`, `network.maxPeers` overrides ",
    "reactions": {
      "url": "https://api.github.com/repos/ChainSafe/lodestar/issues/comments/1283695774/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
